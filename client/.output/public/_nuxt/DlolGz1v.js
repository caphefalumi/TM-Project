import{_ as Y,l as X,m as Z,q as ee,V as F,s as x,t as c,v as p,x as f,y as h,z as b,A as C,B as L,C as te,D as ae,E as se,F as le,G as T,H as B,I as oe,J as re,K as ie,L as ne,M as de,N as I}from"./B4Kh-yHs.js";import{f as ue}from"./DWeS6x0F.js";import{r as k,R as fe,v as ce,f as H,ai as M,V as y,ah as t,I as a,J as r,_ as n,a0 as o,K as me,S as $,Q as D,L as ge,A as ve}from"./CGnq_Kza.js";import"./CjwIl2eS.js";const pe={class:"text-h4 font-weight-bold"},ye={class:"d-flex flex-column flex-md-row gap-2"},he={class:"d-flex align-center mb-2"},be={class:"text-h6 mr-4"},ke={class:"d-flex align-center"},we={class:"d-flex align-center gap-2 justify-end justify-md-end"},xe={key:0,class:"text-center py-8"},De={key:1},_e={class:"d-flex align-center"},Ve={class:"font-weight-medium task-title"},Ce={key:0,class:"text-caption text-grey"},Te={class:"text-body-2"},Se={class:"text-body-2 text-center"},Pe={class:"text-center"},Ne={class:"text-center"},Ue={class:"mt-4 text-center"},Be={key:2,class:"text-center py-8"},Ie={key:3,class:"text-center py-8"},Re=Object.assign({name:"Dashboard"},{__name:"home",setup(ze){const j=X(),{needsRefresh:E,markAsRefreshed:J}=Z(),S=ee(),_=k({userId:"",username:"",email:""}),m=k([]),V=k(!1),i=k({submitted:!1,highPriority:!1,pending:!1}),P=k("priority"),w=k("asc"),q=[{value:"priority",title:"By Priority"},{value:"weighted",title:"By Weight"},{value:"startDate",title:"By Start Date"},{value:"dueDate",title:"By Due Date"}];fe(async()=>{const l=await j.getUserByAccessToken();l?(R(l),await U()):S.push("/login")}),ce(async()=>{if(E("Dashboard")){const l=await getUserByAccessToken();l&&(R(l),await U()),J("Dashboard")}});const R=l=>{_.value.userId=l.userId,_.value.username=l.username,_.value.email=l.email},G=l=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[l]||"grey-darken-3",z=l=>({Urgent:5,High:4,Medium:3,Low:2,Optional:1})[l]||0,N=H(()=>{let l=[...m.value];if(i.value.submitted&&(l=l.filter(e=>e.submitted===!0)),i.value.highPriority&&(l=l.filter(e=>e.priority==="High"||e.priority==="Urgent")),i.value.pending){const e=new Date;l=l.filter(s=>{const d=new Date(s.startDate),u=new Date(s.dueDate);return!s.submitted&&e>=d&&e<=u})}return l.sort((e,s)=>{let d,u;switch(P.value){case"priority":d=z(e.priority),u=z(s.priority);break;case"weighted":d=e.weighted,u=s.weighted;break;case"startDate":d=new Date(e.startDate),u=new Date(s.startDate);break;case"dueDate":d=new Date(e.dueDate),u=new Date(s.dueDate);break;default:return 0}return w.value==="desc"?u>d?1:u<d?-1:0:d>u?1:d<u?-1:0}),l}),g=H(()=>{const l=m.value.length,e=m.value.filter(v=>v.submitted).length,s=m.value.filter(v=>!v.submitted&&new Date(v.dueDate)<new Date).length,d=m.value.filter(v=>!v.submitted&&new Date(v.startDate)>new Date).length,u=l-e-s-d;return{total:l,submitted:e,overdue:s,notStarted:d,pending:u,completionRate:l>0?Math.round(e/l*100):0}}),U=async()=>{V.value=!0;const l=void 0;try{const{ok:e,status:s,data:d}=await ue(`${l}/api/tasks/`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e)m.value=d.tasks||[];else throw new Error(d?.message||"Failed to fetch tasks")}catch{m.value=[]}finally{V.value=!1}},K=async()=>{await U()},W=l=>{l&&l.teamId&&S.push(`/teams/${l.teamId}`)},O=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),A=()=>{i.value.submitted=!1,i.value.highPriority=!1,i.value.pending=!1},Q=()=>{w.value=w.value==="asc"?"desc":"asc"};return(l,e)=>(y(),M(F,{fluid:"",class:"pa-6"},{default:t(()=>[a(x,{class:"align-center mb-6"},{default:t(()=>[a(c,{cols:"12",md:"6"},{default:t(()=>[r("h1",pe,"Hi, "+n(_.value.username)+"!",1),e[5]||(e[5]=r("p",{class:"text-h6 text-grey"},"Here's your task overview and calendar",-1))]),_:1}),a(c,{cols:"12",md:"6"},{default:t(()=>[r("div",ye,[a(p,{onClick:K,loading:V.value,color:"primary",size:"large",variant:"outlined",class:"flex-grow-1"},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[6]||(e[6]=[o("mdi-refresh",-1)])]),_:1}),e[7]||(e[7]=o(" Refresh ",-1))]),_:1},8,["loading"])])]),_:1})]),_:1}),a(x,{class:"mb-6"},{default:t(()=>[a(c,{cols:"6",md:"3"},{default:t(()=>[a(h,{class:"text-center pa-4",color:"gray",variant:"tonal"},{default:t(()=>[a(b,{class:"text-h3 font-weight-bold"},{default:t(()=>[o(n(g.value.notStarted),1)]),_:1}),a(C,{class:"text-h6"},{default:t(()=>[...e[8]||(e[8]=[o("Not Started",-1)])]),_:1})]),_:1})]),_:1}),a(c,{cols:"6",md:"3"},{default:t(()=>[a(h,{class:"text-center pa-4",color:"orange-darken-4",variant:"tonal"},{default:t(()=>[a(b,{class:"text-h3 font-weight-bold"},{default:t(()=>[o(n(g.value.pending),1)]),_:1}),a(C,{class:"text-h6"},{default:t(()=>[...e[9]||(e[9]=[o("Pending",-1)])]),_:1})]),_:1})]),_:1}),a(c,{cols:"6",md:"3"},{default:t(()=>[a(h,{class:"text-center pa-4",color:"error",variant:"tonal"},{default:t(()=>[a(b,{class:"text-h3 font-weight-bold"},{default:t(()=>[o(n(g.value.overdue),1)]),_:1}),a(C,{class:"text-h6"},{default:t(()=>[...e[10]||(e[10]=[o("Overdue",-1)])]),_:1})]),_:1})]),_:1}),a(c,{cols:"6",md:"3"},{default:t(()=>[a(h,{class:"text-center pa-4",color:"green-darken-1",variant:"tonal"},{default:t(()=>[a(b,{class:"text-h3 font-weight-bold"},{default:t(()=>[o(n(g.value.submitted),1)]),_:1}),a(C,{class:"text-h6"},{default:t(()=>[...e[11]||(e[11]=[o("Completed",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),a(x,{class:"mb-6"},{default:t(()=>[a(c,{cols:"12"},{default:t(()=>[a(h,{variant:"outlined"},{default:t(()=>[a(b,{class:"d-flex align-center"},{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[12]||(e[12]=[o("mdi-chart-arc",-1)])]),_:1}),e[13]||(e[13]=o(" Overall Progress ",-1))]),_:1}),a(L,null,{default:t(()=>[r("div",he,[r("span",be,n(g.value.completionRate)+"% Complete",1),a(te),r("span",null,n(g.value.submitted)+" of "+n(g.value.total)+" tasks",1)]),a(ae,{"model-value":g.value.completionRate,color:"success",height:"12",rounded:""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),a(x,null,{default:t(()=>[a(c,{cols:"12"},{default:t(()=>[a(h,{variant:"outlined"},{default:t(()=>[a(b,{class:"pb-2"},{default:t(()=>[a(F,{fluid:"",class:"pa-0"},{default:t(()=>[a(x,{class:"align-center"},{default:t(()=>[a(c,{cols:"12",md:"6"},{default:t(()=>[r("div",ke,[a(f,{class:"mr-2"},{default:t(()=>[...e[14]||(e[14]=[o("mdi-table",-1)])]),_:1}),e[15]||(e[15]=o(" Tasks Table ",-1))])]),_:1}),a(c,{cols:"12",md:"6"},{default:t(()=>[r("div",we,[a(se,{"close-on-content-click":!1},{activator:t(({props:s})=>[a(p,me(s,{variant:"outlined",color:i.value.submitted||i.value.highPriority||i.value.pending?"primary":"default"}),{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[16]||(e[16]=[o("mdi-filter",-1)])]),_:1}),e[17]||(e[17]=o(" Filter ",-1)),i.value.submitted||i.value.highPriority||i.value.pending?(y(),M(re,{key:0,content:Number(i.value.submitted)+Number(i.value.highPriority)+Number(i.value.pending),color:"primary",inline:""},null,8,["content"])):$("",!0)]),_:1},16,["color"])]),default:t(()=>[a(le,null,{default:t(()=>[a(T,null,{default:t(()=>[a(B,{modelValue:i.value.submitted,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value.submitted=s),label:"Submitted Tasks","hide-details":""},null,8,["modelValue"])]),_:1}),a(T,null,{default:t(()=>[a(B,{modelValue:i.value.highPriority,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value.highPriority=s),label:"High & Urgent Priority","hide-details":""},null,8,["modelValue"])]),_:1}),a(T,null,{default:t(()=>[a(B,{modelValue:i.value.pending,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value.pending=s),label:"Pending Tasks","hide-details":""},null,8,["modelValue"])]),_:1}),a(oe,{class:"my-2"}),a(T,null,{default:t(()=>[a(p,{onClick:A,variant:"text",color:"error",block:""},{default:t(()=>[...e[18]||(e[18]=[o(" Clear Filters ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),a(ie,{modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=s=>P.value=s),items:q,density:"compact",variant:"outlined","hide-details":"",style:{"min-width":"130px","max-width":"150px"}},null,8,["modelValue"]),a(p,{onClick:Q,variant:"outlined",color:w.value==="desc"?"primary":"default"},{default:t(()=>[a(f,null,{default:t(()=>[o(n(w.value==="desc"?"mdi-sort-descending":"mdi-sort-ascending"),1)]),_:1})]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1})]),_:1}),a(L,null,{default:t(()=>[V.value?(y(),D("div",xe,[a(ne,{indeterminate:"",color:"primary",size:"64"}),e[19]||(e[19]=r("p",{class:"mt-4 text-h6"},"Loading your tasks...",-1))])):N.value.length>0?(y(),D("div",De,[a(de,{headers:[{title:"Title",key:"title",sortable:!1,width:"26%"},{title:"Category",key:"category",sortable:!1,width:"12%"},{title:"Priority",key:"priority",sortable:!1,width:"12%"},{title:"Start Date",key:"startDate",sortable:!1,width:"12%"},{title:"Due Date",key:"dueDate",sortable:!1,width:"12%"},{title:"Weighted",key:"weighted",sortable:!1,width:"10%"},{title:"Submitted",key:"submitted",sortable:!1,width:"8%"},{title:"Actions",key:"action",sortable:!1,width:"8%"}],items:N.value,class:"tasks-table","hide-default-footer":"","items-per-page":-1},{"item.title":t(({item:s})=>[r("div",_e,[r("div",null,[r("div",Ve,n(s.title),1),s.description?(y(),D("div",Ce,n(s.description.length>50?s.description.substring(0,50)+"...":s.description),1)):$("",!0)])])]),"item.category":t(({item:s})=>[a(I,{size:"small",variant:"outlined"},{default:t(()=>[o(n(s.category),1)]),_:2},1024)]),"item.priority":t(({item:s})=>[a(I,{color:G(s.priority),size:"small"},{default:t(()=>[o(n(s.priority),1)]),_:2},1032,["color"])]),"item.startDate":t(({item:s})=>[r("div",Te,n(O(s.startDate)),1)]),"item.dueDate":t(({item:s})=>[r("div",{class:ge(["text-body-2",{"text-error":new Date(s.dueDate)<new Date&&!s.submitted}])},n(O(s.dueDate)),3)]),"item.weighted":t(({item:s})=>[r("div",Se,n(s.weighted),1)]),"item.submitted":t(({item:s})=>[r("div",Pe,[a(f,{color:s.submitted?"success":"error",size:"20"},{default:t(()=>[o(n(s.submitted?"mdi-check":"mdi-close"),1)]),_:2},1032,["color"])])]),"item.action":t(({item:s})=>[r("div",Ne,[a(p,{onClick:d=>W(s),color:"primary",variant:"outlined",size:"small","data-team-id":s.teamId,"aria-label":`Open team details for ${s.title}`},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[20]||(e[20]=[o("mdi-open-in-new",-1)])]),_:1})]),_:1},8,["onClick","data-team-id","aria-label"])])]),_:1},8,["items"]),r("div",Ue,[a(I,{color:"primary",variant:"outlined"},{default:t(()=>[o(" Showing "+n(N.value.length)+" of "+n(m.value.length)+" tasks ",1)]),_:1})])])):m.value.length===0?(y(),D("div",Be,[a(f,{size:"64",class:"mb-4",color:"grey"},{default:t(()=>[...e[21]||(e[21]=[o("mdi-table-off",-1)])]),_:1}),e[24]||(e[24]=r("h3",{class:"text-h5 mb-2"},"No Tasks Found",-1)),e[25]||(e[25]=r("p",{class:"text-grey mb-4"}," You don't have any tasks assigned yet. Tasks will appear here when they're assigned to you. ",-1)),a(p,{color:"primary",onClick:e[4]||(e[4]=s=>ve(S).push("/teams")),size:"large"},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[22]||(e[22]=[o("mdi-account-group",-1)])]),_:1}),e[23]||(e[23]=o(" View Teams ",-1))]),_:1})])):(y(),D("div",Ie,[a(f,{size:"64",class:"mb-4",color:"grey"},{default:t(()=>[...e[26]||(e[26]=[o("mdi-filter-off",-1)])]),_:1}),e[29]||(e[29]=r("h3",{class:"text-h5 mb-2"},"No Tasks Match Filters",-1)),e[30]||(e[30]=r("p",{class:"text-grey mb-4"},"Try adjusting your filters to see more tasks.",-1)),a(p,{color:"primary",onClick:A,variant:"outlined"},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[27]||(e[27]=[o("mdi-close",-1)])]),_:1}),e[28]||(e[28]=o(" Clear Filters ",-1))]),_:1})]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),He=Y(Re,[["__scopeId","data-v-f18a4c72"]]);export{He as default};
