import{z as w,B as b,a0 as y,Y as O,a2 as C,Z as P,C as S,v as U,y as j,Q as F}from"./B4Kh-yHs.js";import{r as d,R as _,w as I,ai as f,V,ah as n,I as l,a0 as p,S as T,_ as x}from"./CGnq_Kza.js";const N={__name:"UpdateAnnouncements",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},announcement:{type:Object,required:!0}},emits:["update:dialog","announcement-updated"],setup(k,{emit:q}){const r=d(!1),i=d(!1),u=d(""),v=d(!1),g=q,o=d(""),c=d(""),m=d(""),a=k,A=()=>{o.value=a.announcement.title||"",c.value=a.announcement.subtitle||"",m.value=a.announcement.content||""};_(()=>{A()}),I(()=>a.announcement,s=>{s&&(o.value=s.title||"",c.value=s.subtitle||"",m.value=s.content||"")},{immediate:!0});const B=async()=>{if(!o.value||!m.value){i.value=!0,r.value=!1,u.value="Title and Content are required fields.";return}if(o.value.length>100){i.value=!0,r.value=!1,u.value="Title must be less than 100 characters.";return}v.value=!0;try{const e=await fetch(`undefined/api/teams/${a.teamId}/announcements/${a.announcement._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:a.announcement._id,title:o.value,subtitle:c.value,content:m.value,createdBy:a.userProps.userId,createdByUsername:a.userProps.username})}),t=await e.json();e.ok?(r.value=!0,i.value=!1,u.value=t.message||"Announcement updated successfully.",g("announcement-updated")):(i.value=!0,r.value=!1,u.value=t.message||"Failed to update announcement.")}catch{i.value=!0,r.value=!1,u.value="An error occurred while updating the announcement."}finally{v.value=!1}};return(s,e)=>(V(),f(F,{modelValue:a.dialog,"onUpdate:modelValue":e[4]||(e[4]=t=>a.dialog=t),"max-width":"600px",closable:""},{default:n(()=>[l(j,null,{default:n(()=>[l(w,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:n(()=>[...e[5]||(e[5]=[p(" Edit Announcement ",-1)])]),_:1}),l(b,null,{default:n(()=>[l(y,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value=t),label:"Title",variant:"outlined",required:""},null,8,["modelValue"]),l(y,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),label:"Subtitle (optional)",variant:"outlined"},null,8,["modelValue"]),l(O,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),label:"Content",rows:"4",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),l(b,null,{default:n(()=>[r.value?(V(),f(C,{key:0,type:"success"},{default:n(()=>[p(x(u.value),1)]),_:1})):T("",!0),i.value?(V(),f(C,{key:1,type:"error"},{default:n(()=>[p(x(u.value),1)]),_:1})):T("",!0)]),_:1}),l(P,null,{default:n(()=>[l(S),l(U,{onClick:e[3]||(e[3]=t=>g("update:dialog",!1)),variant:"outlined",disabled:v.value},{default:n(()=>[...e[6]||(e[6]=[p("Cancel",-1)])]),_:1},8,["disabled"]),l(U,{color:"primary",variant:"outlined",onClick:B,disabled:v.value,loading:v.value},{default:n(()=>[...e[7]||(e[7]=[p("Update Announcement",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},D=Object.assign(N,{__name:"UpdateAnnouncements"});export{D as U};
