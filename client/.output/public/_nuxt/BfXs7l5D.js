import{r as k,R as je,f as we,ai as m,V as n,ah as e,I as t,J as s,a0 as l,Q as T,S as D,an as Jt,F as oe,am as re,_ as i,A as ke,w as Se,L as Be,T as vl,ac as It,ao as pl,K as Vt,a8 as Rt,a9 as $t,Z as Pe,v as gl,u as yl,$ as ft}from"./CGnq_Kza.js";import{_ as qe,y as B,z as ne,v as F,x as w,B as X,s as j,t as x,$ as St,a0 as xe,K as Me,Y as tt,a9 as Oe,N as te,I as st,C as ve,a2 as pe,Z as he,H as gt,O as Ie,A as De,aa as Xt,Q as Ve,q as kt,L as wt,ab as yt,F as nt,G as We,ac as Qe,P as et,S as At,T as Ae,U as Ut,W as Ue,ad as Pt,ae as pt,af as Le,ag as Ee,ah as Ne,E as Qt,V as bt,a5 as bl,ai as kl,aj as Kt,D as Zt,l as wl,m as xl,a8 as hl,a6 as ee,ak as vt,X as Tl,al as _l,am as Cl}from"./B4Kh-yHs.js";import{f as Ge}from"./DWeS6x0F.js";import{U as Dl}from"./DMqj_JSB.js";import"./CjwIl2eS.js";const Mt=[{key:"canViewTeam",label:"View Team",category:"Basic",description:"Can view team details"},{key:"canViewTasks",label:"View Tasks",category:"Basic",description:"Can view team tasks"},{key:"canViewAnnouncements",label:"View Announcements",category:"Basic",description:"Can view team announcements"},{key:"canViewMembers",label:"View Members",category:"Basic",description:"Can view team member list"},{key:"canSubmitTasks",label:"Submit Tasks",category:"Basic",description:"Can submit task assignments"},{key:"canManageTasks",label:"Manage Tasks",category:"Tasks",description:"Can create, edit, and manage tasks"},{key:"canDeleteTasks",label:"Delete Tasks",category:"Tasks",description:"Can delete tasks"},{key:"canManageAnnouncements",label:"Manage Announcements",category:"Announcements",description:"Can create, edit, and manage announcements"},{key:"canDeleteAnnouncements",label:"Delete Announcements",category:"Announcements",description:"Can delete announcements"},{key:"canAddMembers",label:"Add Members",category:"Members",description:"Can add new members to the team"},{key:"canRemoveMembers",label:"Remove Members",category:"Members",description:"Can remove members from the team"},{key:"canDeleteTeams",label:"Delete Teams",category:"Admin Only",description:"Can delete the entire team (Admin privilege only)"},{key:"canCreateSubTeams",label:"Create Sub-teams",category:"Admin Only",description:"Can create sub-teams (Admin privilege only)"},{key:"canManageCustomRoles",label:"Manage Custom Roles",category:"Admin Only",description:"Can create and manage custom roles (Admin privilege only)"}];class Vl{constructor(){this.userActions={},this.isGlobalAdmin=!1,this.roleType="member",this.baseRole="Member",this.roleLabel="Member",this.customRoleName=null}setUserActions(c){this.userActions=c||{},this.isGlobalAdmin=c?.isGlobalAdmin||!1,this.roleType=c?.roleType||c?.role?.toLowerCase?.()||"member",this.baseRole=c?.baseRole||(this.roleType==="admin"?"Admin":"Member"),this.roleLabel=c?.roleLabel||this.baseRole,this.role=this.roleLabel,this.customRoleName=c?.customRoleName||null}canViewTeam(){return this.userActions.canViewTeam||!1}canViewTasks(){return this.userActions.canViewTasks||!1}canViewAnnouncements(){return this.userActions.canViewAnnouncements||!1}canViewMembers(){return this.userActions.canViewMembers||!1}canSubmitTasks(){return this.userActions.canSubmitTasks||!1}canManageTasks(){return this.userActions.canManageTasks||!1}canDeleteTasks(){return this.userActions.canDeleteTasks||!1}canManageAnnouncements(){return this.userActions.canManageAnnouncements||!1}canDeleteAnnouncements(){return this.userActions.canDeleteAnnouncements||!1}canAddMembers(){return this.userActions.canAddMembers||!1}canRemoveMembers(){return this.userActions.canRemoveMembers||!1}canDeleteTeams(){return this.userActions.canDeleteTeams||!1}canCreateSubTeams(){return this.userActions.canCreateSubTeams||!1}canManageCustomRoles(){return this.userActions.canManageCustomRoles||!1}canViewTaskGroup(){return this.canManageTasks()||this.canDeleteTasks()}getRole(){return this.roleLabel}getCustomRoleName(){return this.customRoleName}isAdmin(){return this.isGlobalAdmin||this.roleType==="admin"}hasPermission(c){return this.userActions[c]||!1}getAvailablePermissionsForCustomRoles(){return Mt.filter(c=>c.category!=="Admin Only"&&c.category!=="Basic")}getPermissionsByCategory(){const c={};return Mt.forEach(f=>{c[f.category]||(c[f.category]=[]),c[f.category].push({...f,hasPermission:this.hasPermission(f.key)})}),c}async fetchUserActions(c,f){try{const{ok:b,status:g,data:r}=await Ge(`undefined/api/teams/${c}/members/${f}/permissions`,{method:"GET",headers:{"Content-Type":"application/json"}});return b?(this.setUserActions(r),r):{}}catch{return{}}}async updateUserPermissions(c,f,V){try{const{ok:g,status:r,data:I}=await Ge(`undefined/api/teams/${c}/members/${f}/permissions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({customPermissions:V})});return!!g}catch{return!1}}getPermissionIcon(c){return c===null?"mdi-minus":c===!0?"mdi-check":"mdi-close"}getPermissionColor(c){return c===null?"grey":c===!0?"success":"error"}getRoleIcon(c){switch(c?.toLowerCase()){case"admin":return"mdi-crown";case"member":return"mdi-account";default:return"mdi-help"}}getRoleColor(c){switch(c?.toLowerCase()){case"admin":return"red";case"member":return"blue";default:return"grey"}}hasCustomPermissions(c){return c.customPermissions?Object.values(c.customPermissions).some(f=>f!==null):!1}}const me=new Vl,Rl={class:"task-creation-side"},$l={class:"mb-3"},Ml={key:1,class:"text-caption text-grey mb-2"},Il={class:"d-flex align-center mb-3"},Sl={class:"text-caption"},Al={key:0,class:"mb-3"},Ul={class:"d-flex flex-wrap gap-2"},Pl={class:"validation-messages mb-3"},Ol={class:"text-caption"},Fl={class:"mt-1 ml-4"},zl={key:0},Ll={key:1},El={key:2},Nl={key:3},jl={key:4},ql={key:0,class:"mb-4"},Gl={key:1,class:"mb-3"},Bl={key:2,class:"mb-3"},Wl={class:"validation-messages mb-3"},Hl={class:"task-preview-side"},Yl={class:"mb-2"},Jl={class:"text-caption"},Ql={class:"d-flex justify-space-between text-caption"},Kl={class:"text-subtitle-2 mb-1 d-block"},Xl={key:0,class:"text-red"},Zl={key:6,class:"text-caption text-grey"},ea={__name:"NewTasks",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},teamMembers:{type:Array,required:!0}},emits:["update:dialog","create-task"],setup(_,{emit:c}){const f=k({userId:"",username:"",email:""}),V=_,b=c,g=k([]),r=k({title:"",category:"Report",tags:[],description:"",priority:"Medium",weighted:0,startDate:"",dueDate:"",teamId:"",design:{numberOfFields:0,fields:[]}}),I=["Report","Development","Design","Marketing","Other"],S=["Urgent","High","Medium","Low","Optional"],h=["Short text","Long text","Number","Date","Select","URLs","Image","Phone"],R=k([...I]),Q=k([...S]),G=k([...h]),E=k(!1),$=k(1),q=k(""),P=k({label:"",type:"Short text",config:{required:!1,options:[],min:0,max:100}}),H=k("");je(async()=>{M(V.userProps),r.value.teamId=V.teamId});const M=N=>{f.value.userId=N.userId,f.value.username=N.username,f.value.email=N.email},z=we(()=>r.value.title&&r.value.teamId&&r.value.startDate&&r.value.dueDate&&r.value.startDate<r.value.dueDate&&g.value.length>0),le=()=>{b("create-task",r.value),b("update:dialog",!1),Z()},Z=()=>{r.value={title:"",category:"Report",tags:[],description:"",priority:"Medium",weighted:1,startDate:"",dueDate:"",teamId:`${V.teamId}`,design:{numberOfFields:0,fields:[]}},g.value=[],$.value=1,q.value="",P.value={label:"",type:"Short text",config:{required:!1,options:[],min:0,max:100}}},W=()=>{if(!P.value.label)return;const N={label:P.value.label,type:P.value.type,config:{...P.value.config}};N.type!=="Select"&&delete N.config.options,N.type!=="Number"&&(delete N.config.min,delete N.config.max),r.value.design.fields.push(N),r.value.design.numberOfFields=r.value.design.fields.length,P.value={label:"",type:"Short text",config:{required:!1,options:[],min:0,max:100}}},U=N=>{const u=r.value.design.fields.findIndex(y=>y.label===N.label);u>-1&&(r.value.design.fields.splice(u,1),r.value.design.numberOfFields=r.value.design.fields.length)},L=()=>{H.value&&!P.value.config.options.includes(H.value)&&(P.value.config.options.push(H.value),H.value="")},C=N=>{const u=P.value.config.options.indexOf(N);u>-1&&P.value.config.options.splice(u,1)},O=()=>{q.value&&!r.value.tags.includes(q.value)&&(r.value.tags.push(q.value),q.value="")},Y=N=>{const u=r.value.tags.indexOf(N);u>-1&&r.value.tags.splice(u,1)},ae=async()=>{if(!r.value.title||!r.value.teamId||r.value.design.fields.length===0)return;E.value=!0;const N={...r.value,userId:f.value.userId,assignedUsers:g.value};try{r.value.description===void 0&&(r.value.description=""),(await fetch("undefined/api/tasks/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)})).ok&&le()}catch{}finally{E.value=!1}},_e=()=>{g.value=V.teamMembers.map(N=>N.userId)},ce=N=>{const u=g.value.indexOf(N);u>-1&&g.value.splice(u,1)},Re=N=>{const u=V.teamMembers.find(y=>y.userId===N);return u&&(u.roleLabel||u.baseRole)||"Member"},be=N=>{const u=V.teamMembers.find(y=>y.userId===N);return u?u.username:"Unknown"},ge=we(()=>({title:r.value.title||"Task Title",category:r.value.category,tags:r.value.tags,description:r.value.description||"Task description...",priority:r.value.priority,weighted:r.value.weighted,startDate:r.value.startDate||new Date().toISOString().split("T")[0],dueDate:r.value.dueDate||new Date().toISOString().split("T")[0],fields:r.value.design.fields})),Ce=N=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[N]||"grey-darken-3",fe=N=>{switch(N.type){case"Short text":return"Sample text";case"Long text":return"This is a longer sample text that would appear in a textarea field...";case"Number":return N.config.min||0;case"Date":return new Date().toISOString().split("T")[0];case"Select":return N.config.options[0]||"Option 1";case"URLs":return"https://example.com";case"Image":return"[Image placeholder]";case"Phone":return"+1 (555) 123-4567";default:return"Sample value"}};return(N,u)=>(n(),m(Ve,{"model-value":V.dialog,"onUpdate:modelValue":le,"max-width":"1400px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"text-h5 pa-4 font-weight-bold"},{default:e(()=>[t(F,{icon:"",onClick:le,variant:"outlined",class:"close-button"},{default:e(()=>[t(w,null,{default:e(()=>[...u[17]||(u[17]=[l("mdi-close",-1)])]),_:1})]),_:1}),u[18]||(u[18]=s("div",{class:"text-center flex-grow-1"},"Create New Task",-1))]),_:1}),t(X,{class:"pa-0"},{default:e(()=>[t(j,{"no-gutters":"",class:"fill-height"},{default:e(()=>[t(x,{cols:"12",md:"6",class:"pa-4 border-end"},{default:e(()=>[s("div",Rl,[u[32]||(u[32]=s("h3",{class:"text-h6 mb-4"},"Task Details",-1)),$.value===1?(n(),m(B,{key:0,flat:""},{default:e(()=>[t(X,{class:"pa-2"},{default:e(()=>[t(St,null,{default:e(()=>[t(xe,{modelValue:r.value.title,"onUpdate:modelValue":u[0]||(u[0]=y=>r.value.title=y),label:"Task Title",variant:"outlined",class:"mb-3",required:""},null,8,["modelValue"]),t(Me,{modelValue:r.value.category,"onUpdate:modelValue":u[1]||(u[1]=y=>r.value.category=y),items:R.value,label:"Category",variant:"outlined",class:"mb-3"},null,8,["modelValue","items"]),t(tt,{modelValue:r.value.description,"onUpdate:modelValue":u[2]||(u[2]=y=>r.value.description=y),label:"Description",variant:"outlined",rows:"3",class:"mb-3"},null,8,["modelValue"]),s("div",$l,[u[19]||(u[19]=s("h4",{class:"text-subtitle-2 mb-2"},"Tags (Optional):",-1)),t(xe,{modelValue:q.value,"onUpdate:modelValue":u[3]||(u[3]=y=>q.value=y),label:"Add Tag",variant:"outlined",density:"compact",onKeyup:Jt(O,["enter"]),"append-inner-icon":"mdi-plus","onClick:appendInner":O,placeholder:"Enter tag name",class:"mb-2"},null,8,["modelValue"]),r.value.tags.length>0?(n(),m(Oe,{key:0,column:"",class:"mb-2"},{default:e(()=>[(n(!0),T(oe,null,re(r.value.tags,y=>(n(),m(te,{key:y,closable:"","onClick:close":J=>Y(y),size:"small",color:"primary",variant:"outlined"},{default:e(()=>[l(i(y),1)]),_:2},1032,["onClick:close"]))),128))]),_:1})):D("",!0),r.value.tags.length===0?(n(),T("div",Ml," No tags added yet. Tags help categorize and filter tasks. ")):D("",!0)]),t(j,null,{default:e(()=>[t(x,{cols:"6"},{default:e(()=>[t(Me,{modelValue:r.value.priority,"onUpdate:modelValue":u[4]||(u[4]=y=>r.value.priority=y),items:Q.value,label:"Priority",variant:"outlined",class:"mb-3"},null,8,["modelValue","items"])]),_:1}),t(x,{cols:"6"},{default:e(()=>[t(xe,{modelValue:r.value.weighted,"onUpdate:modelValue":u[5]||(u[5]=y=>r.value.weighted=y),modelModifiers:{number:!0},label:"Weight",type:"number",variant:"outlined",class:"mb-3",min:"0",max:"500"},null,8,["modelValue"])]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"6"},{default:e(()=>[t(xe,{modelValue:r.value.startDate,"onUpdate:modelValue":u[6]||(u[6]=y=>r.value.startDate=y),label:"Start Date",type:"date",variant:"outlined",class:"mb-3",min:"2025-01-01",max:"2035-12-31"},null,8,["modelValue"])]),_:1}),t(x,{cols:"6"},{default:e(()=>[t(xe,{modelValue:r.value.dueDate,"onUpdate:modelValue":u[7]||(u[7]=y=>r.value.dueDate=y),label:"Due Date",type:"date",variant:"outlined",class:"mb-3",required:"",min:"2025-01-01",max:"2035-12-31"},null,8,["modelValue"])]),_:1})]),_:1}),t(st,{class:"my-4"}),u[22]||(u[22]=s("h4",{class:"text-subtitle-1 mb-3"},"Assign to Team Members:",-1)),s("div",Il,[t(F,{onClick:_e,variant:"outlined",class:"mb-2",disabled:g.value.length===V.teamMembers.length},{default:e(()=>[...u[20]||(u[20]=[l(" Select All ",-1)])]),_:1},8,["disabled"]),t(ve),s("span",Sl,i(g.value.length)+" of "+i(V.teamMembers.length)+" selected",1)]),t(Me,{modelValue:g.value,"onUpdate:modelValue":u[8]||(u[8]=y=>g.value=y),items:V.teamMembers,"item-title":"username","item-value":"userId",label:"Select Team Members",variant:"outlined",multiple:"",chips:"","closable-chips":"",class:"mb-3"},null,8,["modelValue","items"]),g.value.length>0?(n(),T("div",Al,[u[21]||(u[21]=s("h5",{class:"text-subtitle-2 mb-2"},"Selected Members:",-1)),s("div",Ul,[(n(!0),T(oe,null,re(g.value,y=>(n(),m(te,{key:y,color:ke(me).getRoleColor(Re(y)),closable:"","onClick:close":J=>ce(y),class:"mr-1"},{default:e(()=>[l(i(be(y))+" ("+i(Re(y))+") ",1)]),_:2},1032,["color","onClick:close"]))),128))])])):D("",!0)]),_:1})]),_:1}),s("div",Pl,[z.value?D("",!0):(n(),m(pe,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mb-2"},{prepend:e(()=>[t(w,null,{default:e(()=>[...u[23]||(u[23]=[l("mdi-alert-circle",-1)])]),_:1})]),default:e(()=>[s("div",Ol,[u[24]||(u[24]=s("strong",null,"Please complete the following to continue:",-1)),s("ul",Fl,[r.value.title?D("",!0):(n(),T("li",zl,"Add a task title")),r.value.startDate?D("",!0):(n(),T("li",Ll,"Select a start date")),r.value.dueDate?D("",!0):(n(),T("li",El,"Select a due date")),r.value.startDate>=r.value.dueDate?(n(),T("li",Nl," Start date must be before due date ")):D("",!0),g.value.length===0?(n(),T("li",jl,"Assign at least one team member")):D("",!0)])])]),_:1}))]),t(he,{class:"px-0"},{default:e(()=>[t(ve),t(F,{variant:"outlined",color:"primary",onClick:u[9]||(u[9]=y=>$.value=2),disabled:!z.value},{default:e(()=>[...u[25]||(u[25]=[l(" Next: Add Fields ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):(n(),m(B,{key:1,flat:""},{default:e(()=>[t(ne,{class:"px-0 pb-2"},{default:e(()=>[s("span",null,"Custom Fields ("+i(r.value.design.fields.length)+")",1),t(ve),t(F,{color:"primary",size:"small",onClick:u[10]||(u[10]=y=>$.value=1),"prepend-icon":"mdi-arrow-left"},{default:e(()=>[...u[26]||(u[26]=[l(" Back ",-1)])]),_:1})]),_:1}),t(X,{class:"pa-0"},{default:e(()=>[r.value.design.fields.length>0?(n(),T("div",ql,[u[27]||(u[27]=s("h4",{class:"text-subtitle-1 mb-2"},"Current Fields:",-1)),t(Oe,{column:""},{default:e(()=>[(n(!0),T(oe,null,re(r.value.design.fields,y=>(n(),m(te,{key:y.label,closable:"","onClick:close":J=>U(y),color:y.config.required?"primary":"default"},{default:e(()=>[l(i(y.label)+" ("+i(y.type)+") ",1)]),_:2},1032,["onClick:close","color"]))),128))]),_:1})])):D("",!0),t(st,{class:"my-4"}),u[31]||(u[31]=s("h4",{class:"text-subtitle-1 mb-3"},"Add New Field:",-1)),t(xe,{modelValue:P.value.label,"onUpdate:modelValue":u[11]||(u[11]=y=>P.value.label=y),label:"Field Label",variant:"outlined",class:"mb-3",density:"compact"},null,8,["modelValue"]),t(Me,{modelValue:P.value.type,"onUpdate:modelValue":u[12]||(u[12]=y=>P.value.type=y),items:G.value,label:"Field Type",variant:"outlined",class:"mb-3",density:"compact"},null,8,["modelValue","items"]),t(gt,{modelValue:P.value.config.required,"onUpdate:modelValue":u[13]||(u[13]=y=>P.value.config.required=y),label:"Required Field",class:"mb-3"},null,8,["modelValue"]),P.value.type==="Number"?(n(),T("div",Gl,[t(j,null,{default:e(()=>[t(x,{cols:"6"},{default:e(()=>[t(xe,{modelValue:P.value.config.min,"onUpdate:modelValue":u[14]||(u[14]=y=>P.value.config.min=y),modelModifiers:{number:!0},label:"Min Value",type:"number",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(x,{cols:"6"},{default:e(()=>[t(xe,{modelValue:P.value.config.max,"onUpdate:modelValue":u[15]||(u[15]=y=>P.value.config.max=y),modelModifiers:{number:!0},label:"Max Value",type:"number",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})])):D("",!0),P.value.type==="Select"?(n(),T("div",Bl,[t(xe,{modelValue:H.value,"onUpdate:modelValue":u[16]||(u[16]=y=>H.value=y),label:"Add Option",variant:"outlined",density:"compact",onKeyup:Jt(L,["enter"]),"append-inner-icon":"mdi-plus","onClick:appendInner":L},null,8,["modelValue"]),P.value.config.options.length>0?(n(),m(Oe,{key:0,column:"",class:"mt-2"},{default:e(()=>[(n(!0),T(oe,null,re(P.value.config.options,y=>(n(),m(te,{key:y,closable:"","onClick:close":J=>C(y),size:"small"},{default:e(()=>[l(i(y),1)]),_:2},1032,["onClick:close"]))),128))]),_:1})):D("",!0)])):D("",!0),t(F,{color:"primary",onClick:W,disabled:!P.value.label||P.value.type==="Select"&&P.value.config.options.length===0,block:"",class:"mb-4"},{default:e(()=>[...u[28]||(u[28]=[l(" Add Field ",-1)])]),_:1},8,["disabled"]),s("div",Wl,[r.value.design.fields.length===0?(n(),m(pe,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mb-2"},{prepend:e(()=>[t(w,null,{default:e(()=>[...u[29]||(u[29]=[l("mdi-alert-circle",-1)])]),_:1})]),default:e(()=>[u[30]||(u[30]=s("div",{class:"text-caption"},[s("strong",null,"At least 1 custom field is required to create a task"),s("p",{class:"mt-1 mb-0"}," Add fields above to define what information team members need to submit when completing this task. ")],-1))]),_:1})):D("",!0)])]),_:1})]),_:1}))])]),_:1}),t(x,{cols:"12",md:"6",class:"pa-4 bg-grey-lighten-5"},{default:e(()=>[s("div",Hl,[u[35]||(u[35]=s("h3",{class:"text-h6 mb-4"},"Task Preview",-1)),t(B,{class:"mb-4"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,null,{default:e(()=>[l(i(ge.value.title),1)]),_:1}),t(De,null,{default:e(()=>[t(te,{color:Ce(ge.value.priority),class:"mr-2"},{default:e(()=>[l(i(ge.value.priority),1)]),_:1},8,["color"]),t(te,{color:"purple-darken-2"},{default:e(()=>[l(i(ge.value.category),1)]),_:1}),t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re(ge.value.tags,y=>(n(),m(te,{key:y,color:"black",size:"small",class:"ml-1"},{default:e(()=>[l(i(y),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(X,null,{default:e(()=>[s("p",Yl,i(ge.value.description),1),s("div",Jl,[s("span",null,"Weight: "+i(r.value.weighted),1)]),s("div",Ql,[s("span",null,"Start: "+i(new Date(r.value.startDate).toLocaleDateString()),1),s("span",null,"Due: "+i(new Date(r.value.dueDate).toLocaleDateString()),1)])]),_:1})]),_:1}),ge.value.fields.length>0?(n(),m(B,{key:0},{default:e(()=>[t(ne,null,{default:e(()=>[...u[33]||(u[33]=[l("Submission Form Preview",-1)])]),_:1}),t(X,null,{default:e(()=>[(n(!0),T(oe,null,re(ge.value.fields,y=>(n(),T("div",{key:y.label,class:"mb-3"},[s("label",Kl,[l(i(y.label)+" ",1),y.config.required?(n(),T("span",Xl,"*")):D("",!0)]),y.type==="Short text"||y.type==="URLs"||y.type==="phone"?(n(),m(xe,{key:0,"model-value":fe(y),variant:"outlined",density:"compact",readonly:""},null,8,["model-value"])):y.type==="long text"?(n(),m(tt,{key:1,"model-value":fe(y),variant:"outlined",density:"compact",rows:"3",readonly:""},null,8,["model-value"])):y.type==="number"?(n(),m(xe,{key:2,"model-value":fe(y),type:"number",variant:"outlined",density:"compact",readonly:"",hint:`Range: ${y.config.min} - ${y.config.max}`},null,8,["model-value","hint"])):y.type==="date"?(n(),m(xe,{key:3,"model-value":fe(y),type:"date",variant:"outlined",density:"compact",readonly:""},null,8,["model-value"])):y.type==="select"?(n(),m(Me,{key:4,"model-value":fe(y),items:y.config.options,variant:"outlined",density:"compact",readonly:""},null,8,["model-value","items"])):y.type==="image"?(n(),m(Xt,{key:5,label:"Upload Image",variant:"outlined",density:"compact",accept:"image/*",readonly:""})):(n(),T("div",Zl," Preview for "+i(y.type)+" field ",1))]))),128))]),_:1})]),_:1})):(n(),m(pe,{key:1,type:"info",class:"mt-4"},{default:e(()=>[...u[34]||(u[34]=[l(" Add custom fields to see them in the preview ",-1)])]),_:1}))])]),_:1})]),_:1})]),_:1}),t(he,{class:"pa-4"},{default:e(()=>[t(F,{onClick:le,variant:"outlined"},{default:e(()=>[...u[36]||(u[36]=[l("Cancel",-1)])]),_:1}),t(ve),t(F,{variant:"outlined",color:"primary",onClick:ae,loading:E.value,disabled:!r.value.title||!r.value.teamId||$.value!==2||r.value.design.fields.length===0},{default:e(()=>[...u[37]||(u[37]=[l(" Create Task ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ta=Object.assign(qe(ea,[["__scopeId","data-v-4d2613cd"]]),{__name:"NewTasks"}),la={__name:"NewAnnouncements",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},announcements:{type:Array,required:!0}},emits:["update:dialog","announcement-created"],setup(_,{emit:c}){kt();const f=k(!1),V=k(!1),b=k(""),g=k(!1),r=k(""),I=k(""),S=k(""),h=c,R=_,Q=async()=>{if(!r.value||!S.value){V.value=!0,f.value=!1,b.value="Title and Content are required fields.";return}if(r.value.length>100){V.value=!0,f.value=!1,b.value="Title must be less than 100 characters.";return}try{const q=await fetch(`undefined/api/teams/${R.teamId}/announcements`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:r.value,subtitle:I.value,content:S.value,createdBy:R.userProps.userId,createdByUsername:R.userProps.username})});if(q.ok)r.value="",I.value="",S.value="",f.value=!0,V.value=!1,b.value="Announcement created successfully!",g.value=!1,h("announcement-created"),G();else{const P=await q.json()}}catch{}},G=()=>{setTimeout(()=>{E(),f.value=!1,V.value=!1,b.value="",g.value=!1,h("update:dialog",!1)},1500)},E=()=>{r.value="",I.value="",S.value=""};return($,q)=>(n(),m(Ve,{modelValue:R.dialog,"onUpdate:modelValue":q[4]||(q[4]=P=>R.dialog=P),"max-width":"600px",closable:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:e(()=>[...q[5]||(q[5]=[l(" New Announcements ",-1)])]),_:1}),t(X,null,{default:e(()=>[t(xe,{modelValue:r.value,"onUpdate:modelValue":q[0]||(q[0]=P=>r.value=P),label:"Title",variant:"outlined",required:""},null,8,["modelValue"]),t(xe,{modelValue:I.value,"onUpdate:modelValue":q[1]||(q[1]=P=>I.value=P),label:"Subtitle (optional)",variant:"outlined"},null,8,["modelValue"]),t(tt,{modelValue:S.value,"onUpdate:modelValue":q[2]||(q[2]=P=>S.value=P),label:"Content",rows:"4",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),t(X,null,{default:e(()=>[f.value?(n(),m(pe,{key:0,type:"success"},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0),V.value?(n(),m(pe,{key:1,type:"error"},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0)]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:q[3]||(q[3]=P=>h("update:dialog",!1)),variant:"outlined",disabled:g.value},{default:e(()=>[...q[6]||(q[6]=[l("Cancel",-1)])]),_:1},8,["disabled"]),t(F,{color:"primary",variant:"outlined",onClick:Q,disabled:g.value,loading:g.value},{default:e(()=>[...q[7]||(q[7]=[l("Create Announcement",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},aa=Object.assign(la,{__name:"NewAnnouncements"}),sa={class:"text-center flex-grow-1"},na={class:"mb-2"},oa={class:"text-caption"},ia={class:"d-flex justify-space-between text-caption"},ua={key:2,class:"text-center pa-4"},ra={key:0},da={class:"text-subtitle-2 mb-1 d-block"},ma={key:0,class:"text-red"},ca={key:2},fa={key:0,class:"text-caption text-grey"},va={key:5},pa={key:0,class:"mt-2"},ga={key:1,class:"text-center pa-4"},ya={__name:"TaskSubmission",props:{userProps:{type:Object,required:!0},teamId:{type:String,required:!0},taskId:{type:String,required:!0},dialog:{type:Boolean,required:!0},task:{type:Object,required:!0}},emits:["update:dialog","submission-success"],setup(_,{emit:c}){kt();const f=_,V=c,b=k(!1),g=k(!1),r=k(""),I=k(!1),S=k({taskGroupId:f.task.taskGroupId,taskId:f.taskId,userId:f.userProps.userId,teamId:f.teamId,submissionData:[],submissionDate:""}),h=k({});je(async()=>{f.task&&f.task.design&&f.task.design.fields&&R()});const R=()=>{h.value={},f.task.design&&f.task.design.fields&&(f.task.design.fields.forEach(U=>{h.value[U.label]=Q(U)}),S.value.submissionData=f.task.design.fields.map(U=>({label:U.label,type:U.type,value:h.value[U.label]})))},Q=U=>{const L=U.config?.required||!1;switch(U.type.toLowerCase()){case"short text":case"long text":case"urls":case"phone":return L?"":"(Not provided)";case"number":return U.config.min||0;case"date":return new Date().toISOString().split("T")[0];case"select":return U.config.options&&U.config.options.length>0?U.config.options[0]:"(Not provided)";case"image":return L?null:"(No image)";default:return L?"":"(Not provided)"}},G=U=>{switch(U.toLowerCase()){case"short text":case"long text":case"urls":case"phone":return"(Not provided)";case"number":return 0;case"date":return new Date().toISOString().split("T")[0];case"select":return"Default";case"image":return"(No image)";default:return"(Not provided)"}},E=()=>{V("update:dialog",!1),$()},$=()=>{R(),b.value=!1,g.value=!1,r.value="",I.value=!1},q=async(U,L)=>{try{const O=await fetch("undefined/api/images/upload",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:U,filename:L})});if(O.ok)return(await O.json()).fileId;{const Y=await O.json();throw new Error(Y.error||"Failed to upload image")}}catch(O){throw O}},P=async(U,L)=>{const C=L.target.files?.[0],Y=f.task.design.fields.find(ae=>ae.label===U)?.config?.required||!1;if(C){if(C.size>20971520){g.value=!0,r.value=`File size too large. Please select an image smaller than 20MB. Current size: ${(C.size/1024/1024).toFixed(2)}MB`;return}if(!C.type.startsWith("image/")){g.value=!0,r.value="Please select a valid image file (JPG, PNG, GIF, etc.)";return}g.value=!1,r.value="",I.value=!0;try{const _e=new FileReader;_e.onload=async ce=>{let Re=ce.target.result;if(C.size>1024*1024){const be=new Image;be.onload=async()=>{const ge=document.createElement("canvas"),Ce=ge.getContext("2d"),fe=1024;let{width:N,height:u}=be;N>u?N>fe&&(u=u*fe/N,N=fe):u>fe&&(N=N*fe/u,u=fe),ge.width=N,ge.height=u,Ce.drawImage(be,0,0,N,u);const y=ge.toDataURL("image/jpeg",.8);try{const J=await q(y,`${U}_${Date.now()}.jpg`);h.value[U]=J,H()}catch(J){g.value=!0,r.value=`Failed to upload image: ${J.message}`}finally{I.value=!1}},be.src=Re}else try{const be=await q(Re,`${U}_${Date.now()}.${C.type.split("/")[1]}`);h.value[U]=be,H()}catch(be){g.value=!0,r.value=`Failed to upload image: ${be.message}`}finally{I.value=!1}},_e.readAsDataURL(C)}catch{g.value=!0,r.value="Error processing image file",I.value=!1}}else h.value[U]=Y?null:"(No image)",H()},H=()=>{f.task.design&&f.task.design.fields&&(S.value.submissionData=f.task.design.fields.map(U=>({label:U.label,type:U.type,value:h.value[U.label]})));for(const U of f.task.design.fields)if(U.config&&U.config.required){const L=h.value[U.label];(L==null||L==="")&&(h.value[U.label]=Q(U))}},M=()=>{for(const U of f.task.design.fields)if(U.config&&U.config.required){const L=h.value[U.label];if(L==null||L==="")return g.value=!0,r.value=`Please fill the required field: ${U.label}`,!1;if(U.config.min!==void 0&&L<U.config.min)return g.value=!0,r.value=`Value for ${U.label} must be at least ${U.config.min}`,!1;if(U.config.max!==void 0&&L>U.config.max)return g.value=!0,r.value=`Value for ${U.label} must not exceed ${U.config.max}`,!1}return!0},z=async()=>{if(H(),!M())return;const U=S.value.submissionData.map(C=>!(f.task.design.fields.find(ae=>ae.label===C.label)?.config?.required||!1)&&(C.value===null||C.value==="")?{...C,value:G(C.type)}:C),L={...S.value,submissionData:U};L.taskGroupId=f.task.taskGroupId;try{I.value=!0,L.submissionDate=new Date().toISOString();const O=await fetch("undefined/api/tasks/submit",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(O.ok)b.value=!0,g.value=!1,r.value="Task submission successful!",V("submission-success"),setTimeout(()=>{E()},2e3);else{const Y=await O.json();g.value=!0,b.value=!1,r.value=Y.message||"Failed to submit task."}}catch{g.value=!0,r.value="An error occurred during submission."}finally{I.value=!1}},le=U=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[U]||"grey-darken-3",Z=U=>`http://localhost:3000/api/images/${U}`,W=we(()=>{if(!f.task.design||!f.task.design.fields)return!1;for(const U of f.task.design.fields)if(U.config&&U.config.required){const L=h.value[U.label];if(L==null||L==="")return!1}return!0});return Se(h,()=>{H()},{deep:!0}),(U,L)=>(n(),m(Ve,{"model-value":f.dialog,"onUpdate:modelValue":E,"max-width":"800px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"text-h5 pa-4 font-weight-bold"},{default:e(()=>[U.$vuetify.display.smAndUp?(n(),m(F,{key:0,icon:"",onClick:E,variant:"outlined",class:"close-button"},{default:e(()=>[t(w,null,{default:e(()=>[...L[0]||(L[0]=[l("mdi-close",-1)])]),_:1})]),_:1})):D("",!0),s("div",sa,"Submit Task: "+i(f.task.title),1)]),_:1}),t(X,{class:"pa-4"},{default:e(()=>[t(B,{class:"mb-4",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,null,{default:e(()=>[l(i(f.task.title),1)]),_:1}),t(De,null,{default:e(()=>[t(te,{color:le(f.task.priority),class:"mr-2"},{default:e(()=>[l(i(f.task.priority),1)]),_:1},8,["color"]),t(te,{color:"purple-darken-2"},{default:e(()=>[l(i(f.task.category),1)]),_:1}),t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re(_.task.tags,C=>(n(),m(te,{key:C,color:"black",size:"small",class:"ml-1"},{default:e(()=>[l(i(C),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(X,null,{default:e(()=>[s("p",na,i(f.task.description),1),s("div",oa,[s("span",null,"Weight: "+i(f.task.weighted),1)]),s("div",ia,[s("span",null,"Start: "+i(new Date(f.task.startDate).toLocaleDateString()),1),s("span",null,"Due: "+i(new Date(f.task.dueDate).toLocaleDateString()),1)])]),_:1})]),_:1}),b.value?(n(),m(pe,{key:0,type:"success",variant:"tonal",class:"mb-4",closable:""},{default:e(()=>[l(i(r.value),1)]),_:1})):D("",!0),g.value?(n(),m(pe,{key:1,type:"error",variant:"tonal",class:"mb-4",closable:""},{default:e(()=>[l(i(r.value),1)]),_:1})):D("",!0),I.value?(n(),T("div",ua,[t(wt,{indeterminate:"",color:"primary"}),L[1]||(L[1]=s("p",{class:"mt-2"},"Loading...",-1))])):(n(),m(St,{key:3,class:"mt-4"},{default:e(()=>[f.task.design&&f.task.design.fields&&f.task.design.fields.length>0?(n(),T("div",ra,[(n(!0),T(oe,null,re(f.task.design.fields,(C,O)=>(n(),T("div",{key:O,class:"mb-4"},[s("label",da,[l(i(C.label)+" ",1),C.config&&C.config.required?(n(),T("span",ma,"*")):D("",!0)]),C.type.toLowerCase()==="short text"||C.type.toLowerCase()==="urls"||C.type.toLowerCase()==="phone"?(n(),m(xe,{key:0,modelValue:h.value[C.label],"onUpdate:modelValue":Y=>h.value[C.label]=Y,placeholder:`Enter ${C.label}`,variant:"outlined",density:"comfortable",required:C.config&&C.config.required},null,8,["modelValue","onUpdate:modelValue","placeholder","required"])):C.type.toLowerCase()==="long text"?(n(),m(tt,{key:1,modelValue:h.value[C.label],"onUpdate:modelValue":Y=>h.value[C.label]=Y,placeholder:`Enter ${C.label}`,variant:"outlined",density:"comfortable",rows:"3",required:C.config&&C.config.required},null,8,["modelValue","onUpdate:modelValue","placeholder","required"])):C.type.toLowerCase()==="number"?(n(),T("div",ca,[t(xe,{modelValue:h.value[C.label],"onUpdate:modelValue":Y=>h.value[C.label]=Y,modelModifiers:{number:!0},type:"number",variant:"outlined",density:"comfortable",min:C.config?C.config.min:0,max:C.config?C.config.max:null,required:C.config&&C.config.required},null,8,["modelValue","onUpdate:modelValue","min","max","required"]),C.config?(n(),T("p",fa," Range: "+i(C.config.min||0)+" to "+i(C.config.max!==void 0?C.config.max:"unlimited"),1)):D("",!0)])):C.type.toLowerCase()==="date"?(n(),m(xe,{key:3,modelValue:h.value[C.label],"onUpdate:modelValue":Y=>h.value[C.label]=Y,type:"date",variant:"outlined",density:"comfortable",required:C.config&&C.config.required},null,8,["modelValue","onUpdate:modelValue","required"])):C.type.toLowerCase()==="select"?(n(),m(Me,{key:4,modelValue:h.value[C.label],"onUpdate:modelValue":Y=>h.value[C.label]=Y,items:C.config?C.config.options:[],variant:"outlined",density:"comfortable",required:C.config&&C.config.required},null,8,["modelValue","onUpdate:modelValue","items","required"])):C.type.toLowerCase()==="image"?(n(),T("div",va,[t(Xt,{onChange:Y=>P(C.label,Y),placeholder:`Upload ${C.label}`,variant:"outlined",density:"comfortable",accept:"image/*",required:C.config&&C.config.required,hint:"Maximum file size: 20MB. Large images will be automatically compressed.","persistent-hint":""},null,8,["onChange","placeholder","required"]),h.value[C.label]&&h.value[C.label]!=="(No image)"&&h.value[C.label]!==null?(n(),T("div",pa,[L[2]||(L[2]=s("p",{class:"text-caption"},"Current image:",-1)),h.value[C.label].startsWith("data:image")?(n(),m(yt,{key:0,src:h.value[C.label],alt:"Uploaded image",style:{"max-height":"100px","max-width":"100%"}},null,8,["src"])):(n(),m(yt,{key:1,src:Z(h.value[C.label]),alt:"Uploaded image",style:{"max-height":"100px","max-width":"100%"}},null,8,["src"]))])):D("",!0)])):D("",!0)]))),128))])):(n(),T("div",ga,[t(pe,{type:"info",class:"mb-0"},{default:e(()=>[...L[3]||(L[3]=[l(" This task has no submission fields defined. ",-1)])]),_:1})]))]),_:1}))]),_:1}),t(he,{class:"pa-4"},{default:e(()=>[t(F,{onClick:E,variant:"outlined"},{default:e(()=>[...L[4]||(L[4]=[l("Cancel",-1)])]),_:1}),t(ve),t(F,{color:"primary",onClick:z,loading:I.value,disabled:!W.value||I.value},{default:e(()=>[...L[5]||(L[5]=[l(" Submit Task ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}},ba=Object.assign(qe(ya,[["__scopeId","data-v-8c932c52"]]),{__name:"TaskSubmission"}),ka={key:2,class:"mb-4"},wa={__name:"DeleteMembers",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},members:{type:Array,required:!0},teamId:{type:String,required:!0}},emits:["update:dialog","members-removed"],setup(_,{emit:c}){const f={admin:"red",member:"blue"};kt();const V=_,b=k(!1),g=k(!1),r=k(""),I=k(!1),S=k(""),h=k([]),R=()=>{h.value=[]},Q=c,G=we(()=>V.members.filter(M=>M.userId!==V.userProps.userId&&M.username.includes(S.value))),E=M=>{const z=h.value.findIndex(le=>le.userId===M.userId);z===-1?h.value.push(M):h.value.splice(z,1)},$=M=>h.value.some(z=>z.userId===M),q=M=>{if(M?.customRole?.color)return M.customRole.color;const z=M?.baseRole||M?.role||"Member";return f[z.toLowerCase()]||"primary"},P=async()=>{if(h.value.length===0){g.value=!0,b.value=!1,r.value="Please select at least one member to remove";return}I.value=!0;try{const z=h.value.map(W=>({userId:W.userId})),le=await fetch(`undefined/api/teams/${V.teamId}/users/`,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(z)}),Z=await le.json();if(!le.ok)throw new Error(Z.message||"Failed to remove members");b.value=!0,g.value=!1,r.value="Members removed successfully!",Q("members-removed"),setTimeout(()=>{H()},1500)}catch(M){g.value=!0,b.value=!1,r.value=M.message||"Failed to remove members"}finally{I.value=!1}},H=()=>{R(),b.value=!1,g.value=!1,r.value="",Q("update:dialog",!1)};return je(()=>{R()}),(M,z)=>(n(),m(Ve,{modelValue:V.dialog,"onUpdate:modelValue":z[1]||(z[1]=le=>V.dialog=le),"max-width":"600px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:e(()=>[...z[2]||(z[2]=[l(" Remove Team Members ",-1)])]),_:1}),t(X,null,{default:e(()=>[z[6]||(z[6]=s("p",{class:"mb-4"},"Select the members you want to remove from the team:",-1)),b.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",closable:""},{default:e(()=>[l(i(r.value),1)]),_:1})):D("",!0),g.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",closable:""},{default:e(()=>[l(i(r.value),1)]),_:1})):D("",!0),t(xe,{modelValue:S.value,"onUpdate:modelValue":z[0]||(z[0]=le=>S.value=le),label:"Search members by username","prepend-inner-icon":"mdi-magnify",class:"mb-4",variant:"outlined"},null,8,["modelValue"]),h.value.length>0?(n(),T("div",ka,[z[3]||(z[3]=s("p",{class:"text-subtitle-1 mb-2"},"Selected for removal:",-1)),(n(!0),T(oe,null,re(h.value,le=>(n(),m(te,{key:le.userId,class:"ma-1",color:q(le),closable:"","onClick:close":Z=>E(le)},{default:e(()=>[l(i(le.username)+" ("+i(le.roleLabel||le.baseRole||le.role)+") ",1)]),_:2},1032,["color","onClick:close"]))),128))])):D("",!0),G.value.length>0?(n(),m(nt,{key:3},{default:e(()=>[(n(!0),T(oe,null,re(G.value,le=>(n(),m(We,{key:le.userId,onClick:Z=>E(le),class:Be({"selected-member":$(le.userId)})},{append:e(()=>[$(le.userId)?(n(),m(w,{key:0,color:"error"},{default:e(()=>[...z[4]||(z[4]=[l("mdi-check",-1)])]),_:1})):D("",!0)]),default:e(()=>[t(Qe,{class:"d-flex align-center justify-space-between"},{default:e(()=>[s("span",null,i(le.username),1),t(te,{size:"small",color:q(le)},{default:e(()=>[l(i(le.roleLabel||le.baseRole||le.role),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})):(n(),m(pe,{key:4,type:"info",class:"mt-4"},{default:e(()=>[...z[5]||(z[5]=[l(" There are no other members in this team that you can remove. ",-1)])]),_:1}))]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{variant:"outlined",onClick:H,disabled:I.value},{default:e(()=>[...z[7]||(z[7]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{color:"error",variant:"elevated",onClick:P,loading:I.value,disabled:h.value.length===0||I.value},{default:e(()=>[...z[8]||(z[8]=[l(" Remove Selected Members ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},xa=Object.assign(qe(wa,[["__scopeId","data-v-81b4d61e"]]),{__name:"DeleteMembers"}),ha={__name:"DeleteAnnouncements",props:{dialog:{type:Boolean,required:!0},teamId:{type:String,required:!0},announcementId:{type:String,required:!0}},emits:["update:dialog","announcement-deleted"],setup(_,{emit:c}){const f=k(!1),V=k(!1),b=k(""),g=k(!1),r=c,I=async()=>{g.value=!0;try{const R=await fetch(`undefined/api/teams/${S.teamId}/announcements/${S.announcementId}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"}),Q=await R.json();if(!R.ok)throw V.value=!0,f.value=!1,b.value=Q.message||"Failed to delete announcement.",new Error("Failed to delete announcement");f.value=!0,V.value=!1,b.value="Announcement deleted successfully.",r("announcement-deleted"),setTimeout(()=>{r("update:dialog",!1)},1e3)}catch(h){V.value=!0,b.value=h.message||"An error occurred while deleting the announcement."}finally{g.value=!1}},S=_;return(h,R)=>(n(),m(Ve,{modelValue:S.dialog,"onUpdate:modelValue":R[1]||(R[1]=Q=>S.dialog=Q),"max-width":"600px",closable:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:e(()=>[...R[2]||(R[2]=[l(" Delete Announcement ",-1)])]),_:1}),t(X,null,{default:e(()=>[R[3]||(R[3]=s("p",{class:"mb-4"},"Are you sure you want to delete this announcement?",-1)),f.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",closable:""},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0),V.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",closable:""},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0)]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:R[0]||(R[0]=Q=>r("update:dialog",!1)),variant:"outlined",disabled:g.value},{default:e(()=>[...R[4]||(R[4]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{color:"error",variant:"outlined",onClick:I,loading:g.value,disabled:g.value},{default:e(()=>[...R[5]||(R[5]=[l("Confirm Delete",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Ta=Object.assign(ha,{__name:"DeleteAnnouncements"}),_a={class:"flex-grow-1"},Ca={class:"pa-4 border-bottom"},Da={class:"mb-3"},Va={class:"d-flex align-center mb-2"},Ra={class:"text-white"},$a={class:"font-weight-medium"},Ma={class:"text-caption text-grey"},Ia={class:"text-h6 mb-2"},Sa={key:0,class:"text-subtitle-1 text-grey mb-2"},Aa={class:"text-body-1"},Ua={class:"pa-4"},Pa={class:"d-flex align-center justify-space-between mb-4"},Oa={class:"text-h6"},Fa={class:"d-flex align-center justify-space-between"},za={class:"text-caption"},La={key:3,class:"text-center pa-4"},Ea={key:4,class:"text-center pa-4"},Na={key:5},ja={class:"d-flex align-center mb-2"},qa={class:"text-white text-caption"},Ga={class:"flex-grow-1"},Ba={class:"font-weight-medium"},Wa={class:"text-caption text-grey ml-2"},Ha={class:"text-body-2"},Ya={key:0,class:"ml-8"},Ja={class:"d-flex align-center mb-2"},Qa={class:"text-white text-caption"},Ka={class:"font-weight-medium"},Xa={class:"text-caption text-grey ml-2"},Za={class:"text-body-2"},es={__name:"AnnouncementView",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},announcement:{type:Object,required:!0}},emits:["update:dialog","announcement-updated"],setup(_,{emit:c}){const f=k(!1),V=k(!1),b=k(""),g=k(!1),r=k(!1),I=k(!1),S=c,h=_,R=k({content:"",replyTo:""}),Q=k([]);Se(()=>h.announcement,Z=>{Z&&Z._id&&G()}),je(()=>{h.announcement&&h.announcement._id&&G()});const G=()=>{h.announcement.comments&&Array.isArray(h.announcement.comments)&&(Q.value=h.announcement.comments||[])},E=async()=>{if(!R.value.content.trim()){V.value=!0,b.value="Comment content cannot be empty";return}I.value=!0,V.value=!1;try{const W={userId:h.userProps.userId,username:h.userProps.username,content:R.value.content,replyTo:R.value.replyTo||""},U=await fetch(`undefined/api/announcements/${h.announcement._id}/comments`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(W)}),L=await U.json();if(U.ok)f.value=!0,b.value="Comment added successfully!",R.value.content="",R.value.replyTo="",S("announcement-updated"),Q.value.push({...W,_id:L.comment._id,createdAt:new Date().toISOString()}),setTimeout(()=>{f.value=!1,b.value=""},1250),await G();else throw V.value=!0,f.value=!1,b.value=L.message||"Failed to add comment",new Error(L.message||"Failed to add comment")}catch(Z){V.value=!0,b.value=Z.message||"Failed to add comment"}finally{I.value=!1}},$=Z=>{R.value.replyTo=Z._id},q=Z=>Q.value.find(W=>W._id===Z)?.username||"",P=()=>{R.value.replyTo=null},H=()=>{R.value.content="",R.value.replyTo=null,f.value=!1,V.value=!1,b.value="",S("update:dialog",!1)},M=Z=>new Date(Z).toLocaleString(),z=Z=>{const W=new Date,U=new Date(Z),L=Math.floor((W-U)/(1e3*60));return L<1?"Just now":L<60?`${L}m ago`:L<1440?`${Math.floor(L/60)}h ago`:`${Math.floor(L/1440)}d ago`},le=we(()=>{const Z=Q.value.filter(L=>!L.replyTo),W=Q.value.filter(L=>L.replyTo);return Z.map(L=>({...L,replies:W.filter(C=>C.replyTo===L._id)}))});return(Z,W)=>(n(),m(Ve,{"model-value":h.dialog,"onUpdate:modelValue":H,"max-width":"800px",persistent:"",scrollable:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"text-h5 pa-4 font-weight-bold d-flex align-center"},{default:e(()=>[t(F,{icon:"",onClick:H,variant:"text",class:"mr-2"},{default:e(()=>[t(w,null,{default:e(()=>[...W[1]||(W[1]=[l("mdi-close",-1)])]),_:1})]),_:1}),s("span",_a,i(h.announcement.title),1)]),_:1}),h.announcement?(n(),m(X,{key:0,class:"pa-0"},{default:e(()=>[s("div",Ca,[s("div",Da,[s("div",Va,[t(et,{size:"32",color:"primary",class:"mr-2"},{default:e(()=>[s("span",Ra,i(h.announcement.createdByUsername?.[0]?.toUpperCase()),1)]),_:1}),s("div",null,[s("div",$a,i(h.announcement.createdByUsername),1),s("div",Ma,i(M(h.announcement.updatedAt)),1)])]),s("h3",Ia,i(h.announcement.title),1),h.announcement.subtitle?(n(),T("p",Sa,i(h.announcement.subtitle),1)):D("",!0),s("div",Aa,i(h.announcement.content),1)])]),s("div",Ua,[s("div",Pa,[s("h4",Oa,"Comments ("+i(Q.value.length)+")",1),r.value?(n(),m(F,{key:0,variant:"text",size:"small",loading:!0},{default:e(()=>[...W[2]||(W[2]=[l(" Loading... ",-1)])]),_:1})):D("",!0)]),f.value?(n(),m(pe,{key:0,type:"success",variant:"tonal",class:"mb-4",closable:""},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0),V.value?(n(),m(pe,{key:1,type:"error",variant:"tonal",class:"mb-4",closable:""},{default:e(()=>[l(i(b.value),1)]),_:1})):D("",!0),R.value.replyTo?(n(),m(B,{key:2,variant:"outlined",class:"mb-4 pa-3"},{default:e(()=>[s("div",Fa,[s("div",za,[t(w,{size:"small",class:"mr-1"},{default:e(()=>[...W[3]||(W[3]=[l("mdi-reply",-1)])]),_:1}),W[4]||(W[4]=l(" Replying to ",-1)),s("strong",null,i(q(R.value.replyTo)),1)]),t(F,{icon:"",size:"small",onClick:P},{default:e(()=>[t(w,{size:"small"},{default:e(()=>[...W[5]||(W[5]=[l("mdi-close",-1)])]),_:1})]),_:1})])]),_:1})):D("",!0),t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(X,null,{default:e(()=>[t(tt,{modelValue:R.value.content,"onUpdate:modelValue":W[0]||(W[0]=U=>R.value.content=U),label:"Add a comment...",variant:"outlined",rows:"3",disabled:g.value},null,8,["modelValue","disabled"])]),_:1}),t(he,null,{default:e(()=>[t(ve),R.value.replyTo?(n(),m(F,{key:0,variant:"text",onClick:P,disabled:I.value},{default:e(()=>[...W[6]||(W[6]=[l(" Cancel ",-1)])]),_:1},8,["disabled"])):D("",!0),t(F,{color:"primary",onClick:E,loading:I.value,disabled:!R.value.content.trim()||I.value},{default:e(()=>[l(i(R.value.replyTo?"Reply":"Comment"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),r.value?(n(),T("div",La,[t(wt,{indeterminate:"",color:"primary"}),W[7]||(W[7]=s("p",{class:"mt-2"},"Loading comments...",-1))])):le.value.length===0?(n(),T("div",Ea,[t(w,{size:"48",color:"grey"},{default:e(()=>[...W[8]||(W[8]=[l("mdi-comment-outline",-1)])]),_:1}),W[9]||(W[9]=s("p",{class:"text-grey mt-2"},"No comments yet. Be the first to comment!",-1))])):(n(),T("div",Na,[(n(!0),T(oe,null,re(le.value,U=>(n(),T("div",{key:U._id,class:"mb-4"},[t(B,{variant:"outlined",class:"mb-2"},{default:e(()=>[t(X,{class:"pb-2"},{default:e(()=>[s("div",ja,[t(et,{size:"28",color:"primary",class:"mr-2"},{default:e(()=>[s("span",qa,i(U.username?.[0]?.toUpperCase()),1)]),_:2},1024),s("div",Ga,[s("span",Ba,i(U.username),1),s("span",Wa,i(z(U.createdAt)),1)]),t(F,{icon:"",size:"small",variant:"text",onClick:L=>$(U)},{default:e(()=>[t(w,{size:"small"},{default:e(()=>[...W[10]||(W[10]=[l("mdi-reply",-1)])]),_:1})]),_:1},8,["onClick"])]),s("div",Ha,i(U.content),1)]),_:2},1024)]),_:2},1024),U.replies&&U.replies.length>0?(n(),T("div",Ya,[(n(!0),T(oe,null,re(U.replies,L=>(n(),m(B,{key:L._id,variant:"outlined",class:"mb-2"},{default:e(()=>[t(X,{class:"pb-2"},{default:e(()=>[s("div",Ja,[t(w,{size:"small",class:"mr-2 text-grey"},{default:e(()=>[...W[11]||(W[11]=[l("mdi-reply",-1)])]),_:1}),t(et,{size:"24",color:"secondary",class:"mr-2"},{default:e(()=>[s("span",Qa,i(L.username?.[0]?.toUpperCase()),1)]),_:2},1024),s("div",null,[s("span",Ka,i(L.username),1),s("span",Xa,i(z(L.createdAt)),1)])]),s("div",Za,i(L.content),1)]),_:2},1024)]),_:2},1024))),128))])):D("",!0)]))),128))]))])]),_:1})):D("",!0)]),_:1})]),_:1},8,["model-value"]))}},ts=Object.assign(qe(es,[["__scopeId","data-v-ba6ab49b"]]),{__name:"AnnouncementView"}),ls={class:"d-flex align-center"},as={class:"text-h6 mb-2"},ss={key:0,class:"text-body-1 mb-3"},ns={class:"d-flex flex-wrap gap-4"},os={key:0},is={key:0},us={class:"mb-3"},rs={class:"d-flex align-center mb-1"},ds={class:"text-subtitle-2 text-black"},ms={class:"ml-2"},cs={key:0},fs={key:1,class:"text-black"},vs={key:2},ps=["href"],gs={key:1,class:"text-grey-darken-2"},ys={key:3},bs={class:"text-body-2 text-black",style:{"white-space":"pre-wrap","font-family":"inherit"}},ks={key:4},ws={key:1,class:"text-center py-8"},xs={class:"text-body-2 text-grey"},hs={__name:"ViewTask",props:{dialog:{type:Boolean,required:!0},task:{type:Object,required:!0},teamId:{type:String,required:!0},username:{type:String,required:!0}},emits:["update:dialog"],setup(_,{emit:c}){const f=_,V=k(!1),b=k({}),g=k(null),r=k(!1),I=k(""),S=we(()=>g.value&&g.value.submissionData&&g.value.submissionData.length>0),h=we(()=>g.value&&g.value.submittedAt?new Date(g.value.submittedAt).toLocaleString():"Not submitted"),R=async()=>{if(!(!f.task._id||!f.teamId)){V.value=!0,r.value=!1;try{const M=await fetch(`undefined/api/teams/${f.teamId}/task-groups/${f.task.taskGroupId}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(M.ok){const Z=(await M.json()).tasks.find(W=>W._id===f.task._id);b.value=Z||f.task}else b.value=f.task;const z=await fetch(`undefined/api/tasks/submission/${f.teamId}/${f.task._id}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(z.ok){const le=await z.json();g.value=le.submission}else g.value=null}catch{r.value=!0,I.value="Failed to fetch task details",b.value=f.task,g.value=null}finally{V.value=!1}}},Q=H=>new Date(H).toLocaleDateString(),G=H=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[H]||"grey-darken-3",E=H=>H?"success":"warning",$=H=>H?"mdi-check-circle":"mdi-clock-outline",q=H=>!H||H==="(Not provided)"||H.startsWith("http://")||H.startsWith("https://")?H:`https://${H}`,P=H=>`http://localhost:3000/api/images/${H}`;return je(()=>{f.dialog&&R()}),Se(()=>f.dialog,H=>{H&&R()}),(H,M)=>(n(),m(Ve,{modelValue:f.dialog,"onUpdate:modelValue":M[2]||(M[2]=z=>f.dialog=z),"max-width":"800px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"d-flex align-center justify-space-between"},{default:e(()=>[s("div",ls,[t(w,{class:"mr-2"},{default:e(()=>[...M[3]||(M[3]=[l("mdi-clipboard-text",-1)])]),_:1}),M[4]||(M[4]=s("span",{class:"text-h5"},"Task Details",-1))]),t(F,{icon:"",variant:"text",onClick:M[0]||(M[0]=z=>H.$emit("update:dialog",!1))},{default:e(()=>[t(w,null,{default:e(()=>[...M[5]||(M[5]=[l("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),V.value?(n(),m(X,{key:0},{default:e(()=>[t(j,{class:"justify-center"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[t(wt,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1}),t(j,{class:"justify-center mt-4"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[...M[6]||(M[6]=[s("p",{class:"text-h6"},"Loading task details...",-1)])]),_:1})]),_:1})]),_:1})):(n(),m(X,{key:1},{default:e(()=>[r.value?(n(),m(pe,{key:0,type:"warning",class:"mb-4",text:I.value},null,8,["text"])):D("",!0),t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...M[7]||(M[7]=[l("mdi-account",-1)])]),_:1}),l(" "+i(_.username)+" ",1),t(ve),t(te,{color:G(b.value.priority),size:"small",class:"mr-2"},{default:e(()=>[l(i(b.value.priority),1)]),_:1},8,["color"]),t(te,{color:E(b.value.submitted),size:"small"},{default:e(()=>[t(w,{left:"",size:"small"},{default:e(()=>[l(i($(b.value.submitted)),1)]),_:1}),l(" "+i(b.value.submitted?"Submitted":"Pending"),1)]),_:1},8,["color"])]),_:1}),t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("h3",as,i(b.value.title),1),b.value.description?(n(),T("p",ss,i(b.value.description),1)):D("",!0),s("div",ns,[s("div",null,[M[8]||(M[8]=s("strong",null,"Category:",-1)),l(" "+i(b.value.category),1)]),t(ve),s("div",null,[M[9]||(M[9]=s("strong",null,"Due Date:",-1)),l(" "+i(Q(b.value.dueDate)),1)]),b.value.assignedDate?(n(),T("div",os,[M[10]||(M[10]=s("strong",null,"Assigned:",-1)),l(" "+i(Q(b.value.assignedDate)),1)])):D("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{variant:"outlined"},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...M[11]||(M[11]=[l("mdi-file-document",-1)])]),_:1}),M[12]||(M[12]=l(" Submission Details ",-1)),t(ve),t(te,{color:S.value?"success":"grey",size:"small"},{default:e(()=>[l(i(S.value?"Submitted":"No Submission"),1)]),_:1},8,["color"])]),_:1}),t(X,null,{default:e(()=>[S.value?(n(),T("div",is,[s("div",us,[M[13]||(M[13]=s("strong",null,"Submitted on:",-1)),l(" "+i(h.value),1)]),M[14]||(M[14]=s("div",{class:"mb-3"},[s("strong",null,"Submission Details:")],-1)),t(B,{variant:"outlined",color:"grey-lighten-3",class:"pa-3"},{default:e(()=>[(n(!0),T(oe,null,re(g.value.submissionData,z=>(n(),T("div",{key:z.label,class:"mb-3"},[s("div",rs,[s("strong",ds,i(z.label)+":",1),t(te,{size:"x-small",class:"ml-2",color:"primary",variant:"tonal"},{default:e(()=>[l(i(z.type),1)]),_:2},1024)]),s("div",ms,[z.type==="Image"&&z.value&&z.value!=="(No image)"?(n(),T("div",cs,[z.value.startsWith("data:image")?(n(),m(yt,{key:0,src:z.value,"max-width":"1000","max-height":"600",class:"rounded"},null,8,["src"])):(n(),m(yt,{key:1,src:P(z.value),"max-width":"1000","max-height":"600",class:"rounded",loading:!0},null,8,["src"]))])):z.type==="Date"?(n(),T("div",fs,i(Q(z.value)),1)):z.type==="URLs"?(n(),T("div",vs,[z.value&&z.value!=="(Not provided)"?(n(),T("a",{key:0,href:q(z.value),target:"_blank",rel:"noopener noreferrer",class:"text-primary"},i(z.value),9,ps)):(n(),T("span",gs,i(z.value),1))])):z.type==="Long text"?(n(),T("div",ys,[s("pre",bs,i(z.value),1)])):(n(),T("div",ks,[s("span",{class:Be(z.value==="(Not provided)"||z.value==="(No image)"?"text-grey-darken-2":"text-black")},i(z.value),3)]))]),g.value.submissionData.indexOf(z)<g.value.submissionData.length-1?(n(),m(st,{key:0,class:"mt-2"})):D("",!0)]))),128))]),_:1})])):(n(),T("div",ws,[t(w,{size:"64",color:"grey-lighten-1"},{default:e(()=>[...M[15]||(M[15]=[l("mdi-file-outline",-1)])]),_:1}),M[16]||(M[16]=s("p",{class:"text-h6 text-grey mt-2"},"No submission yet",-1)),s("p",xs,"This task hasn't been submitted by "+i(_.username),1)]))]),_:1})]),_:1})]),_:1})),t(he,null,{default:e(()=>[t(ve),t(F,{color:"primary",variant:"outlined",onClick:M[1]||(M[1]=z=>H.$emit("update:dialog",!1))},{default:e(()=>[...M[17]||(M[17]=[l(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Ts=Object.assign(hs,{__name:"ViewTask"}),_s={class:"text-caption text-grey mb-0"},Cs={key:1,class:"text-grey text-caption align-self-center"},Ds={__name:"UpdateTaskGroups",props:{dialog:{type:Boolean,required:!0},taskGroupId:{type:String,required:!0},teamId:{type:String,required:!0},userProps:{type:Object,required:!0},teamMembers:{type:Array,required:!0}},emits:["update:dialog","task-group-updated"],setup(_,{emit:c}){const f=c,V=_,b=k(!1),g=k(!1),r=k(!1),I=k(!1),S=k(""),h=k("overview"),R=k(!1),Q=k({}),G=k(""),E=k({tasks:[],tasksByUser:{},totalUsers:0,completedTasks:0,totalTasks:0,taskGroupId:""}),$=k({title:"",description:"",priority:"",dueDate:"",category:"",weighted:0,assignedUsers:[]}),q=we(()=>E.value.totalTasks===0?0:(E.value.completedTasks/E.value.totalTasks*100).toFixed(1)),P=["Urgent","High","Medium","Low","Optional"],H=["Development","Design","Testing","Documentation","Research","Other"],M=we(()=>V.teamMembers.map(N=>({title:N.username,value:N.userId}))),z=N=>{const u=V.teamMembers.find(y=>y.userId===N);return u?u.username:"Unknown User"},le=N=>{Q.value=N,G.value=z(N.userId),R.value=!0},Z=k(!1);let W=null;function U(){Z.value=!0,W&&clearTimeout(W),W=setTimeout(()=>{Z.value=!1},3500)}function L(){Z.value=!1,W&&clearTimeout(W)}const C=async()=>{b.value=!0;try{const u=await fetch(`undefined/api/teams/${V.teamId}/task-groups/${V.taskGroupId}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),y=await u.json();if(u.ok){E.value=y;const J=y.tasks[0];if(J){const v=[...new Set(y.tasks.map(K=>K.userId))];$.value={title:J.title,description:J.description||"",priority:J.priority,dueDate:J.dueDate?new Date(J.dueDate).toISOString().substr(0,10):"",category:J.category,weighted:J.weighted||0,assignedUsers:v}}}else I.value=!0,S.value=y.message||"Failed to fetch task group details"}catch{I.value=!0,S.value="Failed to fetch task group details"}finally{b.value=!1}},O=async()=>{if(!$.value.title||!$.value.priority||!$.value.dueDate||!$.value.weighted||$.value.assignedUsers.length===0){I.value=!0,S.value="Please fill in all required fields and assign at least one user";return}g.value=!0,I.value=!1;try{const u=await fetch(`undefined/api/teams/${V.teamId}/task-groups/${V.taskGroupId}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:$.value.title,description:$.value.description,priority:$.value.priority,dueDate:new Date($.value.dueDate),category:$.value.category,weighted:Number($.value.weighted),assignedUsers:$.value.assignedUsers})}),y=await u.json();u.ok?(r.value=!0,S.value="Task group updated successfully!",f("task-group-updated"),await C(),setTimeout(()=>{r.value=!1,S.value=""},3e3)):(I.value=!0,S.value=y.message||"Failed to update task group")}catch{I.value=!0,S.value="Failed to update task group"}finally{g.value=!1}},Y=async()=>{if(confirm("Are you sure you want to delete this entire task group? This action cannot be undone.")){g.value=!0;try{const u=await fetch(`undefined/api/teams/${V.teamId}/task-groups/${V.taskGroupId}`,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"}}),y=await u.json();u.ok?(r.value=!0,S.value="Task group deleted successfully!",f("task-group-updated"),setTimeout(()=>{f("update:dialog",!1)},1500)):(I.value=!0,S.value=y.message||"Failed to delete task group")}catch{I.value=!0,S.value="Failed to delete task group"}finally{g.value=!1}}},ae=N=>new Date(N).toLocaleDateString(),_e=N=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[N]||"grey-darken-3",ce=N=>N.submitted?"Submitted":"Pending",Re=N=>N.submitted?"success":"warning",be=N=>{$.value.assignedUsers=$.value.assignedUsers.filter(u=>u!==N)},ge=we(()=>me.canViewTaskGroup()),Ce=we(()=>me.canManageTasks()),fe=we(()=>me.canDeleteTasks());return je(()=>{V.dialog&&V.taskGroupId&&C()}),(N,u)=>(n(),m(Ve,{modelValue:V.dialog,"onUpdate:modelValue":u[14]||(u[14]=y=>V.dialog=y),"max-width":"1200px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"d-flex align-center justify-space-between"},{default:e(()=>[u[16]||(u[16]=s("span",{class:"text-h5"},"Manage Task Group",-1)),t(F,{icon:"",variant:"text",onClick:u[0]||(u[0]=y=>N.$emit("update:dialog",!1))},{default:e(()=>[t(w,null,{default:e(()=>[...u[15]||(u[15]=[l("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),ge.value?(n(),m(X,{key:1},{default:e(()=>[t(vl,{name:"fade"},{default:e(()=>[Z.value?(n(),T("div",{key:0,class:"aws-style-notification",onClick:L,style:{position:"fixed",top:"32px",right:"32px","z-index":"9999","min-width":"320px","max-width":"400px",background:"#232f3e",color:"#fff","border-radius":"8px","box-shadow":"0 2px 8px rgba(0, 0, 0, 0.15)",padding:"18px 24px",cursor:"pointer",display:"flex","align-items":"center",gap:"12px","font-size":"1rem"}},[t(w,{color:"warning",size:"28"},{default:e(()=>[...u[18]||(u[18]=[l("mdi-alert-circle",-1)])]),_:1}),u[20]||(u[20]=s("span",null,"You dont have permission to perform this action",-1)),t(ve),t(w,{color:"grey-lighten-1",size:"20"},{default:e(()=>[...u[19]||(u[19]=[l("mdi-close",-1)])]),_:1})])):D("",!0)]),_:1}),b.value?(n(),m(X,{key:0},{default:e(()=>[t(j,{class:"justify-center"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[t(wt,{indeterminate:"",color:"primary",size:"64"})]),_:1})]),_:1}),t(j,{class:"justify-center mt-4"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[...u[21]||(u[21]=[s("p",{class:"text-h6"},"Loading task group details...",-1)])]),_:1})]),_:1})]),_:1})):(n(),m(X,{key:1},{default:e(()=>[r.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",text:S.value},null,8,["text"])):D("",!0),I.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",text:S.value},null,8,["text"])):D("",!0),t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(ne,null,{default:e(()=>[...u[22]||(u[22]=[l("Task Group Overview",-1)])]),_:1}),t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"primary",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(E.value.totalTasks),1)]),_:1}),t(De,null,{default:e(()=>[...u[23]||(u[23]=[l("Total Tasks",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"success",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(E.value.completedTasks),1)]),_:1}),t(De,null,{default:e(()=>[...u[24]||(u[24]=[l("Completed",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"info",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(E.value.totalUsers),1)]),_:1}),t(De,null,{default:e(()=>[...u[25]||(u[25]=[l("Assigned Users",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"warning",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(q.value)+"%",1)]),_:1}),t(De,null,{default:e(()=>[...u[26]||(u[26]=[l("Completion Rate",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(At,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=y=>h.value=y),class:"mb-4"},{default:e(()=>[t(Ae,{value:"overview"},{default:e(()=>[...u[27]||(u[27]=[l("Overview",-1)])]),_:1}),t(Ae,{value:"edit"},{default:e(()=>[...u[28]||(u[28]=[l("Edit Task Group",-1)])]),_:1})]),_:1},8,["modelValue"]),t(Ut,{modelValue:h.value,"onUpdate:modelValue":u[12]||(u[12]=y=>h.value=y)},{default:e(()=>[t(Ue,{value:"overview"},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[u[30]||(u[30]=s("h3",{class:"text-h6 mb-3"},"Tasks by User",-1)),(n(!0),T(oe,null,re(E.value.tasks,(y,J)=>(n(),m(B,{key:y._id,class:"mb-3",variant:"outlined",onClick:v=>le(y),style:{cursor:"pointer"},hover:""},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...u[29]||(u[29]=[l("mdi-account",-1)])]),_:1}),l(" "+i(z(y.userId))+" ",1),t(ve),t(te,{color:_e(y.priority),size:"small",class:"mr-2"},{default:e(()=>[l(i(y.priority),1)]),_:2},1032,["color"]),t(te,{color:Re(y),size:"small"},{default:e(()=>[l(i(ce(y)),1)]),_:2},1032,["color"])]),_:2},1024),t(X,null,{default:e(()=>[t(j,{class:"align-center"},{default:e(()=>[t(x,{cols:"9"},{default:e(()=>[s("strong",null,i(y.title),1),s("p",_s," Start: "+i(ae(y.startDate))+" Due: "+i(ae(y.dueDate)),1)]),_:2},1024),t(x,{cols:"3",class:"text-right"},{default:e(()=>[t(te,{color:"info",size:"small",class:"mb-1"},{default:e(()=>[l(" Weight: "+i(y.weighted),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),t(Ue,{value:"edit"},{default:e(()=>[t(St,{onSubmit:u[11]||(u[11]=It(y=>Ce.value?O():U(),["prevent"]))},{default:e(()=>[t(j,{class:"pa-2"},{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[t(xe,{modelValue:$.value.title,"onUpdate:modelValue":u[2]||(u[2]=y=>$.value.title=y),label:"Task Title",required:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(Me,{modelValue:$.value.category,"onUpdate:modelValue":u[3]||(u[3]=y=>$.value.category=y),items:H,label:"Category",required:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12"},{default:e(()=>[t(tt,{modelValue:$.value.description,"onUpdate:modelValue":u[4]||(u[4]=y=>$.value.description=y),label:"Description",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(Me,{modelValue:$.value.priority,"onUpdate:modelValue":u[5]||(u[5]=y=>$.value.priority=y),items:P,label:"Priority",required:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(xe,{modelValue:$.value.dueDate,"onUpdate:modelValue":u[6]||(u[6]=y=>$.value.dueDate=y),label:"Due Date",type:"date",required:"",variant:"outlined",min:"2025-01-01",max:"2035-12-31"},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(xe,{modelValue:$.value.weighted,"onUpdate:modelValue":u[7]||(u[7]=y=>$.value.weighted=y),modelModifiers:{number:!0},label:"Task Weight",type:"number",min:"0",required:"",variant:"outlined",hint:"Higher weight = more important task","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(x,{cols:"12"},{default:e(()=>[t(Me,{modelValue:$.value.assignedUsers,"onUpdate:modelValue":u[8]||(u[8]=y=>$.value.assignedUsers=y),items:M.value,label:"Assigned Users",multiple:"",chips:"","closable-chips":"",required:"",variant:"outlined",hint:"Select which team members should complete this task","persistent-hint":""},{selection:e(({item:y,index:J})=>[J<3?(n(),m(te,{key:y.value,size:"small",closable:"","onClick:close":v=>be(y.value)},{default:e(()=>[l(i(y.title),1)]),_:2},1032,["onClick:close"])):D("",!0),J===3?(n(),T("span",Cs," (+"+i($.value.assignedUsers.length-3)+" others) ",1)):D("",!0)]),_:1},8,["modelValue","items"])]),_:1}),t(x,{cols:"12"},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[t(F,{type:"button",color:"primary",loading:g.value,size:"large",onClick:u[9]||(u[9]=y=>Ce.value?O():U())},{default:e(()=>[...u[31]||(u[31]=[l(" Update Task Group ",-1)])]),_:1},8,["loading"])]),_:1}),t(x,{cols:"auto"},{default:e(()=>[t(F,{type:"button",onClick:u[10]||(u[10]=y=>fe.value?Y():U()),color:"red-darken-2",loading:g.value,size:"large",variant:"outlined"},{default:e(()=>[...u[32]||(u[32]=[l(" Delete Task Group ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))]),_:1})):(n(),m(X,{key:0},{default:e(()=>[t(pe,{type:"error"},{default:e(()=>[...u[17]||(u[17]=[l("You dont have permission to perform this action",-1)])]),_:1})]),_:1}))]),_:1}),t(Ts,{dialog:R.value,"onUpdate:dialog":u[13]||(u[13]=y=>R.value=y),task:Q.value,"team-id":_.teamId,username:G.value},null,8,["dialog","task","team-id","username"])]),_:1},8,["modelValue"]))}},Vs=Object.assign(qe(Ds,[["__scopeId","data-v-e33cb208"]]),{__name:"UpdateTaskGroups"}),Rs={class:"d-flex align-center gap-2"},$s={class:"permission-item d-flex align-center justify-space-between"},Ms={class:"permission-item d-flex align-center justify-space-between"},Is={class:"permission-item d-flex align-center justify-space-between"},Ss={class:"permission-item d-flex align-center justify-space-between"},As={class:"permission-item d-flex align-center justify-space-between"},Us={class:"permission-item d-flex align-center justify-space-between"},Ps={class:"permission-item d-flex align-center justify-space-between"},Os={class:"permission-item d-flex align-center justify-space-between"},Fs={class:"permission-item d-flex align-center justify-space-between"},zs={class:"permission-item d-flex align-center justify-space-between"},Ls={class:"permission-item d-flex align-center justify-space-between"},Es={class:"permission-item d-flex align-center justify-space-between"},Ns={class:"mb-3"},js={class:"font-weight-medium mb-2"},qs={__name:"RoleManagement",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},teamMembers:{type:Array,required:!0}},emits:["update:dialog","roles-updated"],setup(_,{emit:c}){const f=_,V=c,b=k({userId:"",username:"",email:""}),g=k(!1),r=k(!1),I=k(!1),S=k(""),h=k(""),R=k(null),Q=k({}),G=k(!1),E=k(null),$=k({}),q=k({}),P=k(!1),H=k(!1),M=k(!1),z=k(""),le=k(!1),Z=k(null),W=J=>{switch(J){case"admin":return"Admin";case"member":default:return"Member"}},U=k([{label:"Admin",value:"admin"},{label:"Member",value:"member"}]),L=we(()=>h.value?f.teamMembers.filter(J=>J.username.includes(h.value)):f.teamMembers),C=J=>{b.value.userId=J.userId,b.value.username=J.username,b.value.email=J.email},O=async()=>{try{await me.fetchUserActions(f.teamId,b.value.userId),Q.value=me.userActions}catch{}},Y=async(J,v)=>{if(v!==J.roleType){if(v==="admin"&&J.roleType!=="admin"){Z.value={member:J,newRoleType:v},le.value=!0;return}await ae(J,v)}},ae=async(J,v)=>{R.value=J.userId,g.value=!0;try{const Te=await fetch(`undefined/api/teams/${f.teamId}/members/${J.userId}/assign-role`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleType:v,roleId:null})}),$e=await Te.json();if(Te.ok){r.value=!0;const se=W(v);S.value=`Successfully changed ${J.username}'s role to ${se}`;const o=f.teamMembers.findIndex(p=>p.userId===J.userId);o!==-1&&(f.teamMembers[o]={...f.teamMembers[o],roleType:v,baseRole:se,roleLabel:se,customRole:null}),V("roles-updated"),setTimeout(()=>{r.value=!1,S.value=""},3e3)}else I.value=!0,S.value=$e.message||"Failed to change role",setTimeout(()=>{I.value=!1,S.value=""},5e3)}catch(K){K.value=!0,S.value="Network error occurred",setTimeout(()=>{K.value=!1,S.value=""},5e3)}finally{R.value=null,g.value=!1}},_e=()=>{Z.value&&(ae(Z.value.member,Z.value.newRoleType),le.value=!1,Z.value=null)},ce=()=>{le.value=!1,Z.value=null},Re=async J=>{E.value=J;try{const Te=await(await fetch(`undefined/api/teams/${f.teamId}/members/${J.userId}/permissions`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}})).json();$.value={canViewTeam:Te.canViewTeam??null,canViewTasks:Te.canViewTasks??null,canViewAnnouncements:Te.canViewAnnouncements??null,canViewMembers:Te.canViewMembers??null,canSubmitTasks:Te.canSubmitTasks??null,canManageAnnouncements:Te.canManageAnnouncements??null,canManageTasks:Te.canManageTasks??null,canDeleteTasks:Te.canDeleteTasks??null,canDeleteAnnouncements:Te.canDeleteAnnouncements??null,canAssignTasks:Te.canAssignTasks??null,canAddMembers:Te.canAddMembers??null,canRemoveMembers:Te.canRemoveMembers??null,canDeleteTeams:Te.canDeleteTeams??null,canCreateSubTeams:Te.canCreateSubTeams??null,canManageCustomRoles:Te.canManageCustomRoles??null},q.value={...$.value},G.value=!0}catch{}},be=(J,v)=>{const K=$.value[J];K===null?$.value[J]=!0:K===!0?$.value[J]=!1:$.value[J]=null},ge=()=>{Object.keys($.value).forEach(J=>{$.value[J]=null})},Ce=async()=>{P.value=!0;try{if(await me.updateUserPermissions(f.teamId,E.value.userId,$.value)){H.value=!0,z.value=`Successfully updated permissions for ${E.value.username}`;const v=f.teamMembers.findIndex(K=>K.userId===E.value.userId);v!==-1&&(f.teamMembers[v].customPermissions={...$.value}),V("roles-updated"),setTimeout(()=>{fe()},2e3)}else M.value=!0,z.value="Failed to update permissions"}catch{M.value=!0,z.value="Network error occurred"}finally{P.value=!1}},fe=()=>{G.value=!1,E.value=null,$.value={},q.value={},H.value=!1,M.value=!1,z.value=""},N=()=>{V("update:dialog",!1),h.value="",r.value=!1,I.value=!1,S.value=""};Se(()=>f.dialog,J=>{J&&O()}),je(()=>{C(f.userProps)});const u=J=>{const v=$.value[J];return me.getPermissionIcon(v)},y=J=>{const v=$.value[J];return me.getPermissionColor(v)};return(J,v)=>(n(),m(Ve,{modelValue:f.dialog,"onUpdate:modelValue":v[15]||(v[15]=K=>f.dialog=K),"max-width":"1000px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:e(()=>[t(w,{class:"mr-2",color:"primary"},{default:e(()=>[...v[16]||(v[16]=[l("mdi-account-cog",-1)])]),_:1}),v[17]||(v[17]=l(" Manage Team Roles & Permissions ",-1))]),_:1}),t(X,null,{default:e(()=>[r.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",closable:""},{default:e(()=>[l(i(S.value),1)]),_:1})):D("",!0),I.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",closable:""},{default:e(()=>[l(i(S.value),1)]),_:1})):D("",!0),t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(ne,{class:"text-h6"},{default:e(()=>[...v[18]||(v[18]=[l("Role Permissions",-1)])]),_:1}),t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{color:"red-lighten-1",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-subtitle-1"},{default:e(()=>[t(w,{class:"mr-2",color:"red"},{default:e(()=>[...v[19]||(v[19]=[l("mdi-crown",-1)])]),_:1}),v[20]||(v[20]=l(" Admin ",-1))]),_:1}),t(X,{class:"text-caption"},{default:e(()=>[...v[21]||(v[21]=[l("  Full access to all features",-1),s("br",null,null,-1),l("  Add/remove members",-1),s("br",null,null,-1),l("  Delete teams and sub-teams",-1),s("br",null,null,-1),l("  Create sub-teams",-1),s("br",null,null,-1),l("  Manage custom roles",-1),s("br",null,null,-1),l("  Change other users' roles",-1),s("br",null,null,-1),s("strong",null," Multiple Admins allowed per team",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{color:"blue-lighten-1",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-subtitle-1"},{default:e(()=>[t(w,{class:"mr-2",color:"blue"},{default:e(()=>[...v[22]||(v[22]=[l("mdi-account",-1)])]),_:1}),v[23]||(v[23]=l(" Member ",-1))]),_:1}),t(X,{class:"text-caption"},{default:e(()=>[...v[24]||(v[24]=[l("  Basic team access",-1),s("br",null,null,-1),l("  View tasks and announcements",-1),s("br",null,null,-1),l("  Submit task assignments",-1),s("br",null,null,-1),l("  View team members",-1),s("br",null,null,-1),l("  Assigned Member role by default",-1),s("br",null,null,-1),l("  Can be assigned custom permissions ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{variant:"outlined"},{default:e(()=>[t(ne,{class:"text-h6"},{default:e(()=>[l("Team Members ("+i(_.teamMembers.length)+")",1)]),_:1}),t(X,null,{default:e(()=>[t(xe,{modelValue:h.value,"onUpdate:modelValue":v[0]||(v[0]=K=>h.value=K),label:"Search members...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",class:"mb-4",clearable:""},null,8,["modelValue"]),t(nt,null,{default:e(()=>[(n(!0),T(oe,null,re(L.value,K=>(n(),m(We,{key:K.userId,class:"mb-2"},pl({prepend:e(()=>[t(et,{color:K.customRole?K.customRole.color||"purple":ke(me).getRoleColor(K.baseRole),class:"mr-3"},{default:e(()=>[t(w,null,{default:e(()=>[l(i(K.customRole?K.customRole.icon||"mdi-star":ke(me).getRoleIcon(K.baseRole)),1)]),_:2},1024)]),_:2},1032,["color"])]),default:e(()=>[t(Qe,{class:"font-weight-medium"},{default:e(()=>[l(i(K.username),1)]),_:2},1024),t(Pt,null,{default:e(()=>[K.customRole?(n(),m(te,{key:0,color:K.customRole.color||"purple",size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(K.customRole.icon||"mdi-star"),1)]),_:2},1024),l(" "+i(K.customRole.name),1)]),_:2},1032,["color"])):(n(),m(te,{key:1,color:ke(me).getRoleColor(K.baseRole),size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(ke(me).getRoleIcon(K.baseRole)),1)]),_:2},1024),l(" "+i(K.roleLabel||K.baseRole),1)]),_:2},1032,["color"])),ke(me).hasCustomPermissions(K)?(n(),m(te,{key:2,color:"purple",size:"small",variant:"outlined",class:"ml-2"},{default:e(()=>[...v[25]||(v[25]=[l(" Custom Permissions ",-1)])]),_:1})):D("",!0)]),_:2},1024)]),_:2},[{name:"append",fn:e(()=>[s("div",Rs,[t(Me,{"model-value":K.roleType,items:U.value,"item-title":"label","item-value":"value","onUpdate:modelValue":Te=>Y(K,Te),variant:"outlined",density:"compact","hide-details":"",class:"role-select",loading:R.value===K.userId,disabled:R.value===K.userId},null,8,["model-value","items","onUpdate:modelValue","loading","disabled"]),t(F,{onClick:Te=>Re(K),color:"purple",variant:"outlined",size:"small",disabled:R.value===K.userId},{default:e(()=>[t(w,{start:""},{default:e(()=>[...v[26]||(v[26]=[l("mdi-cog",-1)])]),_:1}),v[27]||(v[27]=l(" Permissions ",-1))]),_:1},8,["onClick","disabled"])])]),key:"0"}]),1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:N,variant:"outlined",disabled:g.value},{default:e(()=>[...v[29]||(v[29]=[l(" Close ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}),t(Ve,{modelValue:G.value,"onUpdate:modelValue":v[13]||(v[13]=K=>G.value=K),"max-width":"700px",persistent:""},{default:e(()=>[E.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"purple"},{default:e(()=>[...v[30]||(v[30]=[l("mdi-cog",-1)])]),_:1}),l(" Custom Permissions for "+i(E.value.username),1)]),_:1}),t(De,null,{default:e(()=>[l(" Role: "+i(E.value.roleLabel||E.value.baseRole)+" | Override default permissions by checking/unchecking boxes ",1)]),_:1}),t(X,null,{default:e(()=>[H.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",closable:""},{default:e(()=>[l(i(z.value),1)]),_:1})):D("",!0),M.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",closable:""},{default:e(()=>[l(i(z.value),1)]),_:1})):D("",!0),t(pt,{variant:"accordion",class:"mb-4"},{default:e(()=>[t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...v[31]||(v[31]=[l("mdi-eye",-1)])]),_:1}),v[32]||(v[32]=l(" View Permissions ",-1))]),_:1}),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",$s,[v[33]||(v[33]=s("span",{class:"permission-label"},"View Team",-1)),t(F,{icon:u("canViewTeam"),color:y("canViewTeam"),size:"small",variant:"text",onClick:v[1]||(v[1]=K=>be("canViewTeam"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Ms,[v[34]||(v[34]=s("span",{class:"permission-label"},"View Tasks",-1)),t(F,{icon:u("canViewTasks"),color:y("canViewTasks"),size:"small",variant:"text",onClick:v[2]||(v[2]=K=>be("canViewTasks"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Is,[v[35]||(v[35]=s("span",{class:"permission-label"},"View Announcements",-1)),t(F,{icon:u("canViewAnnouncements"),color:y("canViewAnnouncements"),size:"small",variant:"text",onClick:v[3]||(v[3]=K=>be("canViewAnnouncements"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Ss,[v[36]||(v[36]=s("span",{class:"permission-label"},"View Members",-1)),t(F,{icon:u("canViewMembers"),color:y("canViewMembers"),size:"small",variant:"text",onClick:v[4]||(v[4]=K=>be("canViewMembers"))},null,8,["icon","color"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...v[37]||(v[37]=[l("mdi-play",-1)])]),_:1}),v[38]||(v[38]=l(" Action Permissions ",-1))]),_:1}),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",As,[v[39]||(v[39]=s("span",{class:"permission-label"},"Submit Tasks",-1)),t(F,{icon:u("canSubmitTasks"),color:y("canSubmitTasks"),size:"small",variant:"text",onClick:v[5]||(v[5]=K=>be("canSubmitTasks"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Us,[v[40]||(v[40]=s("span",{class:"permission-label"},"Edit Announcements",-1)),t(F,{icon:u("canManageAnnouncements"),color:y("canManageAnnouncements"),size:"small",variant:"text",onClick:v[6]||(v[6]=K=>be("canManageAnnouncements"))},null,8,["icon","color"])])]),_:1})]),_:1})]),_:1})]),_:1}),t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...v[41]||(v[41]=[l("mdi-folder-multiple",-1)])]),_:1}),v[42]||(v[42]=l(" Task Group Permissions ",-1))]),_:1}),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Ps,[v[43]||(v[43]=s("span",{class:"permission-label"},"Create and Edit Tasks",-1)),t(F,{icon:u("canManageTasks"),color:y("canManageTasks"),size:"small",variant:"text",onClick:v[7]||(v[7]=K=>be("canManageTasks"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Os,[v[44]||(v[44]=s("span",{class:"permission-label"},"Delete Tasks",-1)),t(F,{icon:u("canDeleteTasks"),color:y("canDeleteTasks"),size:"small",variant:"text",onClick:v[8]||(v[8]=K=>be("canDeleteTasks"))},null,8,["icon","color"])])]),_:1})]),_:1})]),_:1})]),_:1}),E.value.roleType==="admin"?(n(),m(Le,{key:0},{default:e(()=>[v[51]||(v[51]=l(" > ",-1)),t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...v[45]||(v[45]=[l("mdi-shield-crown",-1)])]),_:1}),v[46]||(v[46]=l(" Management Permissions ",-1))]),_:1}),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Fs,[v[47]||(v[47]=s("span",{class:"permission-label"},"Add Members",-1)),t(F,{icon:u("canAddMembers"),color:y("canAddMembers"),size:"small",variant:"text",onClick:v[9]||(v[9]=K=>be("canAddMembers"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",zs,[v[48]||(v[48]=s("span",{class:"permission-label"},"Remove Members",-1)),t(F,{icon:u("canRemoveMembers"),color:y("canRemoveMembers"),size:"small",variant:"text",onClick:v[10]||(v[10]=K=>be("canRemoveMembers"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Ls,[v[49]||(v[49]=s("span",{class:"permission-label"},"Delete Teams",-1)),t(F,{icon:u("canDeleteTeams"),color:y("canDeleteTeams"),size:"small",variant:"text",onClick:v[11]||(v[11]=K=>be("canDeleteTeams"))},null,8,["icon","color"])])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[s("div",Es,[v[50]||(v[50]=s("span",{class:"permission-label"},"Create Sub-teams",-1)),t(F,{icon:u("canCreateSubTeams"),color:y("canCreateSubTeams"),size:"small",variant:"text",onClick:v[12]||(v[12]=K=>be("canCreateSubTeams"))},null,8,["icon","color"])])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0)]),_:1}),t(pe,{type:"info",variant:"tonal",class:"mb-4 info-msg"},{default:e(()=>[...v[52]||(v[52]=[s("strong",null,"Default (Role-based):",-1),l(" Permissions are enabled by default based on the user's role. ",-1),s("br",null,null,-1),s("strong",null,"Custom Override:",-1),l(" Check/uncheck to override the default role permissions. ",-1),s("br",null,null,-1),s("strong",null,"Gray (Indeterminate):",-1),l(" Using default role permission. ",-1)])]),_:1})]),_:1}),t(he,null,{default:e(()=>[t(F,{onClick:ge,color:"warning",variant:"outlined"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...v[53]||(v[53]=[l("mdi-refresh",-1)])]),_:1}),v[54]||(v[54]=l(" Reset to Defaults ",-1))]),_:1}),t(ve),t(F,{onClick:fe,variant:"outlined",disabled:P.value},{default:e(()=>[...v[55]||(v[55]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:Ce,color:"primary",loading:P.value,disabled:P.value},{default:e(()=>[...v[56]||(v[56]=[l(" Save Permissions ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(Ve,{modelValue:le.value,"onUpdate:modelValue":v[14]||(v[14]=K=>le.value=K),"max-width":"500px",persistent:""},{default:e(()=>[Z.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"warning"},{default:e(()=>[...v[57]||(v[57]=[l("mdi-alert",-1)])]),_:1}),v[58]||(v[58]=l(" Confirm Admin Role Assignment ",-1))]),_:1}),t(X,null,{default:e(()=>[s("p",Ns,[v[59]||(v[59]=l(" Are you sure you want to make ",-1)),s("strong",null,i(Z.value.member.username),1),v[60]||(v[60]=l(" a team ",-1)),s("strong",null,i(W(Z.value.newRoleType)),1),v[61]||(v[61]=l("? ",-1))]),t(pe,{type:"info",variant:"tonal",class:"mb-3"},{default:e(()=>[s("div",js,[t(w,{class:"mr-2"},{default:e(()=>[...v[62]||(v[62]=[l("mdi-information",-1)])]),_:1}),v[63]||(v[63]=l(" Admin Privileges ",-1))]),v[64]||(v[64]=s("div",{class:"text-body-2"}," This user will gain full admin privileges including the ability to manage roles, add/remove members, and access all team features. Multiple admins are allowed per team. ",-1))]),_:1}),v[65]||(v[65]=s("p",{class:"text-caption text-info"}," This action will immediately update permissions and access levels. ",-1))]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:ce,variant:"outlined",disabled:g.value},{default:e(()=>[...v[66]||(v[66]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:_e,color:"primary",variant:"elevated",loading:g.value},{default:e(()=>[...v[67]||(v[67]=[l(" Confirm ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]))}},Gs=Object.assign(qe(qs,[["__scopeId","data-v-0875196d"]]),{__name:"RoleManagement"}),Bs={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-2 mb-4"},Ws={class:"text-h6"},Hs={class:"text-grey mb-0"},Ys={key:0,class:"mt-1"},Js=["onClick"],Qs={class:"mb-4"},Ks={class:"mb-4"},Xs={class:"mb-4"},Zs={class:"mb-4"},en={key:0,class:"mb-4"},tn={class:"text-subtitle-2 mt-2"},ln={class:"text-caption"},an={class:"mb-3"},sn={key:0,class:"text-caption text-grey"},nn={key:0,class:"text-caption text-grey"},on={key:0,class:"text-caption text-grey"},un={class:"mb-3"},rn={class:"d-flex align-center"},dn={__name:"RoleManagementTabs",props:{teamId:{type:String,required:!0},userProps:{type:Object,required:!0},teamMembers:{type:Array,default:()=>[]}},emits:["roles-updated"],setup(_,{emit:c}){const f=_,V=c,b=k("manage-roles"),g=k(!1),r=k(!1),I=k(!1),S=k(""),h=k([]),R=k(!1),Q=k(!1),G=k(!1),E=k(null),$=k({name:"",permissions:[],icon:"mdi-star",color:"purple"}),q=k(!1),P=k(null),H=k(""),M=k(null),z=k(!1),le=(se,o=null)=>{if(se==="admin")return"Admin";if(se==="member")return"Member";if(se==="custom"&&o){const p=h.value.find(ie=>ie._id===o);return p?p.name:"Custom Role"}return"Member"},Z=k(!1),W=k(null),U=["mdi-star","mdi-crown","mdi-shield","mdi-account-star","mdi-medal","mdi-fire","mdi-lightning-bolt","mdi-diamond","mdi-heart","mdi-star-circle","mdi-trophy","mdi-rocket","mdi-flash","mdi-shield-star","mdi-account-circle","mdi-palette","mdi-wrench","mdi-cog","mdi-tools","mdi-hammer","mdi-briefcase","mdi-folder-star","mdi-flag","mdi-star-box","mdi-gift"],L=[{name:"Purple",value:"purple"},{name:"Deep Purple",value:"deep-purple"},{name:"Indigo",value:"indigo"},{name:"Blue",value:"blue"},{name:"Light Blue",value:"light-blue"},{name:"Cyan",value:"cyan"},{name:"Teal",value:"teal"},{name:"Green",value:"green"},{name:"Light Green",value:"light-green"},{name:"Lime",value:"lime"},{name:"Yellow",value:"yellow"},{name:"Amber",value:"amber"},{name:"Orange",value:"orange"},{name:"Deep Orange",value:"deep-orange"},{name:"Brown",value:"brown"},{name:"Blue Grey",value:"blue-grey"},{name:"Pink",value:"pink"},{name:"Red",value:"red"}],C=Mt,O=we(()=>{let se=f.teamMembers;return se=se.filter(o=>o.userId!==f.userProps.userId),H.value?se.filter(o=>o.username.includes(H.value)):se}),Y=we(()=>{const se={};return C.filter(p=>p.category!=="Admin Only"&&p.category!=="Basic").forEach(p=>{se[p.category]||(se[p.category]=[]),se[p.category].push(p)}),se}),ae=async()=>{try{g.value=!0;const o=await fetch(`undefined/api/teams/${f.teamId}/roles`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch custom roles");const p=await o.json();h.value=p.roles||[]}catch{I.value=!0,S.value="Failed to fetch custom roles"}finally{g.value=!1}},_e=async()=>{try{g.value=!0;const o=await fetch(`undefined/api/teams/${f.teamId}/roles`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:$.value.name,permissions:$.value.permissions,icon:$.value.icon,color:$.value.color})});if(!o.ok)throw new Error("Failed to create custom role");const p=await o.json();r.value=!0,S.value="Custom role created successfully!",R.value=!1,N(),await ae()}catch{I.value=!0,S.value="Failed to create custom role"}finally{g.value=!1}},ce=async()=>{try{if(g.value=!0,!(await fetch(`undefined/api/teams/${f.teamId}/roles/${E.value._id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:E.value.name,permissions:E.value.permissions,icon:E.value.icon,color:E.value.color})})).ok)throw new Error("Failed to update custom role");r.value=!0,S.value="Custom role updated successfully!",Q.value=!1,await ae(),V("roles-updated")}catch{I.value=!0,S.value="Failed to update custom role"}finally{g.value=!1}},Re=async()=>{try{if(g.value=!0,!(await fetch(`undefined/api/teams/${f.teamId}/roles/${E.value._id}`,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to delete custom role");r.value=!0,S.value="Custom role deleted successfully!",G.value=!1,await ae(),V("roles-updated")}catch{I.value=!0,S.value="Failed to delete custom role"}finally{g.value=!1}},be=async(se,o,p=null)=>{try{g.value=!0;const ye=`undefined/api/teams/${f.teamId}/members/${se.userId}/assign-role`,Ke=await fetch(ye,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({roleType:o,roleId:p||null})});if(!Ke.ok){const Fe=await Ke.json();throw new Error(Fe.message||"Failed to assign role")}const Ot=await Ke.json();r.value=!0;const ot=le(o,p);S.value=`Role assigned to ${se.username} successfully! (${ot})`;const Ye=o==="admin"?"Admin":"Member";if(se.roleType=o,se.baseRole=Ye,se.roleLabel=o==="custom"?ot:Ye,o==="custom"&&p){const Fe=h.value.find(xt=>xt._id===p);se.customRole=Fe?{id:Fe._id,name:Fe.name,permissions:Fe.permissions,icon:Fe.icon,color:Fe.color}:null}else se.customRole=null;q.value=!1,z.value=!1,V("roles-updated")}catch(ie){I.value=!0,S.value=ie.message||"Failed to assign role"}finally{g.value=!1}},ge=(se,o,p=null)=>{const ie=le(o,p);M.value={member:se,roleType:o,roleId:p,roleName:ie},z.value=!0},Ce=()=>{M.value&&be(M.value.member,M.value.roleType,M.value.roleId)},fe=()=>{M.value=null,z.value=!1},N=()=>{$.value={name:"",permissions:[],icon:"mdi-star",color:"purple"}},u=()=>{N(),R.value=!0},y=se=>{E.value={...se,icon:se.icon||"mdi-star",color:se.color||"purple"},Q.value=!0},J=se=>{E.value=se,G.value=!0},v=se=>{P.value=se,q.value=!0},K=se=>{W.value=se,Z.value=!0},Te=()=>{Z.value=!1,W.value=null},$e=se=>!W.value||!W.value.permissions?[]:W.value.permissions.filter(o=>{const p=C.find(ie=>ie.key===o);return p&&p.category.toLowerCase()===se.toLowerCase()});return Se(()=>f.teamId,se=>{se&&ae()}),je(async()=>{f.teamId&&(await me.fetchUserActions(f.teamId,f.userProps.userId),ae())}),(se,o)=>(n(),m(bt,{fluid:""},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[o[21]||(o[21]=s("h2",{class:"text-h5 mb-4"},"Role Management",-1)),r.value?(n(),m(pe,{key:0,type:"success",class:"mb-4",closable:"","onClick:close":o[0]||(o[0]=p=>r.value=!1)},{default:e(()=>[l(i(S.value),1)]),_:1})):D("",!0),I.value?(n(),m(pe,{key:1,type:"error",class:"mb-4",closable:"","onClick:close":o[1]||(o[1]=p=>I.value=!1)},{default:e(()=>[l(i(S.value),1)]),_:1})):D("",!0)]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(At,{modelValue:b.value,"onUpdate:modelValue":o[2]||(o[2]=p=>b.value=p),"align-tabs":"start"},{default:e(()=>[t(Ae,{value:"manage-roles"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[22]||(o[22]=[l("mdi-star-settings",-1)])]),_:1}),o[23]||(o[23]=l(" Custom Roles ",-1))]),_:1}),t(Ae,{value:"assign-roles"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[24]||(o[24]=[l("mdi-account-cog",-1)])]),_:1}),o[25]||(o[25]=l(" Assign Roles ",-1))]),_:1}),t(Ae,{value:"permissions"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[26]||(o[26]=[l("mdi-shield-check",-1)])]),_:1}),o[27]||(o[27]=l(" Role Permissions ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(Ut,{modelValue:b.value,"onUpdate:modelValue":o[4]||(o[4]=p=>b.value=p)},{default:e(()=>[t(Ue,{value:"manage-roles"},{default:e(()=>[t(j,{class:"mt-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",Bs,[s("h3",Ws,"Custom Roles ("+i(h.value.length)+")",1),t(F,{onClick:u,color:"primary",variant:"elevated",size:"large",class:"flex-grow-1 flex-md-grow-0 mt-4"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[28]||(o[28]=[l("mdi-plus",-1)])]),_:1}),o[29]||(o[29]=l(" Create Custom Role ",-1))]),_:1})])]),_:1})]),_:1}),h.value.length>0?(n(),m(j,{key:0},{default:e(()=>[(n(!0),T(oe,null,re(h.value,p=>(n(),m(x,{key:p._id,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2",color:p.color||"purple"},{default:e(()=>[l(i(p.icon||"mdi-star"),1)]),_:2},1032,["color"]),l(" "+i(p.name),1)]),_:2},1024),t(De,null,{default:e(()=>[l(i(p.permissions.length)+" permissions assigned ",1)]),_:2},1024)]),_:2},1024),t(X,null,{default:e(()=>[o[30]||(o[30]=s("div",{class:"text-caption mb-2"},"Permissions:",-1)),t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re(p.permissions.slice(0,3),ie=>(n(),m(te,{key:ie,size:"small",color:"purple",variant:"outlined"},{default:e(()=>[l(i(ke(C).find(ye=>ye.key===ie)?.label||ie),1)]),_:2},1024))),128)),p.permissions.length>3?(n(),m(te,{key:0,size:"small",variant:"text",color:"blue",onClick:ie=>K(p),style:{cursor:"pointer"}},{default:e(()=>[l(" +"+i(p.permissions.length-3)+" more ",1)]),_:2},1032,["onClick"])):D("",!0)]),_:2},1024)]),_:2},1024),t(he,null,{default:e(()=>[t(F,{onClick:ie=>y(p),color:"primary",variant:"outlined",size:"small"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[31]||(o[31]=[l("mdi-pencil",-1)])]),_:1}),o[32]||(o[32]=l(" Edit ",-1))]),_:1},8,["onClick"]),t(F,{onClick:ie=>J(p),color:"error",variant:"outlined",size:"small"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[33]||(o[33]=[l("mdi-delete",-1)])]),_:1}),o[34]||(o[34]=l(" Delete ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),m(j,{key:1},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"text-center pa-6",variant:"outlined"},{default:e(()=>[t(X,null,{default:e(()=>[t(w,{size:"64",class:"mb-4",color:"grey"},{default:e(()=>[...o[35]||(o[35]=[l("mdi-star-outline",-1)])]),_:1}),o[38]||(o[38]=s("h3",{class:"text-h6 mb-2"},"No Custom Roles",-1)),o[39]||(o[39]=s("p",{class:"text-grey mb-4"}," Create custom roles with specific permissions for your team members. ",-1)),t(F,{color:"primary",onClick:u,size:"large"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[36]||(o[36]=[l("mdi-plus",-1)])]),_:1}),o[37]||(o[37]=l(" Create Your First Custom Role ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),t(Ue,{value:"assign-roles"},{default:e(()=>[t(j,{class:"mt-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[o[41]||(o[41]=s("h3",{class:"text-h6 mb-4"},"Assign Roles to Members",-1)),t(pe,{type:"info",class:"mb-4"},{default:e(()=>[...o[40]||(o[40]=[s("strong",null,"Note:",-1),l(" You cannot change your own role. Only other team members are shown below. ",-1)])]),_:1}),t(xe,{modelValue:H.value,"onUpdate:modelValue":o[3]||(o[3]=p=>H.value=p),label:"Search members...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",class:"mb-4",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),O.value.length>0?(n(),m(j,{key:0},{default:e(()=>[(n(!0),T(oe,null,re(O.value,p=>(n(),m(x,{key:p.userId,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(et,{color:p.customRole?p.customRole.color||"purple":ke(me).getRoleColor(p.baseRole),class:"mr-3"},{default:e(()=>[t(w,null,{default:e(()=>[l(i(p.customRole?p.customRole.icon||"mdi-star":ke(me).getRoleIcon(p.baseRole)),1)]),_:2},1024)]),_:2},1032,["color"]),l(" "+i(p.username),1)]),_:2},1024),t(De,null,{default:e(()=>[p.customRole?(n(),m(te,{key:0,color:p.customRole.color||"purple",size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(p.customRole.icon||"mdi-star"),1)]),_:2},1024),l(" "+i(p.customRole.name),1)]),_:2},1032,["color"])):(n(),m(te,{key:1,color:ke(me).getRoleColor(p.baseRole),size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(ke(me).getRoleIcon(p.baseRole)),1)]),_:2},1024),l(" "+i(p.roleLabel||p.baseRole),1)]),_:2},1032,["color"]))]),_:2},1024)]),_:2},1024),t(he,null,{default:e(()=>[t(F,{onClick:ie=>v(p),color:"primary",variant:"outlined",size:"small"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[42]||(o[42]=[l("mdi-account-cog",-1)])]),_:1}),o[43]||(o[43]=l(" Change Role ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(n(),m(j,{key:1},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"text-center pa-6",variant:"outlined"},{default:e(()=>[t(X,null,{default:e(()=>[t(w,{size:"64",class:"mb-4",color:"grey"},{default:e(()=>[...o[44]||(o[44]=[l("mdi-account-lock",-1)])]),_:1}),o[45]||(o[45]=s("h3",{class:"text-h6 mb-2"},"No Members Available",-1)),s("p",Hs,i(H.value?"No members found matching your search that can have their roles changed.":"There are no other team members whose roles you can change."),1)]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),t(Ue,{value:"permissions"},{default:e(()=>[t(j,{class:"mt-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[...o[46]||(o[46]=[s("h3",{class:"text-h6 mb-4"},"Role Permissions Overview",-1)])]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{color:"red-lighten-1",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-subtitle-1"},{default:e(()=>[t(w,{class:"mr-2",color:"red"},{default:e(()=>[...o[47]||(o[47]=[l("mdi-crown",-1)])]),_:1}),o[48]||(o[48]=l(" Admin ",-1))]),_:1}),t(X,{class:"text-caption"},{default:e(()=>[...o[49]||(o[49]=[l("  Full access to all features",-1),s("br",null,null,-1),l("  Add/remove members",-1),s("br",null,null,-1),l("  Delete teams and sub-teams",-1),s("br",null,null,-1),l("  Create sub-teams",-1),s("br",null,null,-1),l("  Manage custom roles",-1),s("br",null,null,-1),l("  All task and announcement permissions",-1),s("br",null,null,-1),s("strong",null," Multiple Admins allowed per team",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{color:"blue-lighten-1",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-subtitle-1"},{default:e(()=>[t(w,{class:"mr-2",color:"blue"},{default:e(()=>[...o[50]||(o[50]=[l("mdi-account",-1)])]),_:1}),o[51]||(o[51]=l(" Member ",-1))]),_:1}),t(X,{class:"text-caption"},{default:e(()=>[...o[52]||(o[52]=[s("strong",null,"Basic permissions (automatically granted):",-1),s("br",null,null,-1),l("  View team details",-1),s("br",null,null,-1),l("  View tasks and announcements",-1),s("br",null,null,-1),l("  Submit task assignments",-1),s("br",null,null,-1),l("  View team members",-1),s("br",null,null,-1),l("  Assigned by default when added by non-Admin",-1),s("br",null,null,-1),l("  Can receive additional custom permissions ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),h.value.length>0?(n(),m(j,{key:0,class:"mt-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[...o[53]||(o[53]=[s("h4",{class:"text-subtitle-1 mb-4"},"Custom Roles",-1)])]),_:1}),(n(!0),T(oe,null,re(h.value,p=>(n(),m(x,{key:p._id,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{color:(p.color||"purple")+"-lighten-1",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-subtitle-1"},{default:e(()=>[t(w,{class:"mr-2",color:p.color||"purple"},{default:e(()=>[l(i(p.icon||"mdi-star"),1)]),_:2},1032,["color"]),l(" "+i(p.name),1)]),_:2},1024),t(X,{class:"text-caption"},{default:e(()=>[(n(!0),T(oe,null,re(p.permissions.slice(0,6),ie=>(n(),T("div",{key:ie},"  "+i(ke(C).find(ye=>ye.key===ie)?.label||ie),1))),128)),p.permissions.length>6?(n(),T("div",Ys,[s("span",{onClick:ie=>K(p),style:{cursor:"pointer",color:"#1976d2","text-decoration":"underline"}}," ... and "+i(p.permissions.length-6)+" more permissions ",9,Js)])):D("",!0)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})):D("",!0)]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:R.value,"onUpdate:modelValue":o[8]||(o[8]=p=>R.value=p),"max-width":"800px",persistent:""},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"primary"},{default:e(()=>[...o[54]||(o[54]=[l("mdi-plus",-1)])]),_:1}),o[55]||(o[55]=l(" Create Custom Role ",-1))]),_:1}),t(X,null,{default:e(()=>[t(xe,{modelValue:$.value.name,"onUpdate:modelValue":o[5]||(o[5]=p=>$.value.name=p),label:"Role Name",placeholder:"e.g., Project Manager, Content Creator",variant:"outlined",class:"mb-4",required:""},null,8,["modelValue"]),t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[o[57]||(o[57]=s("h4",{class:"text-subtitle-1 mb-3"},"Choose Icon",-1)),t(Qt,null,{activator:e(({props:p})=>[t(F,Vt(p,{variant:"outlined",class:"mb-2",block:""}),{default:e(()=>[t(w,{start:"",color:$.value.color},{default:e(()=>[l(i($.value.icon),1)]),_:1},8,["color"]),o[56]||(o[56]=l(" Select Icon ",-1))]),_:1},16)]),default:e(()=>[t(B,{"max-width":"400","max-height":"300",class:"overflow-y-auto"},{default:e(()=>[t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[(n(),T(oe,null,re(U,p=>t(x,{key:p,cols:"3",class:"text-center"},{default:e(()=>[t(F,{icon:"",variant:"text",onClick:ie=>$.value.icon=p,color:$.value.icon===p?$.value.color:"grey"},{default:e(()=>[t(w,null,{default:e(()=>[l(i(p),1)]),_:2},1024)]),_:2},1032,["onClick","color"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[o[60]||(o[60]=s("h4",{class:"text-subtitle-1 mb-3"},"Choose Color",-1)),t(Me,{modelValue:$.value.color,"onUpdate:modelValue":o[6]||(o[6]=p=>$.value.color=p),items:L,"item-title":"name","item-value":"value",label:"Role Color",variant:"outlined"},{selection:e(({item:p})=>[t(te,{color:p.raw.value,variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[58]||(o[58]=[l("mdi-circle",-1)])]),_:1}),l(" "+i(p.raw.name),1)]),_:2},1032,["color"])]),item:e(({item:p,props:ie})=>[t(We,Rt($t(ie)),{prepend:e(()=>[t(w,{color:p.raw.value},{default:e(()=>[...o[59]||(o[59]=[l("mdi-circle",-1)])]),_:1},8,["color"])]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(B,{variant:"outlined",class:"mb-4 pa-3"},{default:e(()=>[o[61]||(o[61]=s("div",{class:"text-subtitle-2 mb-2"},"Preview:",-1)),t(te,{color:$.value.color,size:"large",variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[l(i($.value.icon),1)]),_:1}),l(" "+i($.value.name||"Role Name"),1)]),_:1},8,["color"])]),_:1}),s("div",Qs,[o[64]||(o[64]=s("h4",{class:"text-subtitle-1 mb-3"},"Select Permissions",-1)),t(pe,{type:"info",variant:"tonal",class:"mb-3 info-msg"},{default:e(()=>[...o[62]||(o[62]=[s("strong",null,"Note:",-1),l(" Basic permissions (View Team, Tasks, Announcements, Members, Task Groups, Submit Tasks) are automatically granted to all users and cannot be modified. ",-1)])]),_:1}),t(pt,{variant:"accordion"},{default:e(()=>[(n(!0),T(oe,null,re(Y.value,(p,ie)=>(n(),m(Le,{key:ie},{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[63]||(o[63]=[l("mdi-folder",-1)])]),_:1}),l(" "+i(ie)+" Permissions ",1),t(ve),t(te,{size:"small",variant:"outlined"},{default:e(()=>[l(i(p.filter(ye=>$.value.permissions.includes(ye.key)).length)+"/"+i(p.length),1)]),_:2},1024)]),_:2},1024),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[(n(!0),T(oe,null,re(p,ye=>(n(),m(x,{key:ye.key,cols:"12",md:"6"},{default:e(()=>[t(gt,{modelValue:$.value.permissions,"onUpdate:modelValue":ue=>$.value.permissions=ue,value:ye.key,label:ye.label,hint:ye.description,"persistent-hint":"",density:"compact"},null,8,["modelValue","onUpdate:modelValue","value","label","hint"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:o[7]||(o[7]=p=>R.value=!1),variant:"outlined",disabled:g.value},{default:e(()=>[...o[65]||(o[65]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:_e,color:"primary",variant:"elevated",loading:g.value,disabled:!$.value.name||$.value.permissions.length===0},{default:e(()=>[...o[66]||(o[66]=[l(" Create Role ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ve,{modelValue:Q.value,"onUpdate:modelValue":o[12]||(o[12]=p=>Q.value=p),"max-width":"800px",persistent:""},{default:e(()=>[E.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"primary"},{default:e(()=>[...o[67]||(o[67]=[l("mdi-pencil",-1)])]),_:1}),l(" Edit Role: "+i(E.value.name),1)]),_:1}),t(X,null,{default:e(()=>[t(xe,{modelValue:E.value.name,"onUpdate:modelValue":o[9]||(o[9]=p=>E.value.name=p),label:"Role Name",variant:"outlined",class:"mb-4",required:""},null,8,["modelValue"]),t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[o[69]||(o[69]=s("h4",{class:"text-subtitle-1 mb-3"},"Choose Icon",-1)),t(Qt,null,{activator:e(({props:p})=>[t(F,Vt(p,{variant:"outlined",class:"mb-2",block:""}),{default:e(()=>[t(w,{start:"",color:E.value.color},{default:e(()=>[l(i(E.value.icon),1)]),_:1},8,["color"]),o[68]||(o[68]=l(" Select Icon ",-1))]),_:1},16)]),default:e(()=>[t(B,{"max-width":"400","max-height":"300",class:"overflow-y-auto"},{default:e(()=>[t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[(n(),T(oe,null,re(U,p=>t(x,{key:p,cols:"3",class:"text-center"},{default:e(()=>[t(F,{icon:"",variant:"text",onClick:ie=>E.value.icon=p,color:E.value.icon===p?E.value.color:"grey"},{default:e(()=>[t(w,null,{default:e(()=>[l(i(p),1)]),_:2},1024)]),_:2},1032,["onClick","color"])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[o[72]||(o[72]=s("h4",{class:"text-subtitle-1 mb-3"},"Choose Color",-1)),t(Me,{modelValue:E.value.color,"onUpdate:modelValue":o[10]||(o[10]=p=>E.value.color=p),items:L,"item-title":"name","item-value":"value",label:"Role Color",variant:"outlined"},{selection:e(({item:p})=>[t(te,{color:p.raw.value,variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...o[70]||(o[70]=[l("mdi-circle",-1)])]),_:1}),l(" "+i(p.raw.name),1)]),_:2},1032,["color"])]),item:e(({item:p,props:ie})=>[t(We,Rt($t(ie)),{prepend:e(()=>[t(w,{color:p.raw.value},{default:e(()=>[...o[71]||(o[71]=[l("mdi-circle",-1)])]),_:1},8,["color"])]),default:e(()=>[t(Qe,null,{default:e(()=>[l(i(p.raw.name),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(B,{variant:"outlined",class:"mb-4 pa-3"},{default:e(()=>[o[73]||(o[73]=s("div",{class:"text-subtitle-2 mb-2"},"Preview:",-1)),t(te,{color:E.value.color,size:"large",variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[l(i(E.value.icon),1)]),_:1}),l(" "+i(E.value.name||"Role Name"),1)]),_:1},8,["color"])]),_:1}),s("div",Ks,[o[76]||(o[76]=s("h4",{class:"text-subtitle-1 mb-3"},"Update Permissions",-1)),t(pe,{type:"info",variant:"tonal",class:"mb-3 info-msg"},{default:e(()=>[...o[74]||(o[74]=[s("strong",null,"Note:",-1),l(" Basic permissions (View Team, Tasks, Announcements, Members, Task Groups, Submit Tasks) are automatically granted to all users and cannot be modified. ",-1)])]),_:1}),t(pt,{variant:"accordion"},{default:e(()=>[(n(!0),T(oe,null,re(Y.value,(p,ie)=>(n(),m(Le,{key:ie},{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[75]||(o[75]=[l("mdi-folder",-1)])]),_:1}),l(" "+i(ie)+" Permissions ",1),t(ve),t(te,{size:"small",variant:"outlined"},{default:e(()=>[l(i(p.filter(ye=>E.value.permissions.includes(ye.key)).length)+"/"+i(p.length),1)]),_:2},1024)]),_:2},1024),t(Ne,null,{default:e(()=>[t(j,null,{default:e(()=>[(n(!0),T(oe,null,re(p,ye=>(n(),m(x,{key:ye.key,cols:"12",md:"6"},{default:e(()=>[t(gt,{modelValue:E.value.permissions,"onUpdate:modelValue":ue=>E.value.permissions=ue,value:ye.key,label:ye.label,hint:ye.description,"persistent-hint":"",density:"compact"},null,8,["modelValue","onUpdate:modelValue","value","label","hint"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:o[11]||(o[11]=p=>Q.value=!1),variant:"outlined",disabled:g.value},{default:e(()=>[...o[77]||(o[77]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:ce,color:"primary",variant:"elevated",loading:g.value,disabled:!E.value.name||E.value.permissions.length===0},{default:e(()=>[...o[78]||(o[78]=[l(" Update Role ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(Ve,{modelValue:G.value,"onUpdate:modelValue":o[14]||(o[14]=p=>G.value=p),"max-width":"500px",persistent:""},{default:e(()=>[E.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"error"},{default:e(()=>[...o[79]||(o[79]=[l("mdi-delete",-1)])]),_:1}),o[80]||(o[80]=l(" Delete Role ",-1))]),_:1}),t(X,null,{default:e(()=>[s("p",null,[o[81]||(o[81]=l(" Are you sure you want to delete the role ",-1)),s("strong",null,i(E.value.name),1),o[82]||(o[82]=l("? ",-1))]),o[83]||(o[83]=s("p",{class:"text-caption text-error"}," This action cannot be undone. Members with this role will be reverted to the default Member role. ",-1))]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:o[13]||(o[13]=p=>G.value=!1),variant:"outlined",disabled:g.value},{default:e(()=>[...o[84]||(o[84]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:Re,color:"error",variant:"elevated",loading:g.value},{default:e(()=>[...o[85]||(o[85]=[l(" Delete Role ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(Ve,{modelValue:q.value,"onUpdate:modelValue":o[18]||(o[18]=p=>q.value=p),"max-width":"600px",persistent:""},{default:e(()=>[P.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"primary"},{default:e(()=>[...o[86]||(o[86]=[l("mdi-account-cog",-1)])]),_:1}),l(" Change Role for "+i(P.value.username),1)]),_:1}),t(X,null,{default:e(()=>[s("div",Xs,[o[87]||(o[87]=s("h4",{class:"text-subtitle-1 mb-3"},"Current Role",-1)),P.value.customRole?(n(),m(te,{key:0,color:P.value.customRole.color||"purple",size:"large",variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[l(i(P.value.customRole.icon||"mdi-star"),1)]),_:1}),l(" "+i(P.value.customRole.name),1)]),_:1},8,["color"])):(n(),m(te,{key:1,color:ke(me).getRoleColor(P.value.baseRole),size:"large",variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[l(i(ke(me).getRoleIcon(P.value.baseRole)),1)]),_:1}),l(" "+i(P.value.roleLabel||P.value.baseRole),1)]),_:1},8,["color"]))]),s("div",Zs,[o[92]||(o[92]=s("h4",{class:"text-subtitle-1 mb-3"},"Assign Default Role",-1)),t(j,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{class:"text-center pa-4 cursor-pointer",variant:"outlined",color:!P.value.customRole&&P.value.roleType==="member"?"primary":"",onClick:o[15]||(o[15]=p=>ge(P.value,"member"))},{default:e(()=>[t(w,{size:"40",color:"primary"},{default:e(()=>[...o[88]||(o[88]=[l("mdi-account",-1)])]),_:1}),o[89]||(o[89]=s("div",{class:"text-subtitle-2 mt-2"},"Member",-1))]),_:1},8,["color"])]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(B,{class:"text-center pa-4 cursor-pointer",variant:"outlined",color:!P.value.customRole&&P.value.roleType==="admin"?"red":"",onClick:o[16]||(o[16]=p=>ge(P.value,"admin"))},{default:e(()=>[t(w,{size:"40",color:"red"},{default:e(()=>[...o[90]||(o[90]=[l("mdi-crown",-1)])]),_:1}),o[91]||(o[91]=s("div",{class:"text-subtitle-2 mt-2"},"Admin",-1))]),_:1},8,["color"])]),_:1})]),_:1})]),h.value.length>0?(n(),T("div",en,[o[93]||(o[93]=s("h4",{class:"text-subtitle-1 mb-3"},"Assign Custom Role",-1)),t(j,null,{default:e(()=>[(n(!0),T(oe,null,re(h.value,p=>(n(),m(x,{key:p._id,cols:"12",md:"6"},{default:e(()=>[t(B,{class:"text-center pa-4 cursor-pointer",variant:"outlined",color:P.value.customRole?.id===p._id?p.color||"purple":"",onClick:ie=>ge(P.value,"custom",p._id)},{default:e(()=>[t(w,{size:"40",color:p.color||"purple"},{default:e(()=>[l(i(p.icon||"mdi-star"),1)]),_:2},1032,["color"]),s("div",tn,i(p.name),1),s("div",ln,i(p.permissions.length)+" permissions",1)]),_:2},1032,["color","onClick"])]),_:2},1024))),128))]),_:1})])):D("",!0)]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:o[17]||(o[17]=p=>q.value=!1),variant:"outlined",disabled:g.value},{default:e(()=>[...o[94]||(o[94]=[l(" Cancel ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(Ve,{modelValue:Z.value,"onUpdate:modelValue":o[19]||(o[19]=p=>Z.value=p),"max-width":"600px",persistent:""},{default:e(()=>[W.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6 d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2",color:W.value.color||"purple"},{default:e(()=>[l(i(W.value.icon||"mdi-star"),1)]),_:1},8,["color"]),l(" "+i(W.value.name)+" Permissions ",1)]),_:1}),t(De,null,{default:e(()=>[...o[95]||(o[95]=[l(" View all permissions assigned to this custom role ",-1)])]),_:1}),t(X,null,{default:e(()=>[s("div",an,[s("strong",null,"Total Permissions: "+i(W.value.permissions.length),1)]),t(pt,{variant:"accordion",multiple:""},{default:e(()=>[t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[96]||(o[96]=[l("mdi-eye",-1)])]),_:1}),l(" View Permissions ("+i($e("view").length)+") ",1)]),_:1}),t(Ne,null,{default:e(()=>[t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re($e("view"),p=>(n(),m(te,{key:p,size:"small",color:"green",variant:"outlined",class:"ma-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...o[97]||(o[97]=[l("mdi-check",-1)])]),_:1}),l(" "+i(ke(C).find(ie=>ie.key===p)?.label||p),1)]),_:2},1024))),128))]),_:1}),$e("view").length===0?(n(),T("div",sn," No view permissions assigned ")):D("",!0)]),_:1})]),_:1}),t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[98]||(o[98]=[l("mdi-play",-1)])]),_:1}),l(" Action Permissions ("+i($e("action").length)+") ",1)]),_:1}),t(Ne,null,{default:e(()=>[t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re($e("action"),p=>(n(),m(te,{key:p,size:"small",color:"blue",variant:"outlined",class:"ma-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...o[99]||(o[99]=[l("mdi-check",-1)])]),_:1}),l(" "+i(ke(C).find(ie=>ie.key===p)?.label||p),1)]),_:2},1024))),128))]),_:1}),$e("action").length===0?(n(),T("div",nn," No action permissions assigned ")):D("",!0)]),_:1})]),_:1}),t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[100]||(o[100]=[l("mdi-shield-crown",-1)])]),_:1}),l(" Management Permissions ("+i($e("management").length)+") ",1)]),_:1}),t(Ne,null,{default:e(()=>[t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re($e("management"),p=>(n(),m(te,{key:p,size:"small",color:"orange",variant:"outlined",class:"ma-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...o[101]||(o[101]=[l("mdi-check",-1)])]),_:1}),l(" "+i(ke(C).find(ie=>ie.key===p)?.label||p),1)]),_:2},1024))),128))]),_:1}),$e("management").length===0?(n(),T("div",on," No management permissions assigned ")):D("",!0)]),_:1})]),_:1}),t(Le,null,{default:e(()=>[t(Ee,null,{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...o[102]||(o[102]=[l("mdi-format-list-bulleted",-1)])]),_:1}),l(" All Permissions ("+i(W.value.permissions.length)+") ",1)]),_:1}),t(Ne,null,{default:e(()=>[t(nt,{density:"compact"},{default:e(()=>[(n(!0),T(oe,null,re(W.value.permissions,p=>(n(),m(We,{key:p,class:"px-0"},{prepend:e(()=>[t(w,{color:"success",size:"small"},{default:e(()=>[...o[103]||(o[103]=[l("mdi-check-circle",-1)])]),_:1})]),default:e(()=>[t(Qe,{class:"text-body-2"},{default:e(()=>[l(i(ke(C).find(ie=>ie.key===p)?.label||p),1)]),_:2},1024),t(Pt,{class:"text-caption"},{default:e(()=>[l(i(ke(C).find(ie=>ie.key===p)?.description||"Custom permission"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:Te,color:"primary",variant:"outlined"},{default:e(()=>[...o[104]||(o[104]=[l(" Close ",-1)])]),_:1})]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(Ve,{modelValue:z.value,"onUpdate:modelValue":o[20]||(o[20]=p=>z.value=p),"max-width":"500px",persistent:""},{default:e(()=>[M.value?(n(),m(B,{key:0},{default:e(()=>[t(ne,{class:"font-weight-bold text-h6"},{default:e(()=>[t(w,{class:"mr-2",color:"warning"},{default:e(()=>[...o[105]||(o[105]=[l("mdi-alert",-1)])]),_:1}),o[106]||(o[106]=l(" Confirm Role Change ",-1))]),_:1}),t(X,null,{default:e(()=>[s("p",un,[o[107]||(o[107]=l(" Are you sure you want to change ",-1)),s("strong",null,i(M.value.member.username),1),o[108]||(o[108]=l("'s role to ",-1)),s("strong",null,i(M.value.roleName),1),o[109]||(o[109]=l("? ",-1))]),t(pe,{type:"info",variant:"tonal",class:"mb-3"},{default:e(()=>[s("div",rn,[s("div",null,[o[110]||(o[110]=s("div",{class:"font-weight-medium"},"Current Role:",-1)),M.value.member.customRole?(n(),m(te,{key:0,color:M.value.member.customRole.color||"purple",size:"small",variant:"tonal",class:"mt-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(M.value.member.customRole.icon||"mdi-star"),1)]),_:1}),l(" "+i(M.value.member.customRole.name),1)]),_:1},8,["color"])):(n(),m(te,{key:1,color:ke(me).getRoleColor(M.value.member.baseRole),size:"small",variant:"tonal",class:"mt-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(ke(me).getRoleIcon(M.value.member.baseRole)),1)]),_:1}),l(" "+i(M.value.member.roleLabel||M.value.member.baseRole),1)]),_:1},8,["color"]))]),t(w,{class:"mx-4",color:"grey"},{default:e(()=>[...o[111]||(o[111]=[l("mdi-arrow-right",-1)])]),_:1}),s("div",null,[o[112]||(o[112]=s("div",{class:"font-weight-medium"},"New Role:",-1)),t(te,{color:M.value.roleId?h.value.find(p=>p._id===M.value.roleId)?.color||"purple":ke(me).getRoleColor(M.value.roleType),size:"small",variant:"tonal",class:"mt-1"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(M.value.roleId?h.value.find(p=>p._id===M.value.roleId)?.icon||"mdi-star":ke(me).getRoleIcon(M.value.roleType)),1)]),_:1}),l(" "+i(M.value.roleName),1)]),_:1},8,["color"])])])]),_:1}),o[113]||(o[113]=s("p",{class:"text-caption text-warning"}," This action will immediately update the user's permissions and access level. ",-1))]),_:1}),t(he,null,{default:e(()=>[t(ve),t(F,{onClick:fe,variant:"outlined",disabled:g.value},{default:e(()=>[...o[114]||(o[114]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{onClick:Ce,color:"primary",variant:"elevated",loading:g.value},{default:e(()=>[...o[115]||(o[115]=[l(" Confirm Change ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue"])]),_:1}))}},mn=Object.assign(qe(dn,[["__scopeId","data-v-08e94ec9"]]),{__name:"RoleManagementTabs"}),cn={class:"mb-6"},fn={class:"text-h6 mb-3 d-flex align-center"},vn={key:0,class:"mb-6"},pn={class:"text-h6 mb-3 d-flex align-center"},gn={class:"mb-4"},yn={class:"text-h6 mb-3 d-flex align-center"},bn={class:"text-body-1 mt-2"},kn={key:0},wn={__name:"NewMembers",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamId:{type:String,required:!0},teamMembers:{type:Array,default:()=>[]},roleUpdateTrigger:{type:Number,default:0}},emits:["update:dialog","members-added"],setup(_,{emit:c}){const f=k({userId:"",username:"",email:""}),V={ADMIN:"admin",MEMBER:"member",CUSTOM:"custom"},b=k({role:V.MEMBER}),g=k(!1),r=k(!1),I=k(""),S=k(!1),h=k(""),R=k([]),Q=k([]),G=k([]),E=we(()=>{const C=q.teamMembers.map(ce=>ce.userId||ce._id||ce.id),O=G.value.map(ce=>ce.userId),Y=R.value.filter(ce=>{const Re=ce.userId===f.value.userId,be=C.includes(ce.userId),ge=O.includes(ce.userId);return!Re&&!be&&!ge});if(!h.value)return Y;const ae=h.value;return Y.filter(ce=>ce.username.includes(ae)).slice(0,5)}),$=()=>{h.value="",G.value=[],b.value.role=V.MEMBER},q=_,P=c,H=async()=>{try{const O=await fetch("undefined/api/users/all",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!O.ok)throw new Error("Network response was not ok");const Y=await O.json();R.value=Y.map(ae=>({userId:ae._id,username:ae.username}))}catch{}},M=async()=>{if(q.teamId)try{const O=await fetch(`undefined/api/teams/${q.teamId}/roles`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!O.ok)throw new Error("Network response was not ok");const Y=await O.json(),ae=[{title:"Admin",value:V.ADMIN,roleType:V.ADMIN,icon:"mdi-crown",color:"red"},{title:"Member",value:V.MEMBER,roleType:V.MEMBER,icon:"mdi-account",color:"blue"}],_e=Y.roles.map(ce=>({title:ce.name,value:`custom:${ce._id}`,roleType:V.CUSTOM,roleId:ce._id,icon:ce.icon||"mdi-star",color:ce.color||"purple"}));Q.value=[...ae,..._e]}catch{}},z=async()=>{try{const O=await fetch(`undefined/api/teams/${q.teamId}/users`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({users:G.value,addedByUserId:q.userProps.userId})}),Y=await O.json();if(!O.ok)throw r.value=!0,g.value=!1,I.value=Y.message||"Failed to add users to team",S.value=!1,new Error("Network response was not ok");g.value=!0,r.value=!1,I.value="Members added successfully!",P("members-added")}catch{S.value=!1}},le=C=>{f.value.userId=C.userId,f.value.username=C.username,f.value.email=C.email};je(async()=>{le(q.userProps),await H()}),Se(()=>q.dialog,async C=>{C&&q.teamId&&await M()}),Se(()=>q.teamId,async(C,O)=>{C&&C!==O&&q.dialog&&await M()}),Se(()=>q.roleUpdateTrigger,async(C,O)=>{C!==O&&q.dialog&&q.teamId&&await M()}),Se(()=>q.teamMembers,()=>{},{deep:!0});const Z=()=>{setTimeout(()=>{$(),g.value=!1,r.value=!1,I.value="",S.value=!1,P("update:dialog",!1)},1500)},W=C=>{const O={userId:C.userId,username:C.username,teamId:q.teamId};G.value.some(ae=>ae.userId===C.userId)||(G.value.push(O),h.value="")},U=C=>{G.value=G.value.filter(O=>O.userId!==C)},L=async()=>{if(G.value.length===0){r.value=!0,I.value="Please select at least one user to add.";return}const C=Q.value.find(ce=>ce.value===b.value.role),O=C?.roleType||V.MEMBER,Y=O===V.CUSTOM?C?.roleId??null:null,ae=G.value.map(ce=>({...ce,roleType:O,roleId:Y})),_e=[...G.value];G.value=ae,S.value=!0;try{await z(),g.value&&Z()}catch{S.value=!1,G.value=_e}};return(C,O)=>(n(),m(Ve,{modelValue:q.dialog,"onUpdate:modelValue":O[3]||(O[3]=Y=>q.dialog=Y),"max-width":"700px",persistent:""},{default:e(()=>[t(B,{class:"elevation-8"},{default:e(()=>[t(ne,{class:"text-h5 font-weight-bold text-center py-6 bg-primary text-white"},{default:e(()=>[t(w,{start:"",size:"large"},{default:e(()=>[...O[4]||(O[4]=[l("mdi-account-plus",-1)])]),_:1}),O[5]||(O[5]=l(" Add Team Members ",-1))]),_:1}),t(X,{class:"pa-6"},{default:e(()=>[s("div",cn,[s("h3",fn,[t(w,{start:"",color:"primary"},{default:e(()=>[...O[6]||(O[6]=[l("mdi-account-cog",-1)])]),_:1}),O[7]||(O[7]=l(" Select Role for New Members ",-1))]),t(Me,{modelValue:b.value.role,"onUpdate:modelValue":O[0]||(O[0]=Y=>b.value.role=Y),items:Q.value,"item-title":"title","item-value":"value",label:"Assign Role",variant:"outlined",density:"comfortable",required:"","prepend-inner-icon":"mdi-shield-account"},{selection:e(({item:Y})=>[t(te,{color:Y.raw.color||"blue",variant:"tonal"},{default:e(()=>[t(w,{start:""},{default:e(()=>[l(i(Y.raw.icon||"mdi-account"),1)]),_:2},1024),l(" "+i(Y.raw.title),1)]),_:2},1032,["color"])]),item:e(({props:Y,item:ae})=>[t(We,Rt($t(Y)),{prepend:e(()=>[t(w,{color:ae.raw.color||"blue"},{default:e(()=>[l(i(ae.raw.icon||"mdi-account"),1)]),_:2},1032,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),G.value.length>0?(n(),T("div",vn,[s("h3",pn,[t(w,{start:"",color:"success"},{default:e(()=>[...O[8]||(O[8]=[l("mdi-account-check",-1)])]),_:1}),l(" Selected Members ("+i(G.value.length)+") ",1)]),t(B,{variant:"outlined",class:"pa-3"},{default:e(()=>[t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re(G.value,(Y,ae)=>(n(),m(te,{key:Y.userId,class:"ma-1",closable:"","onClick:close":_e=>U(Y.userId),color:"success",variant:"tonal",size:"large"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...O[9]||(O[9]=[l("mdi-account",-1)])]),_:1}),l(" "+i(Y.username),1)]),_:2},1032,["onClick:close"]))),128))]),_:1})]),_:1})])):D("",!0),s("div",gn,[s("h3",yn,[t(w,{start:"",color:"primary"},{default:e(()=>[...O[10]||(O[10]=[l("mdi-account-search",-1)])]),_:1}),O[11]||(O[11]=l(" Search Users ",-1))]),t(xe,{modelValue:h.value,"onUpdate:modelValue":O[1]||(O[1]=Y=>h.value=Y),label:"Search for users to add...",placeholder:"Type username to search",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-magnify",clearable:"",class:"mb-2"},null,8,["modelValue"]),E.value.length>0?(n(),m(B,{key:0,variant:"outlined",class:"search-results"},{default:e(()=>[t(De,{class:"py-2 bg-grey-lighten-4"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...O[12]||(O[12]=[l("mdi-account-multiple",-1)])]),_:1}),l(" Available Users ("+i(E.value.length)+") ",1)]),_:1}),t(nt,{density:"compact","max-height":"250",class:"overflow-y-auto"},{default:e(()=>[(n(!0),T(oe,null,re(E.value,Y=>(n(),m(We,{key:Y.userId,onClick:ae=>W(Y),class:"cursor-pointer","prepend-icon":"mdi-account-plus-outline"},{append:e(()=>[t(F,{icon:"",size:"small",variant:"text",color:"primary"},{default:e(()=>[t(w,null,{default:e(()=>[...O[13]||(O[13]=[l("mdi-plus",-1)])]),_:1})]),_:1})]),default:e(()=>[t(Qe,{class:"font-weight-medium"},{default:e(()=>[l(i(Y.username),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):h.value?(n(),m(B,{key:1,variant:"outlined",class:"text-center pa-4"},{default:e(()=>[t(w,{size:"48",color:"grey"},{default:e(()=>[...O[14]||(O[14]=[l("mdi-account-search-outline",-1)])]),_:1}),s("div",bn,'No users found matching "'+i(h.value)+'"',1),O[15]||(O[15]=s("div",{class:"text-caption text-grey"},"Try a different search term",-1))]),_:1})):(n(),m(B,{key:2,variant:"outlined",class:"text-center pa-4"},{default:e(()=>[t(w,{size:"48",color:"primary"},{default:e(()=>[...O[16]||(O[16]=[l("mdi-account-search",-1)])]),_:1}),O[17]||(O[17]=s("div",{class:"text-body-1 mt-2"},"Search for users to add to your team",-1)),O[18]||(O[18]=s("div",{class:"text-caption text-grey"},"Start typing a username to see available users",-1))]),_:1}))]),t(bl,null,{default:e(()=>[g.value||r.value?(n(),T("div",kn,[t(pe,{type:g.value?"success":"error",text:I.value,variant:"tonal",class:"mb-4"},{prepend:e(()=>[t(w,null,{default:e(()=>[l(i(g.value?"mdi-check-circle":"mdi-alert-circle"),1)]),_:1})]),_:1},8,["type","text"])])):D("",!0)]),_:1})]),_:1}),t(he,{class:"pa-6 bg-grey-lighten-5"},{default:e(()=>[t(ve),t(F,{onClick:O[2]||(O[2]=Y=>P("update:dialog",!1)),variant:"outlined",disabled:S.value},{default:e(()=>[...O[19]||(O[19]=[l(" Cancel ",-1)])]),_:1},8,["disabled"]),t(F,{color:"primary",onClick:L,variant:"elevated",disabled:S.value||G.value.length===0,loading:S.value},{default:e(()=>[l(" Add "+i(G.value.length)+" Member"+i(G.value.length!==1?"s":""),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},xn=Object.assign(qe(wn,[["__scopeId","data-v-a4df7a50"]]),{__name:"NewMembers"}),hn={name:"WorkflowView",props:{taskGroups:{type:Array,default:()=>[]}},data(){return{currentView:"week",tasks:[],dates:[],dayWidth:60,rowHeight:61,highlightedTaskId:null,showTimelineOnly:!1,scrollSyncFrame:null,resizeRaf:null,scrollLinking:null,renderBuffer:8,visibleRange:{start:0,end:0},tooltip:{show:!1,title:"",assigned:"",completion:"",style:{}},modal:{show:!1,task:null},timelineStart:null}},watch:{taskGroups:{handler(){this.tasks=this.transformTaskGroups(),this.$nextTick(()=>{this.updateLayout()})},immediate:!0,deep:!0},tasks(){this.$nextTick(()=>{this.updateVisibleRange()})},currentView:{handler(_){this.updateLayout()}}},computed:{visibleTasks(){if(!Array.isArray(this.tasks))return[];const{start:_,end:c}=this.visibleRange;return this.tasks.slice(_,c)},topSpacerHeight(){return this.visibleRange.start*this.rowHeight},bottomSpacerHeight(){const _=Array.isArray(this.tasks)?this.tasks.length:0;return Math.max(0,(_-this.visibleRange.end)*this.rowHeight)},timelineGridStyle(){const _=this.dates.length*this.dayWidth,c="#f1f3f4",f=`${this.rowHeight}px`;return{minWidth:_+"px",backgroundImage:`linear-gradient(to bottom, transparent ${this.rowHeight-1}px, ${c} ${this.rowHeight-1}px)`,backgroundSize:`100% ${f}`,backgroundRepeat:"repeat-y"}}},mounted(){window.addEventListener("resize",this.onWindowResize),this.$nextTick(()=>{setTimeout(()=>{this.scrollToCurrentDate(),this.updateVisibleRange()},100)})},beforeUnmount(){window.removeEventListener("resize",this.onWindowResize),this.resizeRaf&&cancelAnimationFrame(this.resizeRaf),this.scrollSyncFrame&&cancelAnimationFrame(this.scrollSyncFrame)},methods:{onWindowResize(){this.resizeRaf&&cancelAnimationFrame(this.resizeRaf),this.resizeRaf=requestAnimationFrame(()=>{this.updateLayout()})},syncTimelineHeader(){this.scrollSyncFrame&&cancelAnimationFrame(this.scrollSyncFrame),this.scrollSyncFrame=requestAnimationFrame(()=>{const _=this.$refs.timelineHeaderContent,c=this.$refs.timelineContent;_&&c&&(_.style.transform=`translateX(-${c.scrollLeft}px)`)})},syncScrollPositions(_,c){if(!Array.isArray(this.tasks)||this.tasks.length===0){this.visibleRange={start:0,end:0};return}const f=_==="timeline"?"taskList":"timelineContent",V=this.$refs[f];V&&Math.abs(V.scrollTop-c)>1&&(this.scrollLinking=f,V.scrollTop=c),this.updateVisibleRangeFromScroll(c)},onTaskListScroll(_){if(this.scrollLinking==="taskList"){this.scrollLinking=null;return}this.syncScrollPositions("taskList",_.target.scrollTop)},switchView(_){this.currentView=_,this.updateLayout()},getPriorityColor(_){switch(_.toLowerCase()){case"high":return"error";case"medium":return"warning";case"low":return"info";default:return"grey"}},getStatusColor(_){switch(_.toLowerCase()){case"completed":return"success";case"pending":return"warning";case"overdue":return"error";case"not-started":return"grey";default:return"grey"}},getProgressColor(_){return _>=80?"success":_>=50?"warning":_>=20?"info":"error"},transformTaskGroups(){if(!this.taskGroups||this.taskGroups.length===0)return[];try{const _=this.taskGroups.map(c=>{if(!c.taskGroupId||!c.title)return null;let f="not-started";const V=new Date(Date.parse(c.dueDate)),b=new Date(Date.parse(c.startDate));if(isNaN(V.getTime())||isNaN(b.getTime()))return null;const g=parseFloat(c.completionRate||"0"),r=new Date;g===100?f="completed":b<r&&r<V?f="pending":f=r<b?"not-started":"overdue";const I=c.priority?c.priority.toLowerCase():"medium";return{id:c.taskGroupId,name:c.title,description:c.description||"",category:c.category||"",priority:I,status:f,startDate:b,dueDate:V,assignedMembers:c.assignedMember||[],weighted:c.totalWeight||0,completedTasks:c.completedTasks||0,completionRate:parseFloat(c.completionRate||"0.0").toFixed(1)}}).filter(c=>c!==null);return this.sortTasks(_)}catch{}},sortTasks(_){return _.sort((c,f)=>c.startDate-f.startDate)},updateLayout(){this.dayWidth=this.getDayWidth(),this.rowHeight=this.getRowHeight();const _=this.generateTimelineDates();this.dates=_.dates,this.timelineStart=_.startDate,this.$nextTick(()=>{this.scrollToCurrentDate(),this.updateVisibleRange(),this.syncTimelineHeader()})},updateVisibleRangeFromScroll(_){const c=Array.isArray(this.tasks)?this.tasks.length:0;if(c===0){this.visibleRange={start:0,end:0};return}const f=this.$refs.timelineContent,V=f?f.clientHeight:window.innerHeight,b=this.renderBuffer,g=Math.max(0,Math.floor(_/this.rowHeight)-b),r=Math.min(c,Math.ceil((_+V)/this.rowHeight)+b);(g!==this.visibleRange.start||r!==this.visibleRange.end)&&(this.visibleRange={start:g,end:r})},updateVisibleRange(){const _=this.$refs.timelineContent,c=_?_.scrollTop:0;this.updateVisibleRangeFromScroll(c)},generateTimelineDates(){if(!this.tasks.length)return{dates:[],startDate:new Date};if(this.currentView==="week"){const $=this.tasks.map(ae=>ae.startDate.getTime()).filter(ae=>!isNaN(ae)),q=this.tasks.map(ae=>ae.dueDate.getTime()).filter(ae=>!isNaN(ae)),P=new Date;P.setHours(0,0,0,0);let H,M;if($.length===0||q.length===0)H=new Date(P),M=new Date(P);else{const ae=new Date(Math.min(...$)),_e=new Date(Math.max(...q));H=new Date(Math.min(P.getTime(),ae.getTime())),M=new Date(Math.max(P.getTime(),_e.getTime()))}const z=14,le=14,Z=new Date(H);Z.setDate(Z.getDate()-z);const W=new Date(M);W.setDate(W.getDate()+le);const U=[],L=new Date(Z),C=Math.ceil((W-Z)/(1440*60*1e3)),O=Math.max(1200,C+100);let Y=0;for(;L<=W&&Y<O;){const ae=new Date(L),_e=ae.getFullYear()===P.getFullYear()&&ae.getMonth()===P.getMonth()&&ae.getDate()===P.getDate(),ce=`${ae.getFullYear()}-${String(ae.getMonth()+1).padStart(2,"0")}-${String(ae.getDate()).padStart(2,"0")}`;U.push({iso:ce,day:L.getDate(),dayName:L.toLocaleString(void 0,{weekday:"short"}).toUpperCase(),monthName:L.toLocaleString("en-US",{month:"short"}),monthStart:L.getDate()===1,year:L.getFullYear(),isToday:_e}),L.setDate(L.getDate()+1),Y++}return U.length>2e3,{dates:U,startDate:Z}}const _=this.tasks.map($=>$.startDate.getTime()).filter($=>!isNaN($)),c=this.tasks.map($=>$.dueDate.getTime()).filter($=>!isNaN($)),f=new Date;f.setHours(0,0,0,0);let V,b;if(_.length===0||c.length===0)V=new Date(f),b=new Date(f);else{const $=new Date(Math.min(..._)),q=new Date(Math.max(...c));V=new Date(Math.min(f.getTime(),$.getTime())),b=new Date(Math.max(f.getTime(),q.getTime()))}const g=1,r=1,I=new Date(V.getFullYear(),V.getMonth(),1);I.setMonth(I.getMonth()-g);const S=new Date(b.getFullYear(),b.getMonth(),1);S.setMonth(S.getMonth()+r);const h=[],R=new Date(I.getFullYear(),I.getMonth(),1),Q=(S.getFullYear()-I.getFullYear())*12+(S.getMonth()-I.getMonth())+1,G=Math.max(120,Q+12);let E=0;for(;R<=S&&E<G;){const $=R.getFullYear(),q=R.getMonth(),P=R.toLocaleString("en-US",{month:"short"}),H=new Date($,q+1,0).getDate(),M=$===f.getFullYear()&&q===f.getMonth();h.push({iso:`${$}-${String(q+1).padStart(2,"0")}`,monthIndex:q,monthName:P,monthStart:!0,year:$,daysInMonth:H,isToday:M}),R.setMonth(R.getMonth()+1),E++}return{dates:h,startDate:I}},toggleWorkflowDisplay(){this.showTimelineOnly=!this.showTimelineOnly},getDayWidth(){if(this.$vuetify?.display){const{xs:c,sm:f,md:V}=this.$vuetify.display;return this.currentView==="week"?c||f?45:55:c||f?80:120}const _=window.innerWidth;return this.currentView==="week"?_<600?40:_<960?50:60:_<600?100:_<960?120:160},getRowHeight(){if(this.$vuetify?.display){const{xs:_,sm:c}=this.$vuetify.display;if(_)return 52;if(c)return 58}return 61},dateDiffDays(_,c){return Math.round((c-_)/864e5)},getTaskBarStyle(_){if(!this.timelineStart||!this.dates.length)return{};if(this.currentView==="week"){const h=this.dateDiffDays(this.timelineStart,_.startDate),R=Math.max(1,this.dateDiffDays(_.startDate,_.dueDate)+1),Q=h*this.dayWidth,G=R*this.dayWidth-8;return{left:Q+"px",width:G+"px"}}const c=(h,R)=>(R.getFullYear()-h.getFullYear())*12+(R.getMonth()-h.getMonth()),f=new Date(this.timelineStart.getFullYear(),this.timelineStart.getMonth(),1),V=new Date(_.startDate.getFullYear(),_.startDate.getMonth(),1),b=new Date(_.dueDate.getFullYear(),_.dueDate.getMonth(),1),g=c(f,V),r=Math.max(1,c(V,b)+1),I=g*this.dayWidth,S=r*this.dayWidth-12;return{left:I+"px",width:S+"px"}},focusOnTask(_,c){this.$vuetify.display.xs&&(this.showTimelineOnly=!0),this.highlightedTaskId=_;const f=this.$refs.timelineContent;this.$nextTick(()=>{if(!f)return;const V=this.tasks[c];if(!V)return;const b=this.$el.querySelector(`.task-bar[data-task-id="${_}"]`),g=this.getTaskBarStyle(V),r=f.clientWidth,I=parseFloat(g.left)||(b?b.offsetLeft:0),S=parseFloat(g.width)||(b?b.offsetWidth:0);let h;S>r*.6?h=Math.max(0,I-100):h=I+S/2-r/2;const Q=c*this.rowHeight-f.clientHeight/2+this.rowHeight/2;f.scrollTo({left:Math.max(0,h),top:Math.max(0,Q),behavior:"smooth"});const G=E=>{E&&(E.classList.add("pulse"),setTimeout(()=>E.classList.remove("pulse"),2e3))};b?G(b):setTimeout(()=>{const E=this.$el.querySelector(`.task-bar[data-task-id="${_}"]`);G(E)},100)})},scrollToCurrentDate(){if(!this.dates.length||!this.timelineStart)return;const _=new Date;_.setHours(0,0,0,0);const c=this.$refs.timelineContent;if(c)if(this.currentView==="week"){const f=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}-${String(_.getDate()).padStart(2,"0")}`,V=this.dates.findIndex(b=>b.iso===f);if(V!==-1){const b=c.clientWidth,g=V*this.dayWidth-b/2+this.dayWidth/2;c.scrollTo({left:Math.max(0,g),top:0,behavior:"smooth"})}}else{const f=_.getFullYear(),V=_.getMonth(),b=this.dates.findIndex(g=>g.year===f&&g.monthIndex===V);if(b!==-1){const g=c.clientWidth,r=b*this.dayWidth-g/2+this.dayWidth/2;c.scrollTo({left:Math.max(0,r),top:0,behavior:"smooth"})}}},onTimelineScroll(_){if(this.syncTimelineHeader(),this.scrollLinking==="timelineContent"){this.scrollLinking=null;return}this.syncScrollPositions("timeline",_.target.scrollTop)},showTaskModal(_){const c=this.tasks.find(f=>f.id===_);c&&(this.modal.task=c,this.modal.show=!0)},closeModal(){this.modal.show=!1,this.modal.task=null},showTooltip(_,c){const f=c.assignedMembers&&c.assignedMembers.length>0?c.assignedMembers.join(", "):"No members assigned";this.tooltip={show:!0,title:c.name,assigned:f,completion:`${c.completionRate}%`,style:{left:_.clientX+15+"px",top:_.clientY-10+"px",transform:"translateY(-100%)"}}},hideTooltip(){this.tooltip.show=!1},updateTooltipPosition(_){this.tooltip.show&&(this.tooltip.style={left:_.clientX+15+"px",top:_.clientY-10+"px",transform:"translateY(-100%)"})},formatDate(_){if(!_)return"Not set";const c=new Date(_);return isNaN(c.getTime())?"Invalid date":c.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},parseDate(_){if(!_)return new Date;let c=new Date(_);if(c.getFullYear()<1950){const f=String(_),V=f.match(/(\w+\s+\d{1,2},?\s+)(\d{2})$/);if(V){const g=parseInt(V[2]),r=g<=30?2e3+g:1900+g,I=V[1]+r;c=new Date(I)}const b=f.match(/^(\d{2})[-\/](\d{1,2})[-\/](\d{1,2})$/);if(b){const g=parseInt(b[1]),r=parseInt(b[2])-1,I=parseInt(b[3]),S=g<=30?2e3+g:1900+g;c=new Date(S,r,I)}}return c}}},Tn={class:"d-flex align-center justify-space-between"},_n={class:"timeline-header-content",ref:"timelineHeaderContent"},Cn={key:0,class:"month-name"},Dn={key:0,class:"month-label"},Vn={class:"day-number"},Rn={class:"grid-overlay"},$n={class:"task-bar-container"},Mn=["data-task-id","onClick","onMouseenter"],In={class:"d-none d-sm-inline"},Sn={class:"d-sm-none"},An={class:"tooltip-content"},Un={class:"tooltip-title"},Pn={class:"tooltip-detail"},On={key:0,class:"tooltip-detail"},Fn={class:"text-h6 text-truncate"},zn={class:"text-body-2 text-grey-darken-1"},Ln={class:"text-body-2"},En={class:"text-body-2"},Nn={class:"text-body-2"},jn={class:"text-body-2"},qn={class:"d-flex align-center w-100"},Gn={class:"text-body-2 ml-2"},Bn={class:"d-flex flex-wrap ga-2"};function Wn(_,c,f,V,b,g){return n(),m(bt,{fluid:"",class:"roadmap-container pa-0"},{default:e(()=>[t(j,{"no-gutters":"",class:"roadmap-header"},{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[_.$vuetify.display.xs&&!b.showTimelineOnly?D("",!0):(n(),m(kl,{key:0,modelValue:b.currentView,"onUpdate:modelValue":c[0]||(c[0]=r=>b.currentView=r),mandatory:"",variant:"outlined",size:"small"},{default:e(()=>[t(F,{value:"week",size:"small"},{default:e(()=>[...c[5]||(c[5]=[s("span",{class:"d-md-inline"},"Week",-1)])]),_:1}),t(F,{value:"month",size:"small"},{default:e(()=>[...c[6]||(c[6]=[s("span",{class:"d-md-inline"},"Month",-1)])]),_:1})]),_:1},8,["modelValue"])),_.$vuetify.display.xs&&b.showTimelineOnly?(n(),m(F,{key:1,icon:"",size:"small",class:"float-workflow-2",onClick:g.toggleWorkflowDisplay,color:"white"},{default:e(()=>[t(w,null,{default:e(()=>[...c[7]||(c[7]=[l("mdi-chart-gantt",-1)])]),_:1})]),_:1},8,["onClick"])):D("",!0)]),_:1})]),_:1}),t(j,{"no-gutters":"",class:"roadmap-content flex-nowrap"},{default:e(()=>[_.$vuetify.display.xs&&b.showTimelineOnly?D("",!0):(n(),m(x,{key:0,cols:"12",sm:"4",md:"4",lg:"3",class:"task-list-container d-flex flex-column"},{default:e(()=>[t(Kt,{class:"task-list-header pa-4",color:"grey-lighten-5",height:"60px"},{default:e(()=>[s("div",Tn,[c[9]||(c[9]=s("h3",{class:"text-subtitle1 font-weight-bold text-grey-darken-2"},"TASKS",-1)),_.$vuetify.display.xs?(n(),m(F,{key:0,icon:"",size:"small",class:"float-workflow",onClick:g.toggleWorkflowDisplay,color:"white"},{default:e(()=>[t(w,null,{default:e(()=>[...c[8]||(c[8]=[l("mdi-chart-gantt",-1)])]),_:1})]),_:1},8,["onClick"])):D("",!0)])]),_:1}),t(nt,{class:"task-list",ref:"taskList",onScroll:g.onTaskListScroll},{default:e(()=>[b.tasks&&b.tasks.length>0?(n(),T(oe,{key:0},[s("div",{class:"task-spacer",style:Pe({height:g.topSpacerHeight+"px"})},null,4),(n(!0),T(oe,null,re(g.visibleTasks,(r,I)=>(n(),m(We,{key:r.id,class:Be(["task-item",[{highlighted:b.highlightedTaskId===r.id},`status-${r.status}`]]),style:Pe({height:b.rowHeight+"px"}),onClick:S=>g.focusOnTask(r.id,b.visibleRange.start+I)},{prepend:e(()=>[t(et,{size:"8",color:g.getStatusColor(r.status)},null,8,["color"])]),default:e(()=>[t(Qe,{class:"task-name text-body-1"},{default:e(()=>[l(i(r.name),1)]),_:2},1024),t(Pt,{class:"task-priority-label text-body-2"},{default:e(()=>[l(i(r.priority.toUpperCase())+"  "+i(r.status),1)]),_:2},1024)]),_:2},1032,["class","style","onClick"]))),128)),s("div",{class:"task-spacer",style:Pe({height:g.bottomSpacerHeight+"px"})},null,4)],64)):(n(),m(We,{key:1,class:"task-item"},{default:e(()=>[t(Qe,{class:"task-name text-body-1"},{default:e(()=>[...c[10]||(c[10]=[l(" No tasks available. ",-1)])]),_:1})]),_:1}))]),_:1},8,["onScroll"])]),_:1})),t(x,{cols:"12",sm:"8",md:"8",lg:"9",class:Be(["timeline-container d-flex flex-column",{"pa-0":_.$vuetify.display.xs}])},{default:e(()=>[b.showTimelineOnly&&_.$vuetify.display.xs||!_.$vuetify.display.xs?(n(),m(Kt,{key:0,class:"timeline-header",color:"grey-lighten-5",height:"60px"},{default:e(()=>[s("div",_n,[(n(!0),T(oe,null,re(b.dates,r=>(n(),T("div",{key:r.iso,class:Be(["timeline-day",{"month-start":r.monthStart,today:r.isToday}]),style:Pe({minWidth:b.dayWidth+"px",width:b.dayWidth+"px"})},[b.currentView==="month"?(n(),T("div",Cn,i(r.monthName)+" "+i(r.year),1)):(n(),T(oe,{key:1},[r.monthStart?(n(),T("div",Dn,i(r.monthName)+" "+i(r.year),1)):D("",!0),s("div",Vn,i(r.day),1)],64))],6))),128))],512)]),_:1})):D("",!0),s("div",{class:"timeline-content flex-grow-1",ref:"timelineContent",onScroll:c[3]||(c[3]=(...r)=>g.onTimelineScroll&&g.onTimelineScroll(...r))},[s("div",{class:"timeline-grid",style:Pe(g.timelineGridStyle)},[s("div",Rn,[(n(!0),T(oe,null,re(b.dates,(r,I)=>(n(),T("div",{key:"grid-"+I,class:Be(["grid-line-vertical",{"month-start":r.monthStart}]),style:Pe({left:I*b.dayWidth+"px"})},null,6))),128))]),s("div",{class:"timeline-spacer",style:Pe({height:g.topSpacerHeight+"px"})},null,4),(n(!0),T(oe,null,re(g.visibleTasks,(r,I)=>(n(),T("div",{key:r.id,class:Be(["timeline-row",{highlighted:b.highlightedTaskId===r.id}]),style:Pe({height:b.rowHeight+"px"})},[s("div",$n,[s("div",{class:Be(["task-bar",r.status]),"data-task-id":r.id,style:Pe(g.getTaskBarStyle(r)),onClick:It(S=>g.showTaskModal(r.id),["stop"]),onMouseenter:S=>g.showTooltip(S,r),onMouseleave:c[1]||(c[1]=(...S)=>g.hideTooltip&&g.hideTooltip(...S)),onMousemove:c[2]||(c[2]=S=>g.updateTooltipPosition(S))},[s("span",In,i(r.name),1),s("span",Sn,i(r.name.substring(0,100)),1)],46,Mn)])],6))),128)),s("div",{class:"timeline-spacer",style:Pe({height:g.bottomSpacerHeight+"px"})},null,4)],4)],544)]),_:1},8,["class"])]),_:1}),b.tooltip.show?(n(),T("div",{key:0,class:"custom-tooltip show",style:Pe(b.tooltip.style)},[s("div",An,[s("div",Un,i(b.tooltip.title),1),s("div",Pn,"Assigned: "+i(b.tooltip.assigned),1),b.tooltip.completion?(n(),T("div",On," Progress: "+i(b.tooltip.completion),1)):D("",!0)])],4)):D("",!0),t(Ve,{modelValue:b.modal.show,"onUpdate:modelValue":c[4]||(c[4]=r=>b.modal.show=r),"max-width":_.$vuetify.display.xs?"95%":"800",fullscreen:_.$vuetify.display.xs},{default:e(()=>[t(B,null,{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[_.$vuetify.display.xs?(n(),m(w,{key:0,class:"mr-3",onClick:g.closeModal},{default:e(()=>[...c[11]||(c[11]=[l(" mdi-arrow-left ",-1)])]),_:1},8,["onClick"])):D("",!0),s("div",Fn,i(b.modal.task?.name),1),t(ve),_.$vuetify.display.xs?D("",!0):(n(),m(F,{key:1,icon:"",onClick:g.closeModal},{default:e(()=>[t(w,null,{default:e(()=>[...c[12]||(c[12]=[l("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"]))]),_:1}),t(st),t(X,{class:"pa-4"},{default:e(()=>[t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[c[13]||(c[13]=s("div",{class:"text-subtitle2 font-weight-bold mb-2"},"Description",-1)),s("div",zn,i(b.modal.task?.description||"No description provided"),1)]),_:1})]),_:1}),t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"6",sm:"3"},{default:e(()=>[c[14]||(c[14]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Priority",-1)),t(te,{color:g.getPriorityColor(b.modal.task?.priority||"medium"),size:"small",variant:"flat"},{default:e(()=>[l(i(b.modal.task?.priority?.toUpperCase()),1)]),_:1},8,["color"])]),_:1}),t(x,{cols:"6",sm:"3"},{default:e(()=>[c[15]||(c[15]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Status",-1)),t(te,{color:g.getStatusColor(b.modal.task?.status||"not-started"),size:"small",variant:"flat"},{default:e(()=>[l(i(b.modal.task?.status?.replace("-"," ").toUpperCase()),1)]),_:1},8,["color"])]),_:1}),t(x,{cols:"6",sm:"3"},{default:e(()=>[c[16]||(c[16]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Category",-1)),s("div",Ln,i(b.modal.task?.category||"N/A"),1)]),_:1}),t(x,{cols:"6",sm:"3"},{default:e(()=>[c[17]||(c[17]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Total Weight",-1)),s("div",En,i(b.modal.task?.weighted||0),1)]),_:1})]),_:1}),t(j,{class:"mb-4"},{default:e(()=>[t(x,{cols:"6",sm:"3"},{default:e(()=>[c[18]||(c[18]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Start Date",-1)),s("div",Nn,i(g.formatDate(b.modal.task?.startDate)),1)]),_:1}),t(x,{cols:"6",sm:"3"},{default:e(()=>[c[19]||(c[19]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Due Date",-1)),s("div",jn,i(g.formatDate(b.modal.task?.dueDate)),1)]),_:1}),t(x,{cols:"12",sm:"6",class:"d-flex-column align-center"},{default:e(()=>[c[20]||(c[20]=s("div",{class:"text-subtitle2 font-weight-bold mb-1"},"Completion Rate",-1)),s("div",qn,[t(Zt,{"model-value":b.modal.task?.completionRate||0,height:"16px",rounded:"",color:g.getProgressColor(b.modal.task?.completionRate||0),class:"mr-2 flex-grow-1"},null,8,["model-value","color"]),s("span",Gn,i(b.modal.task?.completionRate||0)+"%",1)])]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[c[22]||(c[22]=s("div",{class:"text-subtitle2 font-weight-bold mb-2"},"Assigned Members",-1)),s("div",Bn,[(n(!0),T(oe,null,re(b.modal.task?.assignedMembers,r=>(n(),m(te,{key:r,size:"small",color:"primary",variant:"outlined"},{default:e(()=>[l(i(r),1)]),_:2},1024))),128)),!b.modal.task?.assignedMembers||b.modal.task.assignedMembers.length===0?(n(),m(te,{key:0,size:"small",color:"grey",variant:"outlined"},{default:e(()=>[...c[21]||(c[21]=[l(" No members assigned ",-1)])]),_:1})):D("",!0)])]),_:1})]),_:1})]),_:1}),_.$vuetify.display.xs?D("",!0):(n(),m(st,{key:0})),_.$vuetify.display.xs?D("",!0):(n(),m(he,{key:1,class:"pa-4"},{default:e(()=>[t(ve),t(F,{variant:"outlined",color:"primary",onClick:g.closeModal},{default:e(()=>[...c[23]||(c[23]=[l(" Close ",-1)])]),_:1},8,["onClick"])]),_:1}))]),_:1})]),_:1},8,["modelValue","max-width","fullscreen"])]),_:1})}const Hn=Object.assign(qe(hn,[["render",Wn],["__scopeId","data-v-3d581b53"]]),{__name:"WorkflowView"}),Yn={key:0},Jn={class:"d-flex justify-space-between"},Qn={key:1},Kn={key:2},Xn={key:0},Zn={key:1},eo={class:"d-flex align-center mb-2"},to={class:"text-h4 font-weight-bold"},lo={class:"text-grey"},ao={key:0},so={class:"d-flex gap-2 mt-2"},no={class:"d-flex justify-space-between"},oo={key:1},io={class:"d-flex align-center justify-space-between mb-4"},uo={class:"text-h5"},ro={class:"text-caption"},mo={class:"d-flex justify-space-between text-caption"},co={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-2 mb-3"},fo={key:0},vo={class:"d-flex align-center justify-space-between mb-3"},po={class:"mb-3"},go={class:"d-flex justify-space-between mb-1"},yo={key:1},bo={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-2 mb-3"},ko={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-2 mb-3"},wo={class:"mb-3"},xo={class:"d-flex justify-space-between mb-1"},ho={class:"text-caption"},To={class:"text-h6 font-weight-bold"},_o={class:"text-h6 font-weight-bold text-success"},Co={key:0},Do={key:1},Vo={class:"d-flex flex-wrap announcement-actions-wrapper w-100"},Ro={key:0},$o={key:1},Mo={class:"d-flex align-center justify-space-between mb-4"},Io={class:"text-h5"},So={class:"text-grey mb-2"},Ao={class:"delete-team-container"},Uo={class:"d-flex flex-column flex-md-row align-md-center justify-space-between gap-2 w-100"},Po={class:"d-flex align-center"},Oo={key:0,class:"py-4"},Fo={key:1},zo={class:"team-hierarchy-item root-team"},Lo={class:"d-flex align-center mb-2"},Eo={class:"flex-grow-1"},No={class:"text-h6 font-weight-bold"},jo={class:"text-body-2 text-grey"},qo={class:"text-caption text-grey"},Go={key:0,class:"mt-4"},Bo={class:"text-subtitle-1 font-weight-bold mb-3 d-flex align-center"},Wo={class:"d-flex align-center mb-2"},Ho={class:"hierarchy-lines"},Yo={key:0,class:"vertical-line"},Jo={class:"flex-grow-1"},Qo={class:"text-body-1 font-weight-bold"},Ko={class:"text-body-2 text-grey"},Xo={class:"text-caption text-grey"},Zo={key:1,class:"mt-4"},ei={class:"mb-4"},Dt=6,ti=Object.assign({name:"TeamDetails"},{__name:"[teamId]",setup(_){const c=wl(),{addTeamToCache:f,updateTeamAccess:V,removeTeamFromCache:b,isTeamCacheValid:g,onTeamTabChange:r}=xl(),I=hl(),S=kt(),h=k({}),R=k({userId:"",username:"",email:""}),Q=k({teamId:"",title:"",description:"",category:""}),G=k(!1),E=k(!0),$=k(!0),q=k(!0),P=k(!0),H=k(!1),M=k(0),z=k(!1),le=k(!1),Z=k(!1),W=k(!1),U=k(!1),L=k(!1),C=k(!1),O=k(!1),Y=k(!1),ae=k(null),_e=k(null),ce=k(null),Re=k(null),be=k(null),ge=k([]),Ce=k([]),fe=k([]),N=k([]),u=k([]),y=k(!1),J=k(!1),v=k(""),K=k(!1),Te=k(!1),$e=k(""),se=k(""),o=k("all"),p=k(1),ie=k(""),ye=k(I.query.tab||"tasks"),ue=k(I.params.teamId);k(null);const Ke=we(()=>h.value?.canViewTaskGroup===!0||me.isAdmin()),Ot=we(()=>h.value?.canViewAnnouncements===!0||me.isAdmin()),ot=we(()=>h.value?.canViewMembers===!0||me.isAdmin()),Ye=we(()=>me.isAdmin()),Fe=we(()=>h.value?.canManageTasks===!0||me.isAdmin()),xt=we(()=>h.value?.canManageAnnouncements===!0||me.isAdmin()),Ft=we(()=>h.value?.canAddMembers===!0||me.isAdmin()),zt=we(()=>h.value?.canRemoveMembers===!0||me.isAdmin()),it=k(!1),ut=k(new Map),rt=k(!1),Xe=A=>ut.value.get(A),el=(A,a)=>{ut.value.set(A,{...a,lastAccessed:Date.now()}),V(A)},ze=()=>{ue.value&&el(ue.value,{user:{...R.value},team:{...Q.value},tasks:[...ge.value],announcements:[...Ce.value],teamMembers:[...fe.value],subTeams:[...N.value],taskGroups:[...u.value],userPermissions:{...h.value},activeTab:ye.value})},ht=A=>{if(!g(A))return ut.value.delete(A),!1;const a=Xe(A);return a?(R.value=a.user||R.value,Q.value=a.team||Q.value,ge.value=a.tasks||[],Ce.value=a.announcements||[],fe.value=a.teamMembers||[],N.value=a.subTeams||[],u.value=a.taskGroups||[],h.value=a.userPermissions||{},ye.value=a.activeTab||I.query.tab||"tasks",I.query.tab!==ye.value&&S.replace({path:I.path,query:{...I.query,tab:ye.value}}),E.value=!1,$.value=!1,q.value=!1,P.value=!1,J.value=!1,y.value=!1,a.userPermissions&&me.setUserActions(a.userPermissions),V(A),!0):!1},Lt=()=>{if(!ue.value)return;f(ue.value),Xe(ue.value)?it.value=!0:it.value=!1},Je=async(A=!1)=>{E.value=!0,$.value=!0,q.value=!0,P.value=!0,rt.value=!1;const a=await c.getUserByAccessToken();if(a){if(tl(a),await _t(),await sl(),await Tt(),await lt(),await dt(),await mt(),await ll(),al(),!Q.value||!Q.value.teamId){G.value=!0;return}if(!(fe.value.some(d=>d.userId===R.value.userId)||R.value.username==="admin")){rt.value=!0,G.value=!0;return}ze(),it.value=!1,V(ue.value),G.value=!0}else rt.value=!0,G.value=!0};Se(()=>I.params.teamId,async(A,a)=>{if(A&&A!==a){ue.value=A,Lt(),G.value=!1;const d=Xe(A),de=g(A);d&&de?ht(A)?G.value=!0:(me.setUserActions({}),h.value={},await Je()):(me.setUserActions({}),h.value={},await Je())}},{immediate:!1}),Se(()=>ye.value,async A=>{A&&I.query.tab!==A&&S.push({path:I.path,query:{...I.query,tab:A}}),ue.value&&(r(ue.value),ze()),A==="delete-team"&&await Tt()}),Se(()=>I.query.tab,A=>{A&&A!==ye.value&&(ye.value=A)},{immediate:!0}),Se(()=>Q.value.title,A=>{A&&(document.title=`${A} | Team Details`)},{immediate:!0}),je(async()=>{Lt(),I.query.tab||S.replace({path:I.path,query:{...I.query,tab:"tasks"}});const A=Xe(ue.value),a=g(ue.value);A&&a?ht(ue.value)?G.value=!0:await Je():G.value||await Je()}),gl(async()=>{const A=g(ue.value),a=Xe(ue.value);!A&&a&&ut.value.delete(ue.value),Xe(ue.value)&&A&&!G.value?ht(ue.value)?G.value=!0:await Je():G.value||await Je(),ue.value&&A&&V(ue.value)}),yl(()=>{});const tl=A=>{R.value.userId=A.userId,R.value.username=A.username,R.value.email=A.email},ll=async()=>{try{await me.fetchUserActions(ue.value,R.value.userId),h.value=me.userActions,ze()}catch{h.value={}}},Tt=async()=>{try{J.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}/sub-teams`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a){N.value=[];return}Array.isArray(de)?N.value=de:de.subTeams&&Array.isArray(de.subTeams)?N.value=de.subTeams:N.value=[],ze()}catch{N.value=[]}finally{J.value=!1}},al=()=>{h.value.roleLabel||h.value.baseRole},_t=async()=>{try{E.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}/${R.value.userId}/tasks`,{method:"GET",headers:{"Content-Type":"application/json"}});a?(ge.value=de.tasks||[],ze()):ge.value=[]}catch{ge.value=[]}finally{E.value=!1}},sl=async()=>{try{P.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}`,{method:"GET",headers:{"Content-Type":"application/json"}});a?(Q.value=de.team||{},ze()):Q.value={}}catch{}finally{P.value=!1}},lt=async()=>{try{$.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}/announcements`,{method:"GET",headers:{"Content-Type":"application/json"}});a?(Ce.value=de.announcements||[],ze()):Ce.value=[]}catch{}finally{$.value=!1}},dt=async()=>{try{q.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}/users`,{method:"GET",headers:{"Content-Type":"application/json"}});a?(fe.value=de,ze()):fe.value=[]}catch{}finally{q.value=!1}},Et=async()=>{q.value=!0,await dt(),M.value+=1},nl=A=>{ce.value=Ce.value.find(a=>a._id===A),ce.value&&(Z.value=!0,ae.value=ce.value),Z.value=!0},ol=A=>{Ce.value.find(a=>a._id===A)&&(_e.value=A),le.value=!0},il=A=>{Re.value=Ce.value.find(a=>a._id===A),Re.value&&(z.value=!0)},ul=async A=>{const a=void 0;try{const{ok:d,status:de,data:Ze}=await Ge(`${a}/api/announcements/${A}/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:R.value.userId})});if(d){const He=Ce.value.find(at=>at._id===A);He.likeUsers.includes(R.value.userId)?He.likeUsers=He.likeUsers.filter(at=>at!==R.value.userId):He.likeUsers.push(R.value.userId),ze()}else throw new Error(Ze?.message||`Failed to like announcement (Status ${de})`)}catch{}},mt=async()=>{try{y.value=!0;const A=void 0,{ok:a,status:d,data:de}=await Ge(`${A}/api/teams/${ue.value}/task-groups`,{method:"GET",headers:{"Content-Type":"application/json"}});a?(u.value=de.taskGroups||[],ze()):u.value=[]}catch{}finally{y.value=!1}},Nt=()=>{S.push("/teams")},rl=A=>{const a=ge.value.find(d=>d._id===A);a&&(ae.value=a,U.value=!0)},jt=A=>({Urgent:"red-darken-2",High:"orange-darken-1",Medium:"green-darken-1",Low:"blue-darken-1",Optional:"grey-darken-3"})[A]||"grey-darken-3",dl=A=>A.likeUsers.includes(R.value.userId)?"primary":"",qt=A=>{be.value=A,O.value=!0},Gt=A=>new Date(A).toLocaleDateString(),ct=we(()=>{let A=ge.value;if($e.value){const d=$e.value.trim();A=A.filter(de=>de.title.includes(d))}if(se.value){const d=se.value.trim().split(/\s+/);A=A.filter(de=>{const Ze=de.tags?de.tags.map(He=>He.toLowerCase()):[];return d.every(He=>Ze.some(at=>at.includes(He)))})}const a=new Date;return o.value==="not-submitted"?A=A.filter(d=>!d.submitted):o.value==="pending"&&(A=A.filter(d=>{const de=new Date(d.startDate),Ze=new Date(d.dueDate);return a>=de&&a<=Ze})),A.sort((d,de)=>new Date(d.dueDate)-new Date(de.dueDate))}),Bt=we(()=>{const A=(p.value-1)*Dt,a=A+Dt;return ct.value.slice(A,a)}),Wt=we(()=>Math.ceil(ct.value.length/Dt)),Ct=we(()=>{if(!ie.value)return fe.value;const A=ie.value.trim();if(A.startsWith("#")){const a=A.slice(1);return a?fe.value.filter(d=>d.customRole?.name?d.customRole.name.toLowerCase().includes(a):(d.roleLabel||d.baseRole||"").toLowerCase().includes(a)):fe.value}return fe.value.filter(a=>a.username.includes(A))}),ml=[{title:"All Tasks",value:"all"},{title:"Pending Tasks",value:"pending"},{title:"Not Submitted",value:"not-submitted"}],Ht=we(()=>v.value===Q.value.title&&K.value),cl=async()=>{if(Ht.value)try{if(Te.value=!0,!(await fetch(`undefined/api/teams/${ue.value}`,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamId:ue.value})})).ok)throw new Error("Failed to delete team");b(ue.value),S.push({path:"/teams",query:{message:"Team deleted successfully",type:"success"}})}catch{alert("Failed to delete team. Please try again.")}finally{Te.value=!1}},fl=async()=>{await Je(!0)},Yt=we(()=>!1);return(A,a)=>(n(),m(bt,{fluid:""},{default:e(()=>[G.value?rt.value?(n(),T("div",Qn,[t(bt,null,{default:e(()=>[t(j,{justify:"center"},{default:e(()=>[t(x,{cols:"12",md:"6",class:"text-center"},{default:e(()=>[t(w,{size:"100",color:"grey"},{default:e(()=>[...a[47]||(a[47]=[l("mdi-alert-circle-outline",-1)])]),_:1}),a[49]||(a[49]=s("h1",{class:"text-h4 mt-4"},"Team Not Found",-1)),a[50]||(a[50]=s("p",{class:"text-body-1 mt-2"},"The team you're looking for doesn't exist or you don't have access to it.",-1)),t(F,{color:"primary",class:"mt-4",onClick:a[0]||(a[0]=d=>ke(S).push("/teams"))},{default:e(()=>[...a[48]||(a[48]=[l("Go to Teams",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):(n(),T("div",Kn,[t(j,{class:"align-center"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[t(F,{icon:"",onClick:Nt,variant:"text"},{default:e(()=>[t(w,null,{default:e(()=>[...a[51]||(a[51]=[l("mdi-arrow-left",-1)])]),_:1})]),_:1})]),_:1}),Yt.value?(n(),m(x,{key:0,cols:"auto"},{default:e(()=>[t(F,{icon:"",onClick:fl,variant:"text",loading:P.value,color:"primary"},{default:e(()=>[t(w,null,{default:e(()=>[...a[52]||(a[52]=[l("mdi-refresh",-1)])]),_:1})]),_:1},8,["loading"])]),_:1})):D("",!0),t(x,null,{default:e(()=>[P.value?(n(),T("div",Xn,[t(ee,{type:"heading",width:"300px",class:"mb-2"}),t(ee,{type:"text",width:"400px"})])):(n(),T("div",Zn,[s("div",eo,[s("h1",to,i(Q.value.title),1),it.value&&Yt.value?(n(),m(te,{key:0,color:"success",size:"x-small",class:"ml-2",variant:"outlined"},{default:e(()=>[t(w,{start:"",size:"x-small"},{default:e(()=>[...a[53]||(a[53]=[l("mdi-cached",-1)])]),_:1}),a[54]||(a[54]=l(" Cached ",-1))]),_:1})):D("",!0)]),s("p",lo,i(Q.value.description),1)]))]),_:1})]),_:1}),G.value?(n(),m(ta,{key:0,dialog:H.value,"onUpdate:dialog":a[1]||(a[1]=d=>H.value=d),userProps:R.value,teamId:ue.value,teamMembers:fe.value,onCreateTask:_t},null,8,["dialog","userProps","teamId","teamMembers"])):D("",!0),G.value?(n(),m(aa,{key:1,dialog:W.value,"onUpdate:dialog":a[2]||(a[2]=d=>W.value=d),userProps:R.value,"onUpdate:userProps":a[3]||(a[3]=d=>R.value=d),teamId:ue.value,"onUpdate:teamId":a[4]||(a[4]=d=>ue.value=d),announcements:Ce.value,"onUpdate:announcements":a[5]||(a[5]=d=>Ce.value=d),onAnnouncementCreated:lt},null,8,["dialog","userProps","teamId","announcements"])):D("",!0),G.value&&Z.value?(n(),m(Dl,{key:2,dialog:Z.value,"onUpdate:dialog":a[6]||(a[6]=d=>Z.value=d),userProps:R.value,"onUpdate:userProps":a[7]||(a[7]=d=>R.value=d),teamId:ue.value,"onUpdate:teamId":a[8]||(a[8]=d=>ue.value=d),onAnnouncementUpdated:lt,onCloseDialog:a[9]||(a[9]=d=>Z.value=!1),announcement:ce.value,"onUpdate:announcement":a[10]||(a[10]=d=>ce.value=d)},null,8,["dialog","userProps","teamId","announcement"])):D("",!0),G.value&&le.value?(n(),m(Ta,{key:3,dialog:le.value,"onUpdate:dialog":a[11]||(a[11]=d=>le.value=d),announcementId:_e.value,"onUpdate:announcementId":a[12]||(a[12]=d=>_e.value=d),teamId:ue.value,onAnnouncementDeleted:lt},null,8,["dialog","announcementId","teamId"])):D("",!0),G.value&&z.value?(n(),m(ts,{key:4,dialog:z.value,"onUpdate:dialog":a[13]||(a[13]=d=>z.value=d),announcement:Re.value,"onUpdate:announcement":a[14]||(a[14]=d=>Re.value=d),userProps:R.value,"onUpdate:userProps":a[15]||(a[15]=d=>R.value=d),teamId:ue.value,"onUpdate:teamId":a[16]||(a[16]=d=>ue.value=d),onCloseDialog:a[17]||(a[17]=d=>z.value=!1),onAnnouncementUpdated:lt},null,8,["dialog","announcement","userProps","teamId"])):D("",!0),G.value&&ae.value?(n(),m(ba,{key:5,dialog:U.value,"onUpdate:dialog":a[18]||(a[18]=d=>U.value=d),userProps:R.value,"onUpdate:userProps":a[19]||(a[19]=d=>R.value=d),teamId:ue.value,"onUpdate:teamId":a[20]||(a[20]=d=>ue.value=d),taskId:ae.value._id,"onUpdate:taskId":a[21]||(a[21]=d=>ae.value._id=d),task:ae.value,"onUpdate:task":a[22]||(a[22]=d=>ae.value=d),onSubmissionSuccess:_t},null,8,["dialog","userProps","teamId","taskId","task"])):D("",!0),G.value?(n(),m(xn,{key:6,dialog:C.value,"onUpdate:dialog":a[23]||(a[23]=d=>C.value=d),userProps:R.value,teamId:ue.value,teamMembers:fe.value,roleUpdateTrigger:M.value,allowCustomRoleSelection:ke(me).canManageCustomRoles(),onMembersAdded:dt},null,8,["dialog","userProps","teamId","teamMembers","roleUpdateTrigger","allowCustomRoleSelection"])):D("",!0),G.value?(n(),m(xa,{key:7,dialog:L.value,"onUpdate:dialog":a[24]||(a[24]=d=>L.value=d),userProps:R.value,members:fe.value,teamId:ue.value,onMembersRemoved:dt},null,8,["dialog","userProps","members","teamId"])):D("",!0),G.value&&O.value?(n(),m(Vs,{key:8,dialog:O.value,"onUpdate:dialog":a[25]||(a[25]=d=>O.value=d),taskGroupId:be.value,"onUpdate:taskGroupId":a[26]||(a[26]=d=>be.value=d),teamId:ue.value,"onUpdate:teamId":a[27]||(a[27]=d=>ue.value=d),userProps:R.value,"onUpdate:userProps":a[28]||(a[28]=d=>R.value=d),teamMembers:fe.value,"onUpdate:teamMembers":a[29]||(a[29]=d=>fe.value=d),onTaskGroupUpdated:mt},null,8,["dialog","taskGroupId","teamId","userProps","teamMembers"])):D("",!0),G.value&&Y.value?(n(),m(Gs,{key:9,dialog:Y.value,"onUpdate:dialog":a[30]||(a[30]=d=>Y.value=d),userProps:R.value,teamId:ue.value,teamMembers:fe.value,onRolesUpdated:Et},null,8,["dialog","userProps","teamId","teamMembers"])):D("",!0),t(j,{class:"align-center mb-6"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(At,{modelValue:ye.value,"onUpdate:modelValue":a[31]||(a[31]=d=>ye.value=d),"align-tabs":"start"},{default:e(()=>[t(Ae,{value:"tasks"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[55]||(a[55]=[l("mdi-clipboard-text",-1)])]),_:1}),a[56]||(a[56]=l(" Tasks ",-1))]),_:1}),t(Ae,{value:"workflow"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[57]||(a[57]=[l("mdi-timeline-clock",-1)])]),_:1}),a[58]||(a[58]=l(" Workflow ",-1))]),_:1}),Ke.value?(n(),m(Ae,{key:0,value:"task-groups"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[59]||(a[59]=[l("mdi-folder-multiple",-1)])]),_:1}),a[60]||(a[60]=l(" Task Groups ",-1))]),_:1})):D("",!0),Ot.value?(n(),m(Ae,{key:1,value:"announcements"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[61]||(a[61]=[l("mdi-bullhorn",-1)])]),_:1}),a[62]||(a[62]=l(" Announcements ",-1))]),_:1})):D("",!0),ot.value?(n(),m(Ae,{key:2,value:"members"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[63]||(a[63]=[l("mdi-account-group",-1)])]),_:1}),a[64]||(a[64]=l(" Members ",-1))]),_:1})):D("",!0),Ye.value?(n(),m(Ae,{key:3,value:"roles"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[65]||(a[65]=[l("mdi-account-key",-1)])]),_:1}),a[66]||(a[66]=l(" Roles ",-1))]),_:1})):D("",!0),Ye.value?(n(),m(Ae,{key:4,value:"delete-team"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[67]||(a[67]=[l("mdi-delete",-1)])]),_:1}),a[68]||(a[68]=l(" Delete Team ",-1))]),_:1})):D("",!0)]),_:1},8,["modelValue"]),t(j,{class:"mt-4"},{default:e(()=>[ye.value==="tasks"&&Fe.value?(n(),m(x,{key:0,cols:"12",md:"6",lg:"4"})):D("",!0),ye.value==="announcements"&&xt.value?(n(),m(x,{key:1,cols:"12",md:"6",lg:"4"},{default:e(()=>[ft((n(),m(F,{onClick:a[32]||(a[32]=d=>W.value=!W.value),color:"success",class:"w-100 project-card rounded-lg font-weight-bold",size:"large",variant:"outlined"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[69]||(a[69]=[l("mdi-bullhorn",-1)])]),_:1}),a[70]||(a[70]=l(" Add New Announcement ",-1))]),_:1})),[[vt,"Add new announcement","bottom"]])]),_:1})):D("",!0),ye.value==="members"?(n(),T(oe,{key:2},[Ft.value?(n(),m(x,{key:0,cols:"12",md:"6",lg:"4"},{default:e(()=>[ft((n(),m(F,{onClick:a[33]||(a[33]=d=>C.value=!0),color:"success",class:"w-100 project-card rounded-lg font-weight-bold",size:"large",variant:"outlined"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[71]||(a[71]=[l("mdi-account-plus",-1)])]),_:1}),a[72]||(a[72]=l(" Add Members ",-1))]),_:1})),[[vt,"Add team members","bottom"]])]),_:1})):D("",!0),zt.value?(n(),m(x,{key:1,cols:"12",md:"6",lg:"4"},{default:e(()=>[ft((n(),m(F,{onClick:a[34]||(a[34]=d=>L.value=!0),color:"error",class:"w-100 project-card rounded-lg font-weight-bold",size:"large",variant:"outlined"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[73]||(a[73]=[l("mdi-account-remove",-1)])]),_:1}),a[74]||(a[74]=l(" Remove Members ",-1))]),_:1})),[[vt,"Remove team members","bottom"]])]),_:1})):D("",!0)],64)):D("",!0)]),_:1})]),_:1})]),_:1}),t(Ut,{modelValue:ye.value,"onUpdate:modelValue":a[46]||(a[46]=d=>ye.value=d)},{default:e(()=>[t(Ue,{value:"tasks"},{default:e(()=>[E.value?(n(),T("div",ao,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(ee,{type:"heading",width:"200px",class:"mb-4"})]),_:1}),t(x,{cols:"12"},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(ee,{type:"text",height:"40px"})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(ee,{type:"text",height:"40px"})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(ee,{type:"text",height:"40px"})]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:e(()=>[(n(),T(oe,null,re(6,d=>t(x,{key:`task-skeleton-${d}`,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4 elevation-2"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ee,{type:"list-item-two-line"}),s("div",so,[t(ee,{type:"chip",width:"60px"}),t(ee,{type:"chip",width:"80px"})])]),_:1}),t(X,null,{default:e(()=>[t(ee,{type:"paragraph","max-width":"100%"}),t(ee,{type:"text",width:"100px",class:"mb-2"}),s("div",no,[t(ee,{type:"text",width:"80px"}),t(ee,{type:"text",width:"80px"})])]),_:1}),t(he,null,{default:e(()=>[t(ee,{type:"chip",width:"100px"})]),_:1})]),_:1})]),_:1})),64))]),_:1})])):(n(),T("div",oo,[G.value?(n(),m(j,{key:0},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",io,[s("h2",uo,"Your Tasks ("+i(ct.value.length)+")",1)])]),_:1}),t(x,{cols:"12"},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(xe,{modelValue:$e.value,"onUpdate:modelValue":a[35]||(a[35]=d=>$e.value=d),label:"Search by task name",placeholder:"e.g., Project Report","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(xe,{modelValue:se.value,"onUpdate:modelValue":a[36]||(a[36]=d=>se.value=d),label:"Search by tags",placeholder:"e.g., urgent development","prepend-inner-icon":"mdi-tag-multiple",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(Me,{modelValue:o.value,"onUpdate:modelValue":a[37]||(a[37]=d=>o.value=d),items:ml,label:"Filter tasks",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0),Bt.value.length>0&&G.value?(n(),m(j,{key:1},{default:e(()=>[(n(!0),T(oe,null,re(Bt.value,d=>(n(),m(x,{key:d._id,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4 elevation-2 project-card",onClick:de=>rl(d._id)},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,null,{default:e(()=>[l(i(d.title),1)]),_:2},1024),t(De,null,{default:e(()=>[t(te,{color:jt(d.priority),class:"mr-2"},{default:e(()=>[l(i(d.priority),1)]),_:2},1032,["color"]),t(te,{color:"purple-darken-2"},{default:e(()=>[l(i(d.category),1)]),_:2},1024),t(Oe,null,{default:e(()=>[(n(!0),T(oe,null,re(d.tags,de=>(n(),m(te,{key:de,color:"black",size:"small",class:"ml-1"},{default:e(()=>[l(i(de),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(X,null,{default:e(()=>[s("p",null,i(d.description),1),s("div",ro,[s("span",null,"Weight: "+i(d.weighted),1)]),s("div",mo,[s("span",null,"Start: "+i(new Date(d.startDate).toLocaleDateString()),1),s("span",null,"Due: "+i(new Date(d.dueDate).toLocaleDateString()),1)])]),_:2},1024),d.submitted?(n(),m(he,{key:1},{default:e(()=>[t(te,{color:"green","text-color":"white"},{default:e(()=>[...a[76]||(a[76]=[l("Submitted",-1)])]),_:1})]),_:1})):(n(),m(he,{key:0},{default:e(()=>[t(te,{color:"red","text-color":"white"},{default:e(()=>[...a[75]||(a[75]=[l("No Submission",-1)])]),_:1})]),_:1}))]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):D("",!0),Wt.value>1&&G.value?(n(),m(j,{key:2},{default:e(()=>[t(x,{cols:"12",class:"d-flex justify-center"},{default:e(()=>[t(Tl,{modelValue:p.value,"onUpdate:modelValue":a[38]||(a[38]=d=>p.value=d),length:Wt.value,"total-visible":7,color:"primary"},null,8,["modelValue","length"])]),_:1})]),_:1})):G.value&&ct.value.length===0&&ge.value.length>0?(n(),m(j,{key:3},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(pe,{type:"info",class:"text-center"},{default:e(()=>[...a[77]||(a[77]=[l(" No tasks match your current search and filter criteria. ",-1)])]),_:1})]),_:1})]),_:1})):G.value&&ge.value.length===0?(n(),m(j,{key:4},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(pe,{type:"info",class:"text-center"},{default:e(()=>[...a[78]||(a[78]=[l(" No tasks found. ",-1)])]),_:1})]),_:1})]),_:1})):D("",!0)]))]),_:1}),t(Ue,{value:"workflow"},{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",co,[a[81]||(a[81]=s("h2",{class:"text-h5"},"Team's Workflow",-1)),t(F,{color:"primary",variant:"outlined",size:"large",class:"flex-grow-1 flex-md-grow-0 mt-2",onClick:mt,loading:y.value},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[79]||(a[79]=[l("mdi-refresh",-1)])]),_:1}),a[80]||(a[80]=l(" Refresh ",-1))]),_:1},8,["loading"])])]),_:1})]),_:1}),s("div",null,[t(Hn,{taskGroups:u.value,"onUpdate:taskGroups":a[39]||(a[39]=d=>u.value=d)},null,8,["taskGroups"])])]),_:1}),Ke.value?(n(),m(Ue,{key:0,value:"task-groups"},{default:e(()=>[y.value?(n(),T("div",fo,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",vo,[t(ee,{type:"heading",width:"300px"}),t(ee,{type:"button",width:"100px",height:"32px"})])]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"mb-4",variant:"outlined"},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(ee,{type:"text",width:"200px"})]),_:1}),t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[(n(),T(oe,null,re(4,d=>t(x,{cols:"6",md:"3",key:`overview-skeleton-${d}`},{default:e(()=>[t(B,{class:"text-center pa-3",variant:"tonal"},{default:e(()=>[t(ne,null,{default:e(()=>[t(ee,{type:"text",width:"40px",class:"mx-auto"})]),_:1}),t(De,null,{default:e(()=>[t(ee,{type:"text",width:"80px",class:"mx-auto"})]),_:1})]),_:1})]),_:1})),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(ee,{type:"heading",width:"150px",class:"mb-3"})]),_:1}),(n(),T(oe,null,re(6,d=>t(x,{key:`taskgroup-skeleton-${d}`,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4 elevation-2",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(ee,{type:"text",width:"200px"}),t(ve),t(ee,{type:"chip",width:"60px"})]),_:1}),t(ee,{type:"text",width:"150px",class:"mb-1"}),t(ee,{type:"text",width:"120px"})]),_:1}),t(X,null,{default:e(()=>[s("div",po,[s("div",go,[t(ee,{type:"text",width:"60px",height:"12px"}),t(ee,{type:"text",width:"30px",height:"12px"})]),t(ee,{type:"divider",height:"8px",class:"rounded"})]),t(j,{class:"text-center"},{default:e(()=>[t(x,{cols:"6"},{default:e(()=>[t(ee,{type:"text",width:"30px",class:"mx-auto mb-1"}),t(ee,{type:"text",width:"60px",class:"mx-auto",height:"12px"})]),_:1}),t(x,{cols:"6"},{default:e(()=>[t(ee,{type:"text",width:"30px",class:"mx-auto mb-1"}),t(ee,{type:"text",width:"60px",class:"mx-auto",height:"12px"})]),_:1})]),_:1})]),_:1}),t(he,null,{default:e(()=>[t(ee,{type:"button",width:"80px"}),t(ve),t(ee,{type:"chip",width:"80px"})]),_:1})]),_:1})]),_:1})),64))]),_:1})])):(n(),T("div",yo,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",bo,[a[84]||(a[84]=s("h2",{class:"text-h5"},"Manage Team - Task Groups",-1)),t(F,{color:"primary",variant:"outlined",size:"large",class:"flex-grow-1 flex-md-grow-0 mt-4",onClick:mt,loading:y.value},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[82]||(a[82]=[l("mdi-refresh",-1)])]),_:1}),a[83]||(a[83]=l(" Refresh ",-1))]),_:1},8,["loading"])])]),_:1})]),_:1}),u.value.length>0?(n(),m(j,{key:0},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"mb-4",variant:"outlined"},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...a[85]||(a[85]=[l("mdi-view-dashboard",-1)])]),_:1}),a[86]||(a[86]=l(" Task Groups Overview ",-1))]),_:1}),t(X,null,{default:e(()=>[t(j,null,{default:e(()=>[t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"primary",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(u.value.length),1)]),_:1}),t(De,null,{default:e(()=>[...a[87]||(a[87]=[l("Total Task Groups",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"success",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(u.value.reduce((d,de)=>d+de.totalTasks,0)),1)]),_:1}),t(De,null,{default:e(()=>[...a[88]||(a[88]=[l("Total Tasks",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"info",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(u.value.reduce((d,de)=>d+de.completedTasks,0)),1)]),_:1}),t(De,null,{default:e(()=>[...a[89]||(a[89]=[l("Completed Tasks",-1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"6",md:"3"},{default:e(()=>[t(B,{class:"text-center pa-3",color:"warning",variant:"tonal"},{default:e(()=>[t(ne,{class:"text-h4"},{default:e(()=>[l(i(u.value.length>0?Math.round(u.value.reduce((d,de)=>d+parseFloat(de.completionRate),0)/u.value.length):0)+"% ",1)]),_:1}),t(De,null,{default:e(()=>[...a[90]||(a[90]=[l("Avg Completion",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0),u.value.length>0?(n(),m(j,{key:1},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",ko,[a[93]||(a[93]=s("h3",{class:"text-h6"},"Task Groups",-1)),ft((n(),m(F,{onClick:a[40]||(a[40]=d=>H.value=!H.value),color:"primary",class:"project-card rounded-lg font-weight-bold flex-grow-1 flex-md-grow-0",size:"large",variant:"outlined"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[91]||(a[91]=[l("mdi-file-document-plus-outline",-1)])]),_:1}),a[92]||(a[92]=l(" Add New Tasks ",-1))]),_:1})),[[vt,"Add new tasks to the team","bottom"]])])]),_:1}),(n(!0),T(oe,null,re(u.value,d=>(n(),m(x,{key:d.taskGroupId,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4 elevation-2 project-card task-group-card",onClick:de=>qt(d.taskGroupId),variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...a[94]||(a[94]=[l("mdi-folder-multiple",-1)])]),_:1}),l(" "+i(d.title)+" ",1),t(ve),t(te,{color:jt(d.priority),size:"small"},{default:e(()=>[l(i(d.priority),1)]),_:2},1032,["color"])]),_:2},1024),t(De,null,{default:e(()=>[l(" Category: "+i(d.category),1)]),_:2},1024),t(De,{class:"text-caption"},{default:e(()=>[l(" Due: "+i(Gt(d.dueDate)),1)]),_:2},1024)]),_:2},1024),t(X,null,{default:e(()=>[s("div",wo,[s("div",xo,[a[95]||(a[95]=s("span",{class:"text-caption"},"Progress",-1)),s("span",ho,i(d.completionRate)+"%",1)]),t(Zt,{"model-value":d.completionRate,color:"success",height:"8",rounded:""},null,8,["model-value"])]),t(j,{class:"text-center"},{default:e(()=>[t(x,{cols:"6"},{default:e(()=>[s("div",To,i(d.totalTasks),1),a[96]||(a[96]=s("div",{class:"text-caption text-grey"},"Total Tasks",-1))]),_:2},1024),t(x,{cols:"6"},{default:e(()=>[s("div",_o,i(d.completedTasks),1),a[97]||(a[97]=s("div",{class:"text-caption text-grey"},"Completed",-1))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(he,null,{default:e(()=>[t(F,{variant:"outlined",size:"small",onClick:It(de=>qt(d.taskGroupId),["stop"])},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[98]||(a[98]=[l("mdi-cog",-1)])]),_:1}),a[99]||(a[99]=l(" Manage ",-1))]),_:1},8,["onClick"]),t(ve),t(te,{variant:"outlined",size:"small",color:"primary"},{default:e(()=>[l(" Weight: "+i(d.totalWeight),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})):(n(),m(j,{key:2},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"text-center pa-6",variant:"outlined"},{default:e(()=>[t(X,null,{default:e(()=>[t(w,{size:"64",class:"mb-4",color:"grey"},{default:e(()=>[...a[100]||(a[100]=[l("mdi-folder-open",-1)])]),_:1}),a[103]||(a[103]=s("h3",{class:"text-h6 mb-2"},"No Task Groups Found",-1)),a[104]||(a[104]=s("p",{class:"text-grey mb-4"}," Task groups will appear here when you create tasks for team members. ",-1)),t(F,{color:"primary",onClick:a[41]||(a[41]=d=>H.value=!0),size:"large"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[101]||(a[101]=[l("mdi-plus",-1)])]),_:1}),a[102]||(a[102]=l(" Create Task Group ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]))]),_:1})):D("",!0),t(Ue,{value:"announcements"},{default:e(()=>[$.value?(n(),T("div",Co,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(ee,{type:"heading",width:"250px",class:"mb-4"})]),_:1})]),_:1}),t(j,null,{default:e(()=>[(n(),T(oe,null,re(3,d=>t(x,{cols:"12",key:`announcement-skeleton-${d}`},{default:e(()=>[t(B,{class:"mb-4 elevation-2",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ee,{type:"list-item",class:"mb-2"}),t(ee,{type:"heading",width:"300px",class:"mb-1"}),t(ee,{type:"text",width:"200px",class:"mb-1"}),t(ee,{type:"text",width:"150px"})]),_:1}),t(X,null,{default:e(()=>[t(ee,{type:"paragraph","max-width":"100%"})]),_:1}),t(he,null,{default:e(()=>[t(ee,{type:"button",width:"80px",class:"mr-2"}),t(ee,{type:"button",width:"100px"}),t(ve),t(ee,{type:"button",width:"60px",class:"mr-2"}),t(ee,{type:"button",width:"70px"})]),_:1})]),_:1})]),_:1})),64))]),_:1})])):(n(),T("div",Do,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[a[113]||(a[113]=s("h2",{class:"text-h5 mb-4"},"Team Announcements",-1)),Ce.value.length==0?(n(),m(B,{key:0,class:"mb-4"},{default:e(()=>[t(X,null,{default:e(()=>[...a[105]||(a[105]=[s("p",{class:"text-center text-grey"},"No announcements yet.",-1)])]),_:1})]),_:1})):D("",!0),(n(!0),T(oe,null,re(Ce.value,d=>(n(),m(B,{key:d._id,class:"mb-4 elevation-2",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,null,{default:e(()=>[l("Author: "+i(d.createdByUsername),1)]),_:2},1024),t(ne,{class:"font-weight-bold"},{default:e(()=>[l(i(d.title),1)]),_:2},1024),d.subtitle?(n(),m(De,{key:0,class:"text-caption"},{default:e(()=>[l(i(d.subtitle),1)]),_:2},1024)):D("",!0),t(De,{class:"text-caption"},{default:e(()=>[l(" Last Updated at:"+i(new Date(d.updatedAt).toLocaleDateString()),1)]),_:2},1024)]),_:2},1024),t(X,null,{default:e(()=>[s("p",null,i(d.content),1)]),_:2},1024),t(he,{class:"pa-3"},{default:e(()=>[s("div",Vo,[t(F,{onClick:de=>ul(d._id),color:dl(d),variant:"outlined",class:"announcement-action-btn"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[106]||(a[106]=[l("mdi-thumb-up",-1)])]),_:1}),s("span",null,"Like ("+i(d.likeUsers.length)+")",1)]),_:2},1032,["onClick","color"]),t(F,{onClick:de=>il(d._id),color:"secondary",variant:"outlined",class:"announcement-action-btn"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[107]||(a[107]=[l("mdi-comment-text",-1)])]),_:1}),a[108]||(a[108]=s("span",null,"Comments",-1))]),_:1},8,["onClick"]),t(ve,{class:"d-none d-sm-flex"}),ke(me).canManageAnnouncements()?(n(),m(F,{key:0,color:"primary",variant:"outlined",onClick:de=>nl(d._id),class:"announcement-action-btn"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[109]||(a[109]=[l("mdi-pencil",-1)])]),_:1}),a[110]||(a[110]=s("span",null,"Edit",-1))]),_:1},8,["onClick"])):D("",!0),ke(me).canDeleteAnnouncements()?(n(),m(F,{key:1,color:"error",variant:"outlined",onClick:de=>ol(d._id),class:"announcement-action-btn"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[111]||(a[111]=[l("mdi-delete",-1)])]),_:1}),a[112]||(a[112]=s("span",null,"Delete",-1))]),_:1},8,["onClick"])):D("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1}),t(Ue,{value:"members"},{default:e(()=>[q.value?(n(),T("div",Ro,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(ee,{type:"heading",width:"200px",class:"mb-4"}),t(ee,{type:"text",height:"40px",class:"mb-4"})]),_:1})]),_:1}),t(j,null,{default:e(()=>[(n(),T(oe,null,re(8,d=>t(x,{key:`member-skeleton-${d}`,cols:"12",md:"4"},{default:e(()=>[t(B,{class:"mb-2",variant:"outlined"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ee,{type:"list-item",class:"mb-2"}),t(ee,{type:"chip",width:"80px"})]),_:1})]),_:1})]),_:1})),64))]),_:1})])):(n(),T("div",$o,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[s("div",Mo,[s("h2",Io,"Team Members ("+i(Ct.value.length)+")",1)]),t(xe,{modelValue:ie.value,"onUpdate:modelValue":a[42]||(a[42]=d=>ie.value=d),label:"Search members...",placeholder:"Search by username or #role (e.g., #admin, #the-pro)","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"mb-4"},{"append-inner":e(()=>[t(_l,{location:"top"},{activator:e(({props:d})=>[t(w,Vt(d,{color:"grey"}),{default:e(()=>[...a[114]||(a[114]=[l("mdi-help-circle-outline",-1)])]),_:1},16)]),default:e(()=>[a[115]||(a[115]=s("div",null,[s("div",null,[s("strong",null,"Search Tips:")]),s("div",null," Type username to search by name"),s("div",null," Type #role to search by role"),s("div",null," Examples: john, #admin")],-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),(n(!0),T(oe,null,re(Ct.value,d=>(n(),m(x,{key:d.userId,cols:"12",md:"4"},{default:e(()=>[t(B,{class:"mb-2",variant:"outlined",color:d.customRole?d.customRole.color||"purple":ke(me).getRoleColor(d.baseRole)},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ne,null,{default:e(()=>[l(i(d.username),1)]),_:2},1024),t(De,null,{default:e(()=>[d.customRole?(n(),m(te,{key:0,color:d.customRole.color||"purple",size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(d.customRole.icon||"mdi-star"),1)]),_:2},1024),l(" "+i(d.customRole.name),1)]),_:2},1032,["color"])):(n(),m(te,{key:1,color:ke(me).getRoleColor(d.baseRole),size:"small",variant:"tonal"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[l(i(ke(me).getRoleIcon(d.baseRole)),1)]),_:2},1024),l(" "+i(d.roleLabel||d.baseRole),1)]),_:2},1032,["color"]))]),_:2},1024)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1}),Ct.value.length===0&&ie.value?(n(),m(j,{key:0},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{class:"text-center pa-6",variant:"outlined"},{default:e(()=>[t(X,null,{default:e(()=>[t(w,{size:"64",class:"mb-4",color:"grey"},{default:e(()=>[...a[116]||(a[116]=[l("mdi-account-search",-1)])]),_:1}),a[120]||(a[120]=s("h3",{class:"text-h6 mb-2"},"No Members Found",-1)),s("p",So,[a[117]||(a[117]=l(' No members match your search: "',-1)),s("strong",null,i(ie.value),1),a[118]||(a[118]=l('" ',-1))]),a[121]||(a[121]=s("p",{class:"text-caption text-grey"}," Try searching by username or use #role to search by role (e.g., #admin) ",-1)),t(F,{color:"primary",variant:"outlined",onClick:a[43]||(a[43]=d=>ie.value=""),class:"mt-2"},{default:e(()=>[...a[119]||(a[119]=[l(" Clear Search ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0)]))]),_:1}),Ft.value||zt.value||Ye.value?(n(),m(Ue,{key:1,value:"roles"},{default:e(()=>[t(mn,{teamId:ue.value,userProps:R.value,teamMembers:fe.value,onRolesUpdated:Et},null,8,["teamId","userProps","teamMembers"])]),_:1})):D("",!0),Ye.value?(n(),m(Ue,{key:2,value:"delete-team"},{default:e(()=>[s("div",Ao,[t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(pe,{type:"error",variant:"tonal",class:"mb-6",border:"start","border-color":"error"},{prepend:e(()=>[t(w,{size:"large"},{default:e(()=>[...a[122]||(a[122]=[l("mdi-alert-circle",-1)])]),_:1})]),default:e(()=>[t(Cl,{class:"text-h5 mb-2"},{default:e(()=>[t(w,{class:"mr-2"},{default:e(()=>[...a[123]||(a[123]=[l("mdi-delete",-1)])]),_:1}),a[124]||(a[124]=l(" Delete Team - Permanent Action ",-1))]),_:1}),a[125]||(a[125]=s("div",{class:"text-body-1"},[s("p",{class:"mb-2"},[s("strong",null,"Warning:"),l(" This action will permanently delete the current team and all its sub-teams. ")]),s("p",{class:"mb-0"}," All associated data including tasks, announcements, and member associations will be lost forever. ")],-1))]),_:1})]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(ne,null,{default:e(()=>[s("div",Uo,[s("div",Po,[t(w,{class:"mr-2",color:"error"},{default:e(()=>[...a[126]||(a[126]=[l("mdi-family-tree",-1)])]),_:1}),a[127]||(a[127]=l(" Teams to be Deleted ",-1))]),t(F,{onClick:Tt,variant:"outlined",size:"large",class:"flex-grow-1 flex-md-grow-0 mt-2 mb-2",loading:J.value},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[128]||(a[128]=[l("mdi-refresh",-1)])]),_:1}),a[129]||(a[129]=l(" Refresh ",-1))]),_:1},8,["loading"])])]),_:1}),t(X,null,{default:e(()=>[J.value?(n(),T("div",Oo,[t(ee,{type:"list-item-three-line",class:"mb-2"}),t(ee,{type:"list-item-two-line",class:"ml-4 mb-2"}),t(ee,{type:"list-item-two-line",class:"ml-8"})])):(n(),T("div",Fo,[s("div",zo,[s("div",Lo,[t(w,{color:"error",class:"mr-2"},{default:e(()=>[...a[130]||(a[130]=[l("mdi-crown",-1)])]),_:1}),s("div",Eo,[s("div",No,i(Q.value.title),1),s("div",jo," Current Team  "+i(Q.value.category),1),s("div",qo,i(fe.value.length)+" members  "+i(ge.value.length)+" tasks ",1)]),t(te,{color:"error",variant:"tonal",size:"small"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...a[131]||(a[131]=[l("mdi-delete",-1)])]),_:1}),a[132]||(a[132]=l(" WILL BE DELETED ",-1))]),_:1})])]),N.value.length>0?(n(),T("div",Go,[s("div",Bo,[t(w,{class:"mr-2"},{default:e(()=>[...a[133]||(a[133]=[l("mdi-sitemap",-1)])]),_:1}),l(" Sub-teams ("+i(N.value.length)+") ",1)]),(n(!0),T(oe,null,re(N.value,(d,de)=>(n(),T("div",{key:d._id,class:Be(["sub-team-item",{"last-sub-team":de===N.value.length-1}])},[s("div",Wo,[s("div",Ho,[de<N.value.length?(n(),T("div",Yo)):D("",!0),a[134]||(a[134]=s("div",{class:"horizontal-line"},null,-1))]),t(w,{color:"warning",class:"mr-2"},{default:e(()=>[...a[135]||(a[135]=[l("mdi-source-branch",-1)])]),_:1}),s("div",Jo,[s("div",Qo,i(d.title),1),s("div",Ko," Sub-team  "+i(d.category),1),s("div",Xo," Created: "+i(Gt(d.createdAt)),1)]),t(te,{color:"warning",variant:"tonal",size:"small"},{default:e(()=>[t(w,{start:"",size:"small"},{default:e(()=>[...a[136]||(a[136]=[l("mdi-delete",-1)])]),_:1}),a[137]||(a[137]=l(" WILL BE DELETED ",-1))]),_:1})])],2))),128))])):(n(),T("div",Zo,[t(pe,{type:"info",variant:"tonal",class:"mb-0"},{default:e(()=>[...a[138]||(a[138]=[l(" This team has no sub-teams. Only the current team will be deleted. ",-1)])]),_:1})]))]))]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(B,{variant:"outlined",class:"mb-4"},{default:e(()=>[t(ne,{class:"d-flex align-center"},{default:e(()=>[t(w,{class:"mr-2",color:"error"},{default:e(()=>[...a[139]||(a[139]=[l("mdi-shield-alert",-1)])]),_:1}),a[140]||(a[140]=l(" Confirmation Required ",-1))]),_:1}),t(X,null,{default:e(()=>[s("div",ei,[a[141]||(a[141]=s("p",{class:"text-body-1 mb-3"}," To proceed with deletion, please confirm by typing the team name exactly as shown: ",-1)),t(te,{color:"primary",variant:"tonal",class:"mb-3"},{default:e(()=>[l(i(Q.value.title),1)]),_:1})]),t(xe,{modelValue:v.value,"onUpdate:modelValue":a[44]||(a[44]=d=>v.value=d),label:"Type team name to confirm deletion",variant:"outlined",placeholder:Q.value.title,error:v.value&&v.value!==Q.value.title,"error-messages":v.value&&v.value!==Q.value.title?"Team name does not match":"",class:"mb-4"},{"prepend-inner":e(()=>[t(w,{color:"error"},{default:e(()=>[...a[142]||(a[142]=[l("mdi-keyboard",-1)])]),_:1})]),_:1},8,["modelValue","placeholder","error","error-messages"]),t(gt,{modelValue:K.value,"onUpdate:modelValue":a[45]||(a[45]=d=>K.value=d),color:"error",class:"mb-4"},{label:e(()=>[...a[143]||(a[143]=[s("span",{class:"text-body-2"},[l(" I understand that this action is "),s("strong",null,"permanent and irreversible"),l(". All data will be lost forever. ")],-1)])]),_:1},8,["modelValue"])]),_:1}),t(he,{class:"px-4 pb-4"},{default:e(()=>[t(F,{onClick:Nt,variant:"outlined",size:"large"},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[144]||(a[144]=[l("mdi-arrow-left",-1)])]),_:1}),a[145]||(a[145]=l(" Cancel ",-1))]),_:1}),t(ve),t(F,{onClick:cl,color:"error",variant:"elevated",size:"large",disabled:!Ht.value,loading:Te.value},{default:e(()=>[t(w,{start:""},{default:e(()=>[...a[146]||(a[146]=[l("mdi-delete-forever",-1)])]),_:1}),a[147]||(a[147]=l(" Delete Team ",-1))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})):D("",!0)]),_:1},8,["modelValue"])])):(n(),T("div",Yn,[t(j,{class:"align-center"},{default:e(()=>[t(x,{cols:"auto"},{default:e(()=>[t(ee,{type:"button",width:"40px",height:"40px"})]),_:1}),t(x,null,{default:e(()=>[t(ee,{type:"heading",width:"300px",class:"mb-2"}),t(ee,{type:"text",width:"400px"})]),_:1})]),_:1}),t(j,{class:"align-center mb-6 mt-6"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(ee,{type:"chip@5",class:"mb-4"}),t(j,{class:"mt-4"},{default:e(()=>[t(x,{cols:"12",md:"6",lg:"4"},{default:e(()=>[t(ee,{type:"button",height:"56px",class:"w-100"})]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:e(()=>[(n(),T(oe,null,re(6,d=>t(x,{key:`skeleton-${d}`,cols:"12",md:"6",lg:"4"},{default:e(()=>[t(B,{class:"mb-4 elevation-2"},{default:e(()=>[t(Ie,null,{default:e(()=>[t(ee,{type:"list-item-two-line"})]),_:1}),t(X,null,{default:e(()=>[t(ee,{type:"paragraph"}),t(ee,{type:"text",width:"100px",class:"mb-2"}),s("div",Jn,[t(ee,{type:"text",width:"80px"}),t(ee,{type:"text",width:"80px"})])]),_:1}),t(he,null,{default:e(()=>[t(ee,{type:"chip",width:"100px"})]),_:1})]),_:1})]),_:1})),64))]),_:1})]))]),_:1}))}}),ii=qe(ti,[["__scopeId","data-v-2dc426ea"]]);export{ii as default};
