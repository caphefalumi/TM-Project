import{_ as g,L as h,x as y,a7 as p}from"./B4Kh-yHs.js";import{Q as a,V as o,J as n,I as d,F as v,S as m,L as f,ah as k,_ as c,a0 as _}from"./CGnq_Kza.js";import"./CjwIl2eS.js";const T={name:"VerifyEmailView",data(){return{loading:!0,status:"pending",message:"",details:""}},computed:{title(){return this.loading?"Verifying email":this.status==="success"?"Email verified":this.status==="error"?"Verification failed":"Verification status"},statusIcon(){return this.loading?"mdi-email-sync":this.status==="success"?"mdi-check-circle":this.status==="error"?"mdi-alert-circle":"mdi-email-sync-outline"},iconColor(){return this.status==="success"?"success":this.status==="error"?"error":"primary"}},async mounted(){await this.verifyEmail()},methods:{formatDateTime(r){if(!r)return"";const e=new Date(r);return Number.isNaN(e.getTime())?"":e.toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})},async verifyEmail(){const r=(this._.provides[p]||this.$route).query.token;if(!r){this.loading=!1,this.status="error",this.message="Verification token is missing. Please use the link from your email.";return}try{const l=await fetch("undefined/api/users/email/verify",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:r})}),t=await l.json().catch(()=>({}));if(l.ok)if(this.status="success",this.message=t.success||"Your email has been verified successfully.",t.emailCooldownEndsAt){const s=this.formatDateTime(t.emailCooldownEndsAt);s&&(this.details=`You can update your email address again on ${s}.`)}else this.details="For security, you will need to sign in again to continue.";else this.status="error",this.message=t.error||"We could not verify your email. The link may have expired.",t.message&&t.message!==t.error&&(this.details=t.message)}catch{this.status="error",this.message="Something went wrong while verifying your email. Please try again."}finally{this.loading=!1}},goToLogin(){this.$router.push("/login")},goToAccount(){this.$router.push("/account/personal")}}},w={class:"verify-email"},V={key:0,class:"verify-loading"},C={class:"message"},E={key:0,class:"details"},N={class:"actions"};function S(r,e,l,t,s,i){return o(),a("div",w,[n("div",{class:f(["verify-card",s.status])},[s.loading?(o(),a("div",V,[d(h,{indeterminate:"",color:"primary",size:"40"}),e[2]||(e[2]=n("p",null,"Verifying your email address...",-1))])):(o(),a(v,{key:1},[n("div",{class:f(["icon-wrapper",s.status])},[d(y,{color:i.iconColor,size:"48"},{default:k(()=>[_(c(i.statusIcon),1)]),_:1},8,["color"])],2),n("h2",null,c(i.title),1),n("p",C,c(s.message),1),s.details?(o(),a("p",E,c(s.details),1)):m("",!0),n("div",N,[s.status==="success"?(o(),a("button",{key:0,class:"action primary",onClick:e[0]||(e[0]=(...u)=>i.goToLogin&&i.goToLogin(...u))}," Sign in ")):m("",!0),s.status!=="pending"?(o(),a("button",{key:1,class:"action secondary",onClick:e[1]||(e[1]=(...u)=>i.goToAccount&&i.goToAccount(...u))}," Back to account ")):m("",!0)])],64))],2)])}const L=g(T,[["render",S],["__scopeId","data-v-92ce6c35"]]);export{L as default};
