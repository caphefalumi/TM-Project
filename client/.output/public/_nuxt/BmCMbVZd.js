import{r as u,R as le,w as H,ai as f,V as i,ah as a,I as e,a0 as g,S as b,_ as w,v as pe,f as $,J as h,Q as D,F as K,am as X,T as ge,a2 as ve,Z as he}from"./CGnq_Kza.js";import{_ as oe,y as z,z as re,B as N,a0 as ne,Y as ye,a5 as ee,K as M,a2 as L,Z as J,C as Q,v as F,Q as Te,l as we,m as Ve,V as _e,q as be,s as A,t as _,x as W,O as ae,a6 as U,I as te,A as ke,D as xe,N as Ce,X as Ie}from"./B4Kh-yHs.js";import{f as se}from"./DWeS6x0F.js";import{u as Pe}from"./DE-cGGfL.js";import"./CjwIl2eS.js";function Ue(){const T=Pe();return{showSuccess:(r,d={})=>T.showSuccess(r,d),showError:(r,d={})=>T.showError(r,d),showWarning:(r,d={})=>T.showWarning(r,d),showInfo:(r,d={})=>T.showInfo(r,d),showNotification:r=>T.addNotification(r),removeNotification:r=>T.removeNotification(r),clearAllNotifications:()=>T.clearAll()}}const Ne={__name:"NewTeams",props:{dialog:{type:Boolean,required:!0},userProps:{type:Object,required:!0},teamsThatUserIsAdmin:{type:Array,required:!0}},emits:["update:dialog","team-created"],setup(T,{emit:R}){const{showSuccess:O,showError:I}=Ue(),y=u({userId:"",username:"",email:""}),k=u([]),V=R,o=u({title:"",category:"",description:"",parentTeamId:"",userId:"",username:""}),r=u(!1),d=u(!1),x=u(""),v=u(!1),P=c=>{y.value.userId=c.userId,y.value.username=c.username,y.value.email=c.email};le(async()=>{P(p.userProps),o.value.userId=y.value.userId,o.value.username=y.value.username,await j(),y||(y.value.username="Guest",y.value.email="")});const p=T,j=async()=>{try{const n=await fetch("undefined/api/teams/categories",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!n.ok)throw new Error("Network response was not ok");k.value=await n.json()}catch{}};H(()=>p.dialog,c=>{}),H(()=>p.teamsThatUserIsAdmin,c=>{p.teamsThatUserIsAdmin.value=c});const S=()=>{setTimeout(()=>{B(),r.value=!1,d.value=!1,x.value="",v.value=!1,V("update:dialog",!1),V("team-created")},1500)},B=()=>{o.value.title="",o.value.category="",o.value.description="",o.value.parentTeamId=""},G=async()=>{if(o.value.title.trim()===""){I("Project title is required",{title:"Validation Error"});return}else if(o.value.category.trim()===""){I("Category is required",{title:"Validation Error"});return}else if(o.value.description.trim().length<10){I("Description requires at least 10 characters",{title:"Validation Error"});return}v.value=!0;try{const n=await fetch("undefined/api/teams",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value)});if(!n.ok)throw d.value=!0,r.value=!1,x.value=n.json().message||"Failed to create project",v.value=!1,new Error("Network response was not ok");const m=await n.json();O(`Team "${m.title}" created successfully!`,{title:"Team Created"});const E={title:m.title,teamId:m.teamId};p.teamsThatUserIsAdmin.push(E),S()}catch{v.value=!1,I("Failed to create team. Please try again.",{title:"Team Creation Failed"})}};return(c,n)=>(i(),f(Te,{modelValue:p.dialog,"onUpdate:modelValue":n[5]||(n[5]=m=>p.dialog=m),"max-width":"600px",closable:""},{default:a(()=>[e(z,null,{default:a(()=>[e(re,{class:"font-weight-bold text-center text-h5 mb-2 mt-2"},{default:a(()=>[...n[6]||(n[6]=[g("Create New Team",-1)])]),_:1}),e(N,null,{default:a(()=>[e(ne,{modelValue:o.value.title,"onUpdate:modelValue":n[0]||(n[0]=m=>o.value.title=m),label:"Team Title",variant:"outlined",required:""},null,8,["modelValue"]),e(ye,{modelValue:o.value.description,"onUpdate:modelValue":n[1]||(n[1]=m=>o.value.description=m),label:"Description",rows:"3",variant:"outlined"},null,8,["modelValue"]),e(ee,null,{default:a(()=>[e(M,{modelValue:o.value.category,"onUpdate:modelValue":n[2]||(n[2]=m=>o.value.category=m),items:k.value,label:"Category",variant:"outlined",required:""},null,8,["modelValue","items"])]),_:1}),p.teamsThatUserIsAdmin.length>0?(i(),f(ee,{key:0},{default:a(()=>[e(M,{modelValue:o.value.parentTeamId,"onUpdate:modelValue":n[3]||(n[3]=m=>o.value.parentTeamId=m),items:p.teamsThatUserIsAdmin,"item-title":"title","item-value":"teamId",label:"Parent Team ID (optional)",variant:"outlined",placeholder:"Select parent team if applicable",clearable:"","clear-icon":"mdi-close"},null,8,["modelValue","items"])]),_:1})):b("",!0)]),_:1}),e(N,null,{default:a(()=>[r.value?(i(),f(L,{key:0,type:"success"},{default:a(()=>[g(w(x.value),1)]),_:1})):b("",!0),d.value?(i(),f(L,{key:1,type:"error"},{default:a(()=>[g(w(x.value),1)]),_:1})):b("",!0)]),_:1}),e(J,null,{default:a(()=>[e(Q),e(F,{onClick:n[4]||(n[4]=m=>V("update:dialog",!1)),variant:"outlined",disabled:v.value},{default:a(()=>[...n[7]||(n[7]=[g("Cancel",-1)])]),_:1},8,["disabled"]),e(F,{color:"primary",onClick:G,variant:"outlined",disabled:v.value,loading:v.value},{default:a(()=>[...n[8]||(n[8]=[g(" Create ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Se=Object.assign(oe(Ne,[["__scopeId","data-v-eeea96b9"]]),{__name:"NewTeams"}),Ae={class:"teams-container w-100"},Fe={class:"w-100"},Re={class:"progress-section"},Oe={class:"progress-label mb-2"},je={key:1,class:"teams-container w-100"},Ee={class:"progress-section"},$e={class:"progress-label mb-2"},De={class:"text-caption text-grey-darken-1"},qe={class:"text-caption text-grey-darken-1 ml-2"},q=6,Le=Object.assign({name:"TeamsView"},{__name:"index",setup(T){const R=we(),{needsRefresh:O,markAsRefreshed:I}=Ve(),y=be(),k=u(!1),V=u([]),o=u([]),r=u(!0),d=u({userId:"",username:"",email:""}),x=async()=>{k.value=!1,r.value=!0;const t=await R.getUserByAccessToken();t?(ue(t),await Y(),await Z(),k.value=!0,r.value=!1):(d.value.username="Guest",r.value=!1)};le(async()=>{await x()}),pe(async()=>{O("TeamsView")&&(await x(),I("TeamsView"))});const v=u(!1);u(!1),u(!1);const P=u(""),p=u(1),j=u(!1),S=u(""),B=["Development","Design","Marketing","Sales","Support","Operations","Finance","Human Resources","Legal","Product Management","Data Science","Research and Development","Other"],G=$(()=>B.map(t=>{const s=o.value.filter(l=>l.category===t).length;return{title:s>0?`${t} (${s})`:t,value:t,disabled:s===0}}).filter(t=>!t.disabled)),c=$(()=>{let t=[...o.value];return P.value&&(t=t.filter(s=>s.title.toLowerCase().includes(P.value.toLowerCase()))),S.value&&(t=t.filter(s=>s.category===S.value)),t}),n=$(()=>Math.ceil(c.value.length/q)),m=$(()=>{const t=(p.value-1)*q,s=t+q;return c.value.slice(t,s)}),E=()=>{p.value=1},ie=t=>{j.value=!0,setTimeout(()=>{p.value=t,setTimeout(()=>{j.value=!1},50)},150)},ue=t=>{d.value.userId=t.userId,d.value.username=t.username,d.value.email=t.email},Y=async()=>{try{const{ok:s,status:l,data:C}=await se("undefined/api/teams/admin",{method:"GET",headers:{"Content-Type":"application/json"}});if(!s)throw new Error(C?.message||`Failed to fetch admin teams (Status ${l})`);V.value=C}catch{V.value=[]}},Z=async()=>{try{const{ok:s,status:l,data:C}=await se("undefined/api/teams",{method:"GET",headers:{"Content-Type":"application/json"}});if(!s)throw new Error(C?.message||`Failed to fetch user teams (Status ${l})`);o.value=C}catch{o.value=[]}},de=async()=>{r.value=!0,await Y(),await Z(),r.value=!1},ce=async()=>{await x()},me=t=>{y.push(`/teams/${t}`)},fe=t=>t<=12.5?"red-darken-2":t<=25?"red":t<=37.5?"orange-darken-2":t<=50?"orange":t<=62.5?"yellow-darken-2":t<=75?"yellow":t<=87.5?"light-green":"green";return(t,s)=>(i(),f(_e,{fluid:""},{default:a(()=>[e(A,{class:"align-center mb-6"},{default:a(()=>[e(_,{cols:"12",md:"8"},{default:a(()=>[...s[5]||(s[5]=[h("h1",{class:"text-h4 font-weight-bold"},"Teams",-1),h("p",{class:"text-h6 text-grey"},"Manage and explore your teams",-1)])]),_:1}),e(_,{cols:"12",md:"4",class:"text-right"},{default:a(()=>[e(F,{onClick:ce,loading:r.value,color:"primary",size:"large",variant:"outlined",class:"mr-2"},{default:a(()=>[e(W,{start:""},{default:a(()=>[...s[6]||(s[6]=[g("mdi-refresh",-1)])]),_:1}),s[7]||(s[7]=g(" Refresh ",-1))]),_:1},8,["loading"])]),_:1})]),_:1}),k.value?(i(),f(Se,{key:0,dialog:v.value,"onUpdate:dialog":s[0]||(s[0]=l=>v.value=l),userProps:d.value,teamsThatUserIsAdmin:V.value,"onUpdate:teamsThatUserIsAdmin":s[1]||(s[1]=l=>V.value=l),onTeamCreated:de},null,8,["dialog","userProps","teamsThatUserIsAdmin"])):b("",!0),!r.value&&o.value.length>0?(i(),f(A,{key:1,class:"mb-4 align-center"},{default:a(()=>[e(_,{cols:"12",md:"8",lg:"6"},{default:a(()=>[e(ne,{modelValue:P.value,"onUpdate:modelValue":s[2]||(s[2]=l=>P.value=l),onInput:E,label:"Search teams...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"4",lg:"4"},{default:a(()=>[e(M,{modelValue:S.value,"onUpdate:modelValue":[s[3]||(s[3]=l=>S.value=l),E],items:G.value,"item-title":"title","item-value":"value",label:"Filter by Category",variant:"outlined",density:"compact",clearable:"","hide-details":"","prepend-inner-icon":"mdi-filter"},null,8,["modelValue","items"])]),_:1})]),_:1})):b("",!0),r.value?(i(),f(A,{key:2,class:"mb-6"},{default:a(()=>[h("div",Ae,[h("div",Fe,[(i(),D(K,null,X(6,l=>e(_,{key:`skeleton-${l}`,cols:"12",sm:"6",md:"4",class:"d-flex"},{default:a(()=>[e(z,{class:"team-card rounded-lg elevation-1 flex-fill",flat:""},{default:a(()=>[e(ae,null,{default:a(()=>[e(U,{type:"list-item-two-line",class:"mb-2"})]),_:1}),e(N,null,{default:a(()=>[e(U,{type:"paragraph","max-width":"100%"})]),_:1}),e(N,{class:"pt-0"},{default:a(()=>[h("div",Re,[h("div",Oe,[e(U,{type:"text",width:"80px",height:"12px"}),e(U,{type:"text",width:"30px",height:"12px"})]),e(U,{type:"divider",height:"8px",class:"rounded"})])]),_:1}),e(te),e(J,{class:"pa-4"},{default:a(()=>[e(U,{type:"chip",width:"60px"}),e(Q),e(U,{type:"button",width:"32px",height:"32px",class:"rounded-circle"})]),_:1})]),_:1})]),_:1})),64))])])]),_:1})):!r.value&&o.value.length>0?(i(),f(A,{key:3,class:"mb-6"},{default:a(()=>[c.value.length===0?(i(),f(_,{key:0,cols:"12",class:"text-center"},{default:a(()=>[e(L,{type:"info"},{default:a(()=>[g(' No teams found matching "'+w(P.value)+'". Try a different search term. ',1)]),_:1})]),_:1})):(i(),D("div",je,[e(ge,{name:"page-fade",mode:"out-in"},{default:a(()=>[(i(),D("div",{key:p.value,class:"w-100"},[e(ve,{name:"card-slide",tag:"div",class:"w-100",appear:""},{default:a(()=>[(i(!0),D(K,null,X(m.value,(l,C)=>(i(),f(_,{key:l.teamId,id:"team-card-"+C,cols:"12",sm:"6",md:"4",class:"d-flex",style:he({"transition-delay":`${C*75}ms`})},{default:a(()=>[e(z,{class:"team-card rounded-lg elevation-1 flex-fill",flat:"","data-team-id":l.teamId,"data-team-title":l.title,onClick:Be=>me(l.teamId)},{default:a(()=>[e(ae,null,{default:a(()=>[e(re,{class:"font-weight-bold text-wrap"},{default:a(()=>[g(w(l.title),1)]),_:2},1024),e(ke,null,{default:a(()=>[g(w(l.category),1)]),_:2},1024)]),_:2},1024),e(N,null,{default:a(()=>[g(w(l.description),1)]),_:2},1024),l.progress.progressPercentage>=0?(i(),f(N,{key:0,class:"pt-0"},{default:a(()=>[h("div",Ee,[h("div",$e,[h("span",De," Weight: "+w(l.progress.completedWeight)+"/"+w(l.progress.totalWeight),1),h("span",qe,w(l.progress.progressPercentage)+"% ",1)]),e(xe,{"model-value":l.progress.progressPercentage,height:"8",rounded:"",color:l.progress.progressPercentage>0?fe(l.progress.progressPercentage):"grey-lighten-2","bg-color":"grey-lighten-3",class:"progress-bar"},null,8,["model-value","color"])])]),_:2},1024)):(i(),f(N,{key:1,class:"pt-0"},{default:a(()=>[...s[8]||(s[8]=[h("div",{class:"progress-section"},[h("span",{class:"text-caption text-grey-darken-1"}," No Tasks Found ")],-1)])]),_:1})),e(te),e(J,{class:"pa-4"},{default:a(()=>[e(Ce,{color:l.roleColor||"grey",size:"small"},{default:a(()=>[g(w(l.roleLabel||l.baseRole),1)]),_:2},1032,["color"]),e(Q),e(F,{icon:"",size:"small"},{default:a(()=>[e(W,null,{default:a(()=>[...s[9]||(s[9]=[g("mdi-arrow-right",-1)])]),_:1})]),_:1})]),_:2},1024)]),_:2},1032,["data-team-id","data-team-title","onClick"])]),_:2},1032,["id","style"]))),128))]),_:1})]))]),_:1})]))]),_:1})):b("",!0),!r.value&&o.value.length>0&&c.value.length>q?(i(),f(A,{key:4,justify:"center",class:"mb-6"},{default:a(()=>[e(_,{cols:"auto"},{default:a(()=>[e(Ie,{"model-value":p.value,"onUpdate:modelValue":ie,length:n.value,"total-visible":5,color:"primary",density:"comfortable"},null,8,["model-value","length"])]),_:1})]),_:1})):b("",!0),!r.value&&o.value.length===0?(i(),f(A,{key:5,class:"mb-6"},{default:a(()=>[e(_,{cols:"12",class:"text-center"},{default:a(()=>[e(L,{type:"info"},{default:a(()=>[...s[10]||(s[10]=[g("You are not a member of any teams yet.",-1)])]),_:1})]),_:1})]),_:1})):b("",!0),k.value?(i(),f(F,{key:6,class:"fixed-float-btn",color:"primary",fab:"",onClick:s[4]||(s[4]=l=>v.value=!v.value)},{default:a(()=>[e(W,null,{default:a(()=>[...s[11]||(s[11]=[g("mdi-plus",-1)])]),_:1})]),_:1})):b("",!0)]),_:1}))}}),Qe=oe(Le,[["__scopeId","data-v-05fa64a4"]]);export{Qe as default};
