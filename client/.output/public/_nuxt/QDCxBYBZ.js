import{_ as O,l as D,m as G,q as $,V as J,s as K,t as C,v as T,x as Q,y as Y,z as Z,B as H,$ as L,a4 as x,Y as W,K as X,a2 as ee,Z as ae,C as te}from"./B4Kh-yHs.js";import{r,R as se,v as le,ai as U,V as y,ah as n,I as t,J as o,a0 as c,Q as oe,S as A,_ as g}from"./CGnq_Kza.js";import"./CjwIl2eS.js";const ne={class:"text-h6 text-grey"},re={key:0,class:"text-primary"},ie={class:"mt-4"},ue={class:"rating-container"},de={class:"text-body-2 text-grey mt-1 text-center",style:{"min-height":"20px"}},ce={class:"mt-4"},ge={class:"rating-container"},ve={class:"text-body-2 text-grey mt-1 text-center",style:{"min-height":"20px"}},me={class:"mt-4"},fe={class:"rating-container"},pe={class:"text-body-2 text-grey mt-1 text-center",style:{"min-height":"20px"}},Ve={class:"mt-4"},be=Object.assign({name:"FeedbackView"},{__name:"feedback",setup(he){const R=D(),{needsRefresh:I,markAsRefreshed:M}=G(),b=$(),v=r(!1),m=r(!1),d=r(!1),w=r("success"),_=r(""),u=r({userId:"",username:"",email:""}),B=["Very bad","Bad","Average","Good","Excellent"],s=r({message:"",experience:"",featureRating:1,perfRating:1,uiRating:1}),i={1:"Very bad",2:"Bad",3:"Average",4:"Good",5:"Excellent"},f=r(""),p=r(""),V=r(""),F=a=>{u.value.userId=a.userId,u.value.username=a.username,u.value.email=a.email},h=()=>{s.value={message:"",experience:"",featureRating:1,perfRating:1,uiRating:1},v.value=!1,f.value=i[1],p.value=i[1],V.value=i[1]},k=(a,e)=>{w.value=a,_.value=e,d.value=!0,a==="success"&&setTimeout(()=>{d.value=!1},5e3)},S=a=>{f.value=i[a]||""},E=a=>{p.value=i[a]||""},q=a=>{V.value=i[a]||""},N=async()=>{if(!u.value.userId){k("error","User not authenticated. Please log in again."),setTimeout(()=>{b.push("/login")},2e3);return}m.value=!0,d.value=!1;const a=void 0;try{const e={...s.value,userId:u.value.userId,issue:s.value.experience},l=await fetch(`${a}/api/ratings`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok){const j=await l.json();throw new Error(j.error||"Failed to submit feedback")}const P=await l.json();h(),k("success",P.success||"Feedback submitted successfully!")}catch(e){k("error",e.message)}finally{m.value=!1}};se(async()=>{const a=await R.getUserByAccessToken();a?F(a):b.push("/login"),f.value=i[s.value.featureRating],p.value=i[s.value.perfRating],V.value=i[s.value.uiRating]});const z=()=>{h()};return le(async()=>{if(I("FeedbackView")&&(h(),M("FeedbackView")),!u.value.userId){const a=await R.getUserByAccessToken();a?F(a):b.push("/login")}}),(a,e)=>(y(),U(J,{fluid:"",class:"pa-6"},{default:n(()=>[t(K,{class:"align-center mb-6"},{default:n(()=>[t(C,{cols:"12",md:"8"},{default:n(()=>[e[8]||(e[8]=o("h1",{class:"text-h4 font-weight-bold"},"Feedback",-1)),o("p",ne,[e[7]||(e[7]=c(" Share your thoughts and help us improve ",-1)),u.value.username?(y(),oe("span",re,", "+g(u.value.username),1)):A("",!0)])]),_:1}),t(C,{cols:"12",md:"4",class:"text-right"},{default:n(()=>[t(T,{onClick:z,color:"primary",size:"large",variant:"outlined"},{default:n(()=>[t(Q,{start:""},{default:n(()=>[...e[9]||(e[9]=[c("mdi-refresh",-1)])]),_:1}),e[10]||(e[10]=c(" Refresh ",-1))]),_:1})]),_:1})]),_:1}),t(Y,{class:"mx-auto","max-width":"500"},{default:n(()=>[t(Z,{class:"text-h5 text-center f-bold"},{default:n(()=>[...e[11]||(e[11]=[c("Feedback Form",-1)])]),_:1}),t(H,null,{default:n(()=>[t(L,{ref:"form",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l)},{default:n(()=>[o("div",ie,[e[12]||(e[12]=o("div",{class:"text-h6 mb-2"},"Feature Rating",-1)),o("div",ue,[t(x,{modelValue:s.value.featureRating,"onUpdate:modelValue":[e[0]||(e[0]=l=>s.value.featureRating=l),S],length:"5","background-color":"grey lighten-1","active-color":"yellow darken-3",hover:"",size:"large",class:"full-width-rating",required:""},null,8,["modelValue"])]),o("div",de,g(f.value),1)]),o("div",ce,[e[13]||(e[13]=o("div",{class:"text-h6 mb-2"},"Performance Rating",-1)),o("div",ge,[t(x,{modelValue:s.value.perfRating,"onUpdate:modelValue":[e[1]||(e[1]=l=>s.value.perfRating=l),E],length:"5","background-color":"grey lighten-1","active-color":"yellow darken-3",hover:"",size:"large",class:"full-width-rating",required:""},null,8,["modelValue"])]),o("div",ve,g(p.value),1)]),o("div",me,[e[14]||(e[14]=o("div",{class:"text-h6 mb-2"},"User Interface Rating",-1)),o("div",fe,[t(x,{modelValue:s.value.uiRating,"onUpdate:modelValue":[e[2]||(e[2]=l=>s.value.uiRating=l),q],length:"5","background-color":"grey lighten-1","active-color":"yellow darken-3",hover:"",size:"large",class:"full-width-rating",required:""},null,8,["modelValue"])]),o("div",pe,g(V.value),1)]),o("div",Ve,[t(W,{label:"Message",modelValue:s.value.message,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.message=l),placeholder:"Enter your feedback here...",variant:"outlined",required:""},null,8,["modelValue"]),t(X,{label:"General Experience",items:B,modelValue:s.value.experience,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.experience=l),variant:"outlined",required:""},null,8,["modelValue"])])]),_:1},8,["modelValue"]),d.value?(y(),U(ee,{key:0,type:w.value,"model-value":d.value,closable:"","onClick:close":e[6]||(e[6]=l=>d.value=!1),class:"mt-4"},{default:n(()=>[c(g(_.value),1)]),_:1},8,["type","model-value"])):A("",!0)]),_:1}),t(ae,null,{default:n(()=>[t(te),t(T,{color:"primary",disabled:!v.value||m.value,loading:m.value,onClick:N,variant:"outlined"},{default:n(()=>[...e[15]||(e[15]=[c(" Submit Feedback ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1}))}}),Re=O(be,[["__scopeId","data-v-86746a59"]]);export{Re as default};
