import{r,f,ai as b,V as C,ah as s,I as a,a0 as n,S as T,ac as J,b as c,A as t,_ as U,J as q}from"./CGnq_Kza.js";import{u as z,V as K,s as N,t as k,y as S,z as $,B,$ as L,a0 as w,v as x,a2 as E,Q as M,Z as Q,C as Y}from"./B4Kh-yHs.js";import"./CjwIl2eS.js";const W={__name:"register",setup(Z){const P=z(),u=r(""),i=r(""),o=r(""),d=r(""),v=r(!1),V=r(!1),m=r(""),y=r(""),g=r(!1),p=r(!1),O=f(()=>u.value.length>=3),j=f(()=>/.+@.+\..+/.test(i.value)),A=f(()=>o.value.length>=6),D=f(()=>d.value===o.value&&d.value.length>0),F=f(()=>O.value&&j.value&&A.value&&D.value);async function I(){m.value="",y.value="",g.value=!0;try{const e=await fetch("undefined/api/auth/local/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u.value,email:i.value,password:o.value})}),l=await e.json();e.ok?(p.value=!0,y.value="",setTimeout(()=>P.push("/login"),3e3)):m.value=l.error||"Registration failed"}catch{m.value="Network error"}g.value=!1}return(R,e)=>(C(),b(K,{class:"fill-height",fluid:""},{default:s(()=>[a(N,{align:"center",justify:"center"},{default:s(()=>[a(k,{cols:"12",sm:"8",md:"4"},{default:s(()=>[a(S,{class:"pa-6",elevation:"8"},{default:s(()=>[a($,{class:"text-h5 text-center mb-2"},{default:s(()=>[...e[9]||(e[9]=[n("Register",-1)])]),_:1}),a(B,null,{default:s(()=>[a(L,{onSubmit:J(I,["prevent"])},{default:s(()=>[a(w,{modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=l=>c(u)?u.value=l:null),label:"Username",type:"text","prepend-inner-icon":"mdi-account",required:"",class:"mb-4",rules:[l=>!!l||"Username is required",l=>l.length>=3||"Username must be at least 3 characters"]},null,8,["modelValue","rules"]),a(w,{modelValue:t(i),"onUpdate:modelValue":e[1]||(e[1]=l=>c(i)?i.value=l:null),label:"Email",type:"email","prepend-inner-icon":"mdi-email",required:"",class:"mb-4",rules:[l=>!!l||"Email is required",l=>/.+@.+\..+/.test(l)||"E-mail must be valid"]},null,8,["modelValue","rules"]),a(w,{modelValue:t(o),"onUpdate:modelValue":e[2]||(e[2]=l=>c(o)?o.value=l:null),type:t(v)?"text":"password",label:"Password","prepend-inner-icon":"mdi-lock","append-inner-icon":t(v)?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[3]||(e[3]=l=>v.value=!t(v)),required:"",class:"mb-4",rules:[l=>!!l||"Password is required",l=>l.length>=6||"Password must be at least 6 characters"]},null,8,["modelValue","type","append-inner-icon","rules"]),a(w,{modelValue:t(d),"onUpdate:modelValue":e[4]||(e[4]=l=>c(d)?d.value=l:null),type:t(V)?"text":"password",label:"Confirm Password","prepend-inner-icon":"mdi-lock-check","append-inner-icon":t(V)?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[5]||(e[5]=l=>V.value=!t(V)),required:"",class:"mb-4",rules:[l=>!!l||"Confirm password is required",l=>l===t(o)||"Passwords do not match"]},null,8,["modelValue","type","append-inner-icon","rules"]),a(x,{loading:t(g),disabled:!t(F)||t(g),type:"submit",color:"primary",block:"",class:"mb-2"},{default:s(()=>[...e[10]||(e[10]=[n(" Register ",-1)])]),_:1},8,["loading","disabled"])]),_:1}),t(m)?(C(),b(E,{key:0,type:"error",class:"mt-2"},{default:s(()=>[n(U(t(m)),1)]),_:1})):T("",!0),t(y)?(C(),b(E,{key:1,type:"success",class:"mt-2"},{default:s(()=>[n(U(t(y)),1)]),_:1})):T("",!0),a(M,{modelValue:t(p),"onUpdate:modelValue":e[7]||(e[7]=l=>c(p)?p.value=l:null),persistent:"","max-width":"400"},{default:s(()=>[a(S,null,{default:s(()=>[a($,{class:"text-h6"},{default:s(()=>[...e[11]||(e[11]=[n("Verify Your Email",-1)])]),_:1}),a(B,null,{default:s(()=>[...e[12]||(e[12]=[n(" Registration successful!",-1),q("br",null,null,-1),n(" Please check your email and click the verification link to activate your account. ",-1)])]),_:1}),a(Q,null,{default:s(()=>[a(Y),a(x,{color:"primary",onClick:e[6]||(e[6]=l=>p.value=!1)},{default:s(()=>[...e[13]||(e[13]=[n("OK",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(N,{class:"mt-2",align:"center",justify:"space-evenly"},{default:s(()=>[a(k,{class:"pa-0 text-right",cols:"6"},{default:s(()=>[...e[14]||(e[14]=[q("span",null,"Already have an account?",-1)])]),_:1}),a(k,{class:"pa-0 text-center",cols:"6"},{default:s(()=>[a(x,{variant:"text",color:"secondary",onClick:e[8]||(e[8]=l=>t(P).push("/login"))},{default:s(()=>[...e[15]||(e[15]=[n("Login",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{W as default};
