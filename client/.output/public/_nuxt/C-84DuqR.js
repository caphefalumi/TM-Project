import{r as o,R as O,ai as x,V as w,ah as t,I as a,J as i,a0 as l,Q as k,ac as B}from"./CGnq_Kza.js";import{_ as N,a8 as q,V as I,q as S,s as z,t as $,y as j,z as J,x as m,B as U,$ as A,a0 as P,v as V,Z as E}from"./B4Kh-yHs.js";import"./CjwIl2eS.js";const F={class:"text-h4 font-weight-bold primary--text"},M={key:0,class:"text-center py-8"},Z={key:1,class:"text-center py-8"},L={__name:"reset-password",setup(Q){const g=q(),R=S(),u=o(""),y=o(""),d=o(!1),b=o(!1),r=o(!1),f=o(!1),c=o(!1),v=o(!1),p=o(""),T=[s=>!!s||"Password is required",s=>s.length>=8||"Password must be at least 8 characters long",s=>/(?=.*[a-z])/.test(s)||"Password must contain at least one lowercase letter",s=>/(?=.*[A-Z])/.test(s)||"Password must contain at least one uppercase letter",s=>/(?=.*\d)/.test(s)||"Password must contain at least one number"],C=[s=>!!s||"Please confirm your password",s=>s===u.value||"Passwords do not match"];O(async()=>{if(p.value=g.query.token,!p.value){r.value=!0;return}try{(await fetch("undefined/api/auth/verify-reset-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p.value})})).ok||(r.value=!0)}catch{r.value=!0}});const h=async()=>{if(!(!f.value||!p.value)){d.value=!0,r.value=!1,b.value=!1;try{(await fetch("undefined/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p.value,password:u.value})})).ok?(b.value=!0,u.value="",y.value="",setTimeout(()=>{R.push("/login")},3e3)):r.value=!0}catch{r.value=!0}finally{d.value=!1}}};return(s,e)=>(w(),x(I,{class:"fill-height",fluid:""},{default:t(()=>[a(z,{align:"center",justify:"center"},{default:t(()=>[a($,{cols:"12",sm:"8",md:"6",lg:"4"},{default:t(()=>[a(j,{class:"elevation-12"},{default:t(()=>[a(J,{class:"text-center py-6"},{default:t(()=>[i("h2",F,[a(m,{class:"mr-2",color:"primary"},{default:t(()=>[...e[5]||(e[5]=[l("mdi-lock-reset",-1)])]),_:1}),e[6]||(e[6]=l(" Reset Password ",-1))])]),_:1}),a(U,null,{default:t(()=>[r.value?(w(),k("div",M,[a(m,{size:"64",color:"error",class:"mb-4"},{default:t(()=>[...e[7]||(e[7]=[l("mdi-alert-circle",-1)])]),_:1}),e[8]||(e[8]=i("h3",{class:"text-h5 mb-2 text-error"},"Invalid token",-1)),e[9]||(e[9]=i("p",{class:"text-body-1 text-medium-emphasis"}," The reset link is invalid or has expired. Please request a new password reset. ",-1))])):b.value?(w(),k("div",Z,[a(m,{size:"64",color:"success",class:"mb-4"},{default:t(()=>[...e[10]||(e[10]=[l("mdi-check-circle",-1)])]),_:1}),e[11]||(e[11]=i("h3",{class:"text-h5 mb-2 text-success"},"Password Reset Successful!",-1)),e[12]||(e[12]=i("p",{class:"text-body-1 text-medium-emphasis"}," Your password has been successfully reset. Redirecting to login... ",-1))])):(w(),x(A,{key:2,onSubmit:B(h,["prevent"]),modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=n=>f.value=n)},{default:t(()=>[e[15]||(e[15]=i("p",{class:"text-body-1 mb-4 text-center"},"Enter your new password below.",-1)),a(P,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),label:"New Password",type:c.value?"text":"password","prepend-inner-icon":"mdi-lock","append-inner-icon":c.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[1]||(e[1]=n=>c.value=!c.value),variant:"outlined",class:"mb-3",rules:T,required:"",disabled:d.value,hint:"Password must be at least 8 characters long","persistent-hint":""},null,8,["modelValue","type","append-inner-icon","disabled"]),a(P,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=n=>y.value=n),label:"Confirm New Password",type:v.value?"text":"password","prepend-inner-icon":"mdi-lock-check","append-inner-icon":v.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":e[3]||(e[3]=n=>v.value=!v.value),variant:"outlined",class:"mb-3",rules:C,required:"",disabled:d.value},null,8,["modelValue","type","append-inner-icon","disabled"]),a(V,{type:"submit",color:"primary",block:"",size:"large",class:"mb-3",loading:d.value,disabled:!f.value||d.value},{default:t(()=>[a(m,{start:""},{default:t(()=>[...e[13]||(e[13]=[l("mdi-check",-1)])]),_:1}),e[14]||(e[14]=l(" Reset Password ",-1))]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"]))]),_:1}),a(E,{class:"justify-center pb-6"},{default:t(()=>[a(V,{to:"/login",variant:"text",color:"primary"},{default:t(()=>[a(m,{start:""},{default:t(()=>[...e[16]||(e[16]=[l("mdi-arrow-left",-1)])]),_:1}),e[17]||(e[17]=l(" Back to Login ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},H=N(L,[["__scopeId","data-v-23709247"]]);export{H as default};
